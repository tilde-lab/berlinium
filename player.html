<!--
Materials Informatics HTML5 Player --- in-browser ultra-fast and
lightweight renderer of the crystallographic data.
Author: Evgeny Blokhin
License: MIT
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0" />
<title>Materials Informatics HTML5 Player</title>
<style>
body{margin:0;padding:0;overflow:hidden;}
html, body{height:100%;}
#infopanel{position:fixed;top:10px;left:6px;width:150px;height:150px;text-align:left;z-index:2;line-height:18px;font-family:Verdana;font-size:0.75em;color:#222;}
#zoompanel{position:fixed;top:18px;right:6px;width:50px;height:102px;z-index:2;background:no-repeat url(data:image/gif;base64,R0lGODlhMgBmAKEBAAAAAP///8zMzP///yH5BAEKAAMALAAAAAAyAGYAAAL+nI+py+0uopzi2UtzvhxNLHXWJ4YiY55Gqg6sRzVvNx+bHKk5FPNV+cOReMBR77EzgoY+0LK2SOI4N2MQdfVBo9mEFHlUTqlhcNd2xjLFXLTmDWd+Ye64vepK5+v3/nWOxudnR4clOAhX2Ea2Bjb2BPioEMnVSGTIuDVJqQljiSmpRblpBqnnNZp3Kki2ZNW5khq7qgoL62bW+akmunqLqocHLFvZctiyq1VLu/m7zKcj7DlTljmoRoyd2Gs8zczaHb78La6dXd6cjC6kvl7p7D4LH19LH21cbT+8rT/+fk7jVruA5DyVm2ewG8BQAd0t3BMPIMJSrexle9iQjcWCVBiLXOoHkSG9LR1PcCqoMFgQRH4UkZLHkl/Il+Ni4jl5yKYclTl1SsEJ0+dOkRuJjlSJMtqpkow+9uPIlKLTo7QmWmkaUWJSqU/QDRwmLt+rlGJzoYxRlh2xKmnVvniTbmvNOGrDETIr12tbkP749sobVprfY4P/Aba7F+RXxT8KAAA7);}
#optionpanel{position:fixed;bottom:4px;left:0;width:100%;z-index:2;text-align:center;font-family:Arial;font-size:0.9em;color:#222;line-height:1.4em;}
#landing{display:none;position:fixed;left:0;top:0;right:0;bottom:0;height:auto;z-index:4;background:#fff;margin:0;text-align:center;font-family:Arial;font-size:1.25em;padding:10px;line-height:2em;}
#landing a{color:#999;}
#legend{width:290px;margin:20px auto 0;border-radius:15px;background:#f2f2f2;color:#999;padding:5px;}
#triangle{width:0;height:0;margin:-2px auto 20px;border-left:20px solid transparent;border-right:20px solid transparent;border-top:20px solid #f2f2f2;}
#notifybox{display:none;z-index:6;position:fixed;top:4px;left:4px;width:500px;background:#333;color:#fff;font-weight:bold;border-radius:5px;font-family:Arial;}
#cross{float:right;width:24px;height:24px;font-size:10px;text-align:center;cursor:pointer;background:url(data:image/gif;base64,R0lGODlhEAAQAJEAAAAAAP///1VVVf///yH5BAEAAAMALAAAAAAQABAAAAIjnI+py6L+BDRy0gqxHVqvLjGcJ3Yl+IEhQpLX+m7wMYv2PRQAOw==) center center no-repeat;}
#message{margin:20px;}
#versionbox{display:none;z-index:5;position:fixed;bottom:2px;right:2px;color:#222;font-size:0.95em;}
#cmdbox{display:none;z-index:3;position:fixed;bottom:2px;left:4px;cursor:pointer;font-family:Arial;text-decoration:underline;font-size:1.5em;color:#222;background:#fff;}
@media screen and (min-width:920px){
#cmdbox{display:block;}
#versionbox{display:block;}
#optionpanel{}
}
</style>
</head>
<body>
<script type="text/javascript">
/*
 RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/domReady for details
*/
'use strict';var player=function(O){function Q(q){if(R[q])return R[q].exports;var h=R[q]={exports:{},id:q,loaded:!1};O[q].call(h.exports,h,h.exports,Q);h.loaded=!0;return h.exports}var R={};Q.m=O;Q.c=R;Q.p="";return Q(0)}([function(O,Q,R){!function(){var q=[R(1),R(4),R(6),R(3)];(function(h,g,p,c){function a(a){var b=document.getElementById("notifybox"),d=document.getElementById("message");b.style.display="block";d.innerHTML="";setTimeout(function(){d.innerHTML=a},250)}function b(a,b){var d=document.createElement("div");
d.setAttribute("id",a);b&&(d.innerHTML=b);document.body.appendChild(d);return d}function d(a,b,d){d||(d=15658734);var c=new y.Geometry;c.vertices.push(new y.Vector3(a[0],a[1],a[2]));c.vertices.push(new y.Vector3(b[0],b[1],b[2]));a=new y.LineBasicMaterial({color:d});r.atombox.add(new y.Line(c,a))}function e(a){var b=document.createElement("canvas"),d=b.getContext("2d"),c=3.5*d.measureText(a).width;b.width=c;b.height=30;d.font="normal 30px Arial";d.textAlign="center";d.textBaseline="middle";d.fillStyle=
"#000000";d.fillText(a,b.width/2,b.height/2);a=new y.Texture(b);a.needsUpdate=!0;a=new y.SpriteMaterial({map:a});a=new y.Sprite(a);a.renderOrder=1;b=new y.Object3D;a.scale.set(c,30,1);b.add(a);b.name="label";return b}function f(){r.loaded=!0;r.container=b("player");r.scene=new y.Scene;r.camera=new y.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,2E4);r.camera.position.set(0,0,2600);var a=new y.AmbientLight(10066329);r.scene.add(a);a=new y.PointLight(6710886,1);a.position.set(1500,1500,
1500);r.scene.add(a);r.renderer=new y.CanvasRenderer;r.renderer.setClearColor(16777215,1);r.renderer.setSize(window.innerWidth,window.innerHeight);r.container.appendChild(r.renderer.domElement);b("zoompanel").onclick=function(a){a=a||window.event;a.cancelBubble?a.cancelBubble=!0:(a.stopPropagation(),a.preventDefault());r.camera.fov-=7.5*(69<(a.pageY?a.pageY:a.clientY)?-1:1);r.camera.updateProjectionMatrix()};r.controls=new y.TrackballControls(r.camera);r.controls.rotateSpeed=1.75;r.controls.staticMoving=
!0;k()}function k(){var a=r.scene.getObjectByName("atombox");a&&(r.scene.remove(a),r.controls.reset());r.atombox=new y.Object3D;(a=document.getElementById("infopanel"))&&a.parentNode.removeChild(a);r.obj3d.descr&&b("infopanel","<span style=color:#900>a = "+(Math.round(1E3*parseFloat(r.obj3d.descr.a))/1E3).toFixed(3)+" &#8491;</span><br /><span style=color:#090>b = "+(Math.round(1E3*parseFloat(r.obj3d.descr.b))/1E3).toFixed(3)+" &#8491;</span><br /><span style=color:#09f>c = "+(Math.round(1E3*parseFloat(r.obj3d.descr.c))/
1E3).toFixed(3)+" &#8491;</span><br />&#945; = "+(Math.round(1E3*parseFloat(r.obj3d.descr.alpha))/1E3).toFixed(3)+"&deg;<br />&#946; = "+(Math.round(1E3*parseFloat(r.obj3d.descr.beta))/1E3).toFixed(3)+"&deg;<br />&#947; = "+(Math.round(1E3*parseFloat(r.obj3d.descr.gamma))/1E3).toFixed(3)+"&deg;<br />");(a=document.getElementById("optionpanel"))&&a.parentNode.removeChild(a);a=b("optionpanel","<input type=radio name=optionpanel id=optionpanel_none /><label for=optionpanel_none>none</label> <input type=radio name=optionpanel id=optionpanel_S checked=checked /><label for=optionpanel_S>chemical elements</label> <input type=radio name=optionpanel id=optionpanel_N /><label for=optionpanel_N>id's</label>");
if(Object.keys(r.obj3d.overlayed).length)for(var c in r.obj3d.overlayed)a.innerHTML+=" <input type=radio name=optionpanel id=optionpanel_"+c+" /><label for=optionpanel_"+c+">"+r.obj3d.overlayed[c]+"</label>",r.available_overlays.push(c);a.onclick=function(a){a=a||window.event;a=(a.target||a.srcElement).id.replace("optionpanel_","");if(-1!==r.available_overlays.indexOf(a)){var b=r.scene.getObjectByName("atombox"),b=b.children,d=b.filter(function(a){return"label"==a.name}),c,f=d.length;for(c=0;c<f;c++)r.atombox.remove(d[c]),
r.scene.remove(d[c]);if("none"!==a){b=b.filter(function(a){return"atom"==a.name});f=b.length;for(c=0;c<f;c++)d=e(b[c].overlays[a]),d.position.set(b[c].position.x,b[c].position.y,b[c].position.z),r.atombox.add(d);r.current_overlay=a}}r.renderer.render(r.scene,r.camera)};r.current_overlay="S";var f;c={w:6,h:6};a={w:10,h:8};50<r.obj3d.atoms.length?f=c:f=a;a=r.obj3d.atoms.length;for(c=0;c<a;c++){var k=parseInt(100*r.obj3d.atoms[c].x),m=parseInt(100*r.obj3d.atoms[c].y),l=parseInt(100*r.obj3d.atoms[c].z),
n=new y.Mesh(new y.SphereBufferGeometry(65*r.obj3d.atoms[c].r,f.w,f.h),new y.MeshLambertMaterial({color:r.obj3d.atoms[c].c,overdraw:.5}));n.position.set(k,m,l);n.name="atom";n.overlays=r.obj3d.atoms[c].overlays;r.atombox.add(n);n=e(n.overlays[r.current_overlay]);n.position.set(k,m,l);r.atombox.add(n)}if(r.obj3d.cell.length){var A;f=[];for(c=0;3>c;c++)a=Math.round(1E3*parseFloat(r.obj3d.cell[c][0]))/10,k=Math.round(1E3*parseFloat(r.obj3d.cell[c][1]))/10,m=Math.round(1E3*parseFloat(r.obj3d.cell[c][2]))/
10,f.push([a,k,m]),0==c?A=10027008:1==c?A=39168:2==c&&(A=39423),r.atombox.add(new y.ArrowHelper((new y.Vector3(a,k,m)).normalize(),new y.Vector3(0,0,0),Math.sqrt(a*a+k*k+m*m),A,75,10));c=[f[0][0]+f[1][0],f[0][1]+f[1][1],f[0][2]+f[1][2]];a=[f[0][0]+f[2][0],f[0][1]+f[2][1],f[0][2]+f[2][2]];k=[c[0]+f[2][0],c[1]+f[2][1],c[2]+f[2][2]];m=[f[1][0]+f[2][0],f[1][1]+f[2][1],f[1][2]+f[2][2]];A=[];A.push([f[0],c]);A.push([f[0],a]);A.push([f[1],m]);A.push([f[1],c]);A.push([f[2],m]);A.push([f[2],a]);A.push([c,
k]);A.push([a,k]);A.push([k,m]);a=A.length;for(c=0;c<a;c++)d(A[c][0],A[c][1])}r.atombox.name="atombox";r.scene.add(r.atombox);x()}function m(){r.loaded&&(r.camera.aspect=window.innerWidth/window.innerHeight,r.camera.updateProjectionMatrix(),r.renderer.setSize(window.innerWidth,window.innerHeight),r.controls.handleResize(),x())}function x(){requestAnimationFrame(x);r.renderer.render(r.scene,r.camera);r.controls.update()}function A(){var b=document.location.hash.substr(1);if(-1==b.indexOf("://"))return r.loaded||
n(),a("Error: not a valid url!");v(b)}function n(){r.local_supported?document.getElementById("landing").style.display="block":s()}function s(a){a=a||window.event;a.cancelBubble?a.cancelBubble=!0:(a.stopPropagation(),a.preventDefault());l(r.sample,!1)}function v(b){var d=document.createElement("a");d.href=b;d.hostname!==window.location.hostname&&(b=r.webproxy+"?url="+b);var c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");c.onreadystatechange=function(){4==c.readyState&&
(200==c.status?l(c.responseText,!0):(a("Error: HTTP "+c.status+" status received during retrieving data from the server"),r.loaded||n()))};c.open("GET",b);c.setRequestHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT");c.send(1)}function l(a,b){r.obj3d=h.to_player(a);r.obj3d?(document.getElementById("landing").style.display="none",r.loaded?k():f()):r.loaded||n()}function u(b){b.stopPropagation();b.preventDefault();if(1<b.dataTransfer.files.length)return a("Error: only one file at the time may be rendered!");
b=b.dataTransfer.files[0];if(!b||!b.size)return a("Error: file cannot be read (unaccessible?)");var d=new FileReader;d.onloadend=function(a){l(a.target.result,!1)};d.abort=function(){a("Error: file reading has been cancelled!")};d.onerror=function(b){a("Error: file reading has been cancelled: "+b.target.error.name)};d.readAsText(b)}function t(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"}var r={version:"0.14",loaded:!1,container:null,stats:null,camera:null,scene:null,
renderer:null,controls:null,atombox:null,available_overlays:["none","S","N"],current_overlay:"S",obj3d:!1};r.local_supported=window.File&&window.FileReader&&window.FileList&&window.Blob;r.webproxy="proxy.php";r.sample="data_global\n_cell_length_a 24\n_cell_length_b 5.91\n_cell_length_c 5.85\n_cell_angle_alpha 90\n_cell_angle_beta 90\n_cell_angle_gamma 90\n_symmetry_space_group_name_H-M 'P1'\nloop_\n_symmetry_equiv_pos_as_xyz\nx,y,z\nloop_\n_atom_site_label\n_atom_site_type_symbol\n_atom_site_fract_x\n_atom_site_fract_y\n_atom_site_fract_z\n_atom_site_charge\nO1 O 0.425 0.262 0.009 -2.0\nO2 O -0.425 0.262 0.009 -2.0\nH3 H 0.444 0.258 0.154 1.0\nH4 H -0.444 0.258 0.154 1.0\nH5 H 0.396 0.124 0.012 1.0\nH6 H -0.396 0.124 0.012 1.0\nO7 O 0.425 0.236 0.510 -2.0\nO8 O -0.425 0.236 0.510 -2.0\nH9 H 0.444 0.239 0.656 1.0\nH10 H -0.444 0.239 0.656 1.0\nH11 H 0.396 0.374 0.512 1.0\nH12 H -0.396 0.374 0.512 1.0\nSr13 Sr 0.342 0.964 0.467 2.0\nSr14 Sr -0.342 0.964 0.467 2.0\nSr15 Sr 0.342 0.535 0.967 2.0\nSr16 Sr -0.342 0.535 0.967 2.0\nO17 O 0.348 0.971 0.019 -2.0\nO18 O -0.348 0.971 0.019 -2.0\nO19 O 0.348 0.528 0.519 -2.0\nO20 O -0.348 0.528 0.519 -2.0\nO21 O 0.263 0.803 0.701 -2.0\nO22 O -0.263 0.803 0.701 -2.0\nO23 O 0.264 0.695 0.200 -2.0\nO24 O -0.264 0.695 0.200 -2.0\nZr25 Zr 0.261 0.000 0.998 4.0\nZr26 Zr -0.261 0.000 0.998 4.0\nZr27 Zr 0.261 0.499 0.498 4.0\nZr28 Zr -0.261 0.499 0.498 4.0\nO29 O 0.257 0.304 0.806 -2.0\nO30 O -0.257 0.304 0.806 -2.0\nO31 O 0.257 0.195 0.306 -2.0\nO32 O -0.257 0.195 0.306 -2.0\nSr33 Sr 0.173 0.993 0.524 2.0\nSr34 Sr -0.173 0.993 0.524 2.0\nSr35 Sr 0.173 0.506 0.024 2.0\nSr36 Sr -0.173 0.506 0.024 2.0\nO37 O 0.173 0.947 0.986 -2.0\nO38 O -0.173 0.947 0.986 -2.0\nO39 O 0.173 0.551 0.486 -2.0\nO40 O -0.173 0.551 0.486 -2.0\nO41 O 0.098 0.204 0.295 -2.0\nO42 O -0.098 0.204 0.295 -2.0\nO43 O 0.098 0.295 0.795 -2.0\nO44 O -0.098 0.295 0.795 -2.0\nZr45 Zr 0.086 0.004 0.998 4.0\nZr46 Zr -0.086 0.004 0.998 4.0\nZr47 Zr 0.086 0.495 0.498 4.0\nZr48 Zr -0.086 0.495 0.498 4.0\nO49 O 0.074 0.709 0.211 -2.0\nO50 O -0.074 0.709 0.211 -2.0\nO51 O 0.074 0.790 0.711 -2.0\nO52 O -0.074 0.790 0.711 -2.0\nSr53 Sr 0 0.991 0.467 2.0\nSr54 Sr 0 0.508 0.967 2.0\nO55 O 0 0.076 0.020 -2.0\nO56 O 0 0.423 0.520 -2.0";
var y=p.THREE||p;c(function(){var d=b("notifybox",'<div id="cross"></div><div id="message"></div>');document.getElementById("cross").onclick=function(){d.style.display="none"};b("versionbox","v"+r.version);b("cmdbox","New model").onclick=n;b("landing",'<div id="legend">Choose a <b>CIF</b> or <b>POSCAR</b> file (drag & drop is supported). Files are processed offline in the browser, no remote server is used. <a href=/ id=play_demo>Example</a>.</div><div id="triangle"></div><input type="file" id="fileapi" />');
document.getElementById("play_demo").onclick=s;h=h(g,{warning:a,error:a});window.addEventListener("resize",m,!1);window.addEventListener("hashchange",A,!1);if(r.local_supported){window.addEventListener("dragover",t,!1);window.addEventListener("drop",u,!1);var c=document.getElementById("fileapi"),e=new FileReader;c.onchange=function(){if(!this.files[0]||!this.files[0].size)return a("Error: file cannot be read (unaccessible?)");e.currentFilename=this.files[0].name;e.readAsText(this.files[0])};e.onloadend=
function(a){l(a.target.result,!1)}}window.parent&&window.parent.playerdata?(c="object"===typeof window.parent.playerdata&&document.location.search?window.parent.playerdata[document.location.search.substr(1)]:window.parent.playerdata,l(c,!1)):document.location.hash.length?A():n()})}).apply(null,q)}()},function(O,Q,R){String.prototype.startswith=function(q){return 0===this.indexOf(q)};String.prototype.endswith=function(q,h){var g=this.toString();if(void 0===h||h>g.length)h=g.length;h-=q.length;g=g.indexOf(q,
h);return-1!==g&&g===h};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};Q=function(q,h){function g(a){if(0<a.indexOf("_cell_angle_gamma ")&&0<a.indexOf("loop_"))return"CIF";a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");return 6<a.length&&"direct"==a[6].toLowerCase().substr(0,6)?"POSCAR":"unknown"}function p(a,b,d,c,e,n){if(!(a&&b&&d&&c&&e&&n))return h.error("Error: invalid cell definition!"),!1;c=c*Math.PI/180;e=e*Math.PI/180;n=n*Math.PI/180;var s=[0,0,1],v=[1,0,0],
s=q.divide(s,q.norm(s)),v=q.subtract(v,q.multiply(q.dot(v,s),s)),v=q.divide(v,q.norm(v)),l=q.cross(s,v);a=q.multiply(a,[1,0,0]);b=q.multiply(b,[q.cos(n),q.sin(n),0]);var g=q.cos(e);c=q.divide(q.subtract(q.cos(c),q.multiply(q.cos(e),q.cos(n))),q.sin(n));e=q.sqrt(q.subtract(q.subtract(1,q.multiply(g,g)),q.multiply(c,c)));d=q.multiply(d,[g,c,e]);return q.multiply([a,b,d],[v,l,s])}function c(a){a.symops&&h.warning("Warning! Reading of symmetry operations is not yet implemented, expect error now.");var b;
b=6==Object.keys(a.cell).length?p(a.cell.a,a.cell.b,a.cell.c,a.cell.alpha,a.cell.beta,a.cell.gamma):a.cell;var d=[],c=[],e=[],n=[],d=b[0].map(function(a,d){return b.map(function(a){return a[d]})}),c=c.concat.apply(c,d),s=0,v=a.atoms.length;if(a.types)for(s=0;s<v;s++)n.push([a.atoms[s].x,a.atoms[s].y,a.atoms[s].z]);else{for(var l=[],d={},s=0;s<v;s++)-1==Object.keys(d).indexOf(a.atoms[s].symbol)?d[a.atoms[s].symbol]=[[a.atoms[s].x,a.atoms[s].y,a.atoms[s].z]]:d[a.atoms[s].symbol].push([a.atoms[s].x,
a.atoms[s].y,a.atoms[s].z]);var s=1,g;for(g in d){for(v=0;v<d[g].length;v++)n.push(d[g][v]),l.push(s);s++}}e=e.concat.apply(e,n);n=!1;n=(a.sg_name?a.sg_name:"")+(a.ng_name?" ("+a.ng_name+")":"");return{cell:c,atoms:e,types:l||a.types,symlabel:n}}function a(a){var b=[],c=[],x=[];a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");var A={cell:{},atoms:[]},n=!1,s=!1,v=!1,l="",l=[],g="a b c alpha beta gamma".split(" "),t=["_atom_site_label","_atom_site_type_symbol","_atom_site_fract_x","_atom_site_fract_y",
"_atom_site_fract_z"],r=["label","symbol","x","y","z"],y=[0,1],p=[],w;for(w in e)p.push(t.length),t.push(w);var I=a.length;for(w=0;w<I;w++)if(!a[w].startswith("#"))if(l=a[w].toLowerCase().trim()){s=!1;if(l.startswith("data_"))s=!0,n=!1,x=[],v=!1;else if(l.startswith("_cell_")){n=!1;l=l.split(" ");s=l[0].split("_");s=s[s.length-1];-1!==g.indexOf(s)&&l[l.length-1]&&(A.cell[s]=parseFloat(l[l.length-1]));continue}else if(l.startswith("_symmetry_space_group_name_h-m")||l.startswith("_space_group.patterson_name_h-m")){n=
!1;A.sg_name=a[w].substr(31).replace(/"/g,"").replace(/'/g,"").trim();continue}else if(l.startswith("_space_group.it_number")||l.startswith("_space_group_it_number")||l.startswith("_symmetry_int_tables_number")){n=!1;l=l.split(" ");A.ng_name=l[l.length-1].trim();continue}else if(l.startswith("loop_")){n=!0;x=[];v=!1;continue}if(n)if(l.startswith("_symmetry_equiv")||l.startswith("_space_group"))v=!0;else if(l.startswith("_"))x.push(l);else if(v)c.push(l.replace(/"/g,"").replace(/'/g,""));else{var s=
{overlays:{}},l=l.replace(/\t/g," ").split(" ").filter(function(a){return a?!0:!1}),B,E=x.length;for(B=0;B<E;B++){var K=t.indexOf(x[B]);-1!=K&&(-1<y.indexOf(K)?l[B]=l[B].charAt(0).toUpperCase()+l[B].slice(1).toLowerCase():l[B]=parseFloat(l[B]),-1<p.indexOf(K)?s.overlays[t[K]]=l[B]:s[r[K]]=l[B])}void 0!==s.x&&void 0!==s.y&&void 0!==s.z&&(!s.symbol&&s.label&&(s.symbol=s.label.replace(/[0-9]/g,"")),!d.JmolColors[s.symbol]&&2<s.symbol.length&&(s.symbol=s.symbol.substr(0,s.symbol.length-1)),!d.JmolColors[s.symbol]&&
1<s.symbol.length&&(s.symbol=s.symbol.substr(0,s.symbol.length-1)),s.symbol&&A.atoms.push(s))}else s&&A.atoms.length&&(1<c.length&&(A.symops=c),b.push(A),A={cell:{},atoms:[]},c=[])}else n=!1,x=[],v=!1;A.atoms.length&&(1<c.length&&(A.symops=c),b.push(A));if(b.length)return b[b.length-1];h.error("Error: unexpected CIF format!");return!1}function b(a){a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");var b=[],d=[],c=1,e=[],n=[],s=["x","y","z","symbol"],v,l=a.length,g=[],t=0;for(v=1;v<l;v++)if(1==
v)c=parseFloat(a[v]);else if(-1!==[2,3,4].indexOf(v))b.push(a[v].split(" ").filter(function(a){return a?!0:!1}).map(Number));else if(5==v)for(e=a[v].split(" ").filter(function(a){return a?!0:!1}).map(Number),g=0;g<e.length;g++)for(var r=0;r<e[g];r++)n.push(g+1);else if(6<v){r={};g=a[v].replace("#","").replace("!","").split(" ").filter(function(a){return a?!0:!1});if(!g.length)break;else if(3==g.length)g.push("Xx"+n[t]);else if(3>g.length)return h.error("Error: invalid atom definition!"),!1;for(e=
0;4>e;e++)r[s[e]]=3>e?parseFloat(g[e]):g[e];r.symbol=r.symbol.replace(/\W/g,"");d.push(r);t++}b=q.multiply(b,c);if(d.length)return{cell:b,atoms:d,types:n};h.error("Error: unexpected POSCAR format!");return!1}var d={JmolColors:{D:"#FFFFC0",H:"#FFFFFF",He:"#D9FFFF",Li:"#CC80FF",Be:"#C2FF00",B:"#FFB5B5",C:"#909090",N:"#3050F8",O:"#FF0D0D",F:"#90E050",Ne:"#B3E3F5",Na:"#AB5CF2",Mg:"#8AFF00",Al:"#BFA6A6",Si:"#F0C8A0",P:"#FF8000",S:"#FFFF30",Cl:"#1FF01F",Ar:"#80D1E3",K:"#8F40D4",Ca:"#3DFF00",Sc:"#E6E6E6",
Ti:"#BFC2C7",V:"#A6A6AB",Cr:"#8A99C7",Mn:"#9C7AC7",Fe:"#E06633",Co:"#F090A0",Ni:"#50D050",Cu:"#C88033",Zn:"#7D80B0",Ga:"#C28F8F",Ge:"#668F8F",As:"#BD80E3",Se:"#FFA100",Br:"#A62929",Kr:"#5CB8D1",Rb:"#702EB0",Sr:"#00FF00",Y:"#94FFFF",Zr:"#94E0E0",Nb:"#73C2C9",Mo:"#54B5B5",Tc:"#3B9E9E",Ru:"#248F8F",Rh:"#0A7D8C",Pd:"#006985",Ag:"#C0C0C0",Cd:"#FFD98F",In:"#A67573",Sn:"#668080",Sb:"#9E63B5",Te:"#D47A00",I:"#940094",Xe:"#429EB0",Cs:"#57178F",Ba:"#00C900",La:"#70D4FF",Ce:"#FFFFC7",Pr:"#D9FFC7",Nd:"#C7FFC7",
Pm:"#A3FFC7",Sm:"#8FFFC7",Eu:"#61FFC7",Gd:"#45FFC7",Tb:"#30FFC7",Dy:"#1FFFC7",Ho:"#00FF9C",Er:"#00E675",Tm:"#00D452",Yb:"#00BF38",Lu:"#00AB24",Hf:"#4DC2FF",Ta:"#4DA6FF",W:"#2194D6",Re:"#267DAB",Os:"#266696",Ir:"#175487",Pt:"#D0D0E0",Au:"#FFD123",Hg:"#B8B8D0",Tl:"#A6544D",Pb:"#575961",Bi:"#9E4FB5",Po:"#AB5C00",At:"#754F45",Rn:"#428296",Fr:"#420066",Ra:"#007D00",Ac:"#70ABFA",Th:"#00BAFF",Pa:"#00A1FF",U:"#008FFF",Np:"#0080FF",Pu:"#006BFF",Am:"#545CF2",Cm:"#785CE3",Bk:"#8A4FE3",Cf:"#A136D4",Es:"#B31FD4",
Fm:"#B31FBA",Md:"#B30DA6",No:"#BD0D87",Lr:"#C70066",Rf:"#CC0059",Db:"#D1004F",Sg:"#D90045",Bh:"#E00038",Hs:"#E6002E",Mt:"#EB0026"},AseRadii:{X:.66,H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.39,Fe:1.32,Co:1.26,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,
In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.87,Hf:1.75,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69,Bk:3,Cf:3,Es:3,Fm:3,Md:3,No:3,Lr:3,Rf:3,Db:3,Sg:3,Bh:3,Hs:3,Mt:3}},e={_atom_site_occupancy:"site occupancies",_atom_site_charge:"formal charges"};
return{to_player:function(c){var k;switch(g(c)){case "CIF":k=a(c);break;case "POSCAR":k=b(c);break;default:h.error("Error: file format cannot be recognized!")}if(!k)return!1;c=k;var m=!1,x;6==Object.keys(c.cell).length?(x=p(c.cell.a,c.cell.b,c.cell.c,c.cell.alpha,c.cell.beta,c.cell.gamma),m=c.cell):x=c.cell;var A=[],n=c.atoms.length;for(k=0;k<n;k++)A.push([c.atoms[k].x,c.atoms[k].y,c.atoms[k].z]);var A=q.multiply(A,x),m={atoms:[],cell:x,descr:m,overlayed:{}},s,v,l={},u=!1,n=c.atoms.length;for(k=0;k<
n;k++){x=d.JmolColors[c.atoms[k].symbol]?d.JmolColors[c.atoms[k].symbol]:"0xffff00";s=d.AseRadii[c.atoms[k].symbol]?d.AseRadii[c.atoms[k].symbol]:.66;l={S:c.atoms[k].symbol,N:k+1};c.atoms[k].overlays._atom_site_occupancy&&1>c.atoms[k].overlays._atom_site_occupancy&&(u=!0);for(v in c.atoms[k].overlays)l[v]=c.atoms[k].overlays[v];m.atoms.push({x:A[k][0],y:A[k][1],z:A[k][2],c:x,r:s,overlays:l})}for(v in l)"S"!==v&&"N"!==v&&(m.overlayed[v]=e[v]);u&&h.warning("Warning! Rendering of alloys (with fractional site occupancies) is not yet implemented.");
return m},to_flatten:function(d){var e;switch(g(d)){case "CIF":e=a(d);break;case "POSCAR":e=b(d);break;default:h.error("Error: file format cannot be recognized!")}return e?c(e):!1},version:"0.0.2.3"}};"undefined"!==typeof O&&O.exports?O.exports=Q:"function"===typeof R(2).specified&&!(void 0!==Q&&(O.exports=Q))},function(O,Q,R){function q(g){return R(h(g))}function h(h){var c;if(!(c=g[h]))throw Error("Cannot find module '"+h+"'.");return c}var g={"./domReady":3,"./domReady.js":3,"./math.custom":4,
"./math.custom.js":4,"./matinfio":1,"./matinfio.js":1,"./require":5,"./require.js":5,"./three.custom":6,"./three.custom.js":6};q.keys=function(){return Object.keys(g)};q.resolve=h;O.exports=q;q.id=2},function(O,Q,R){var q;!(q=function(){function h(){if(!d){d=!0;a&&clearInterval(a);var b=f;if(d&&b.length){f=[];var c;for(c=0;c<b.length;c+=1)b[c](e)}}}function g(a){d?a(e):f.push(a);return g}var p,c,a,b="undefined"!==typeof window&&window.document,d=!b,e=b?document:null,f=[];if(b){if(document.addEventListener)document.addEventListener("DOMContentLoaded",
h,!1),window.addEventListener("load",h,!1);else if(window.attachEvent){window.attachEvent("onload",h);c=document.createElement("div");try{p=null===window.frameElement}catch(k){}c.doScroll&&p&&window.external&&(a=setInterval(function(){try{c.doScroll(),h()}catch(a){}},30))}"complete"===document.readyState&&h()}g.version="2.0.1";g.load=function(a,b,d,c){c.isBuild?d(null):g(d)};return g}.call(Q,R,Q,O),void 0!==q&&(O.exports=q))},function(O,Q,R){(function(q,h){O.exports=h()})(this,function(){return function(q){function h(p){if(g[p])return g[p].exports;
var c=g[p]={exports:{},id:p,loaded:!1};q[p].call(c.exports,c,c.exports,h);c.loaded=!0;return c.exports}var g={};h.m=q;h.c=g;h.p="";return h(0)}([function(q,h,g){h=g(1).create();h.import(g(13));h.import(g(23));h.import(g(24));h.import(g(34));h.import(g(35));h.import(g(36));h.import(g(63));h.import(g(53));h.import(g(67));h.import(g(69));h.import(g(70));q.exports=h},function(q,h,g){q.exports=g(2)},function(q,h,g){var p=g(3).isFactory,c=g(3).deepExtend,a=g(4),b=g(8),d=g(10),e=g(12);h.create=function(f){function k(a){if(!p(a))throw Error("Factory object with properties `type`, `name`, and `factory` expected");
var b=m.indexOf(a);-1===b?(b=!0===a.math?a.factory(A.type,n,k,A.typed,A):a.factory(A.type,n,k,A.typed),m.push(a),x.push(b)):b=x[b];return b}if("function"!==typeof Object.create)throw Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var m=[],x=[],A=b.mixin({});A.type={};A.expression={transform:Object.create(A)};A.typed=a.create(A.type);var n={epsilon:1E-14,matrix:"matrix",number:"number",precision:64,predictable:!1};f&&c(n,f);A["import"]=
k(d);A.config=k(e);return A}},function(q,h){h.clone=function p(c){var a=typeof c;if("number"===a||"string"===a||"boolean"===a||null===c||void 0===c)return c;if("function"===typeof c.clone)return c.clone();if(Array.isArray(c))return c.map(function(a){return p(a)});if(c instanceof Number)return new Number(c.valueOf());if(c instanceof String)return new String(c.valueOf());if(c instanceof Boolean)return new Boolean(c.valueOf());if(c instanceof Date)return new Date(c.valueOf());if(c&&!0===c.isBigNumber)return c;
if(c instanceof RegExp)throw new TypeError("Cannot clone "+c);var a={},b;for(b in c)c.hasOwnProperty(b)&&(a[b]=p(c[b]));return a};h.extend=function(h,c){for(var a in c)c.hasOwnProperty(a)&&(h[a]=c[a]);return h};h.deepExtend=function c(a,b){if(Array.isArray(b))throw new TypeError("Arrays are not supported by deepExtend");for(var d in b)if(b.hasOwnProperty(d))if(b[d]&&b[d].constructor===Object)void 0===a[d]&&(a[d]={}),a[d].constructor===Object?c(a[d],b[d]):a[d]=b[d];else{if(Array.isArray(b[d]))throw new TypeError("Arrays are not supported by deepExtend");
a[d]=b[d]}return a};h.deepEqual=function(c,a){var b,d;if(Array.isArray(c)){if(!Array.isArray(a)||c.length!=a.length)return!1;b=0;for(d=c.length;b<d;b++)if(!h.deepEqual(c[b],a[b]))return!1;return!0}if(c instanceof Object){if(Array.isArray(a)||!(a instanceof Object))return!1;for(b in c)if(!h.deepEqual(c[b],a[b]))return!1;for(b in a)if(!h.deepEqual(c[b],a[b]))return!1;return!0}return typeof c===typeof a&&c==a};h.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},
"x",{get:function(){}}),!0}catch(c){}return!1};h.lazy=function(c,a,b){if(h.canDefineProperty()){var d=!0,e;Object.defineProperty(c,a,{get:function(){d&&(e=b(),d=!1);return e},set:function(a){e=a;d=!1},configurable:!0,enumerable:!0})}else c[a]=b()};h.traverse=function(c,a){var b=c;if(a)for(var d=a.split("."),e=0;e<d.length;e++){var f=d[e];f in b||(b[f]={});b=b[f]}return b};h.isFactory=function(c){return c&&"function"===typeof c.factory}},function(q,h,g){var p=g(5),c=g(6).digits,a=function(){a=p.create;
return p};h.create=function(b){var d=a();d.types=[{name:"number",test:function(a){return"number"===typeof a}},{name:"Complex",test:function(a){return a&&a.isComplex}},{name:"BigNumber",test:function(a){return a&&a.isBigNumber}},{name:"Fraction",test:function(a){return a&&a.isFraction}},{name:"Unit",test:function(a){return a&&a.isUnit}},{name:"string",test:function(a){return"string"===typeof a}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(a){return a&&a.isMatrix}},{name:"DenseMatrix",
test:function(a){return a&&a.isDenseMatrix}},{name:"SparseMatrix",test:function(a){return a&&a.isSparseMatrix}},{name:"ImmutableDenseMatrix",test:function(a){return a&&a.isImmutableDenseMatrix}},{name:"Range",test:function(a){return a&&a.isRange}},{name:"Index",test:function(a){return a&&a.isIndex}},{name:"boolean",test:function(a){return"boolean"===typeof a}},{name:"ResultSet",test:function(a){return a&&a.isResultSet}},{name:"Help",test:function(a){return a&&a.isHelp}},{name:"function",test:function(a){return"function"===
typeof a}},{name:"Date",test:function(a){return a instanceof Date}},{name:"RegExp",test:function(a){return a instanceof RegExp}},{name:"Object",test:function(a){return"object"===typeof a}},{name:"null",test:function(a){return null===a}},{name:"undefined",test:function(a){return void 0===a}}];d.conversions=[{from:"number",to:"BigNumber",convert:function(a){if(15<c(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+a+"). Use function bignumber(x) to convert to BigNumber.");
return new b.BigNumber(a)}},{from:"number",to:"Complex",convert:function(a){return new b.Complex(a,0)}},{from:"number",to:"string",convert:function(a){return a+""}},{from:"BigNumber",to:"Complex",convert:function(a){return new b.Complex(a.toNumber(),0)}},{from:"number",to:"Fraction",convert:function(a){if(15<c(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to Fraction (value: "+a+"). Use function fraction(x) to convert to Fraction.");return new b.Fraction(a)}},
{from:"string",to:"number",convert:function(a){var b=Number(a);if(isNaN(b))throw Error('Cannot convert "'+a+'" to a number');return b}},{from:"boolean",to:"number",convert:function(a){return+a}},{from:"boolean",to:"BigNumber",convert:function(a){return new b.BigNumber(+a)}},{from:"boolean",to:"string",convert:function(a){return+a}},{from:"null",to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new b.BigNumber(0)}},
{from:"Array",to:"Matrix",convert:function(a){return new b.DenseMatrix(a)}},{from:"Matrix",to:"Array",convert:function(a){return a.valueOf()}}];return d}},function(q,h,g){var p,c,a;"use strict";(function(b){!(c=[],p=b,a="function"===typeof p?p.apply(h,c):p,void 0!==a&&(q.exports=a))})(function(){function a(){function d(a){for(var b,d=0;d<h.types.length;d++){var c=h.types[d];if(c.name===a){b=c.test;break}}if(!b){for(var e,d=0;d<h.types.length;d++)if(c=h.types[d],c.name.toLowerCase()==a.toLowerCase()){e=
c.name;break}throw Error('Unknown type "'+a+'"'+(e?'. Did you mean "'+e+'"?':""));}return b}function c(a){for(var b="",d=0;d<a.length;d++){var e=a[d];if(""!=e.name)if(""==b)b=e.name;else if(b!=e.name)throw a=Error("Function names do not match (expected: "+b+", actual: "+e.name+")"),a.data={actual:e.name,expected:b},a;}return b}function f(a,b,d,c,e){var f=l(c);e=e?e.split(","):null;var k=a||"unnamed",m=e&&-1!==e.indexOf("any");a={fn:a,index:d,actual:c,expected:e};b=e?b>d&&!m?"Unexpected type of argument in function "+
k+" (expected: "+e.join(" or ")+", actual: "+f+", index: "+d+")":"Too few arguments in function "+k+" (expected: "+e.join(" or ")+", index: "+d+")":"Too many arguments in function "+k+" (expected: "+d+", actual: "+b+")";b=new TypeError(b);b.data=a;return b}function k(a){this.name=a||"refs";this.categories={}}function m(a,b){if("string"===typeof a){var d=a.trim(),c="..."===d.substr(0,3);c&&(d=d.substr(3));if(""===d)this.types=["any"];else for(this.types=d.split("|"),d=0;d<this.types.length;d++)this.types[d]=
this.types[d].trim()}else if(Array.isArray(a))this.types=a;else{if(a instanceof m)return a.clone();throw Error("String or Array expected");}this.conversions=[];this.varArgs=c||b||!1;this.anyType=-1!==this.types.indexOf("any")}function x(a,b){var d;if("string"===typeof a)d=""!==a?a.split(","):[];else if(Array.isArray(a))d=a;else throw Error("string or Array expected");this.params=Array(d.length);for(var c=0;c<d.length;c++){var e=new m(d[c]);this.params[c]=e;if(c===d.length-1)this.varArgs=e.varArgs;
else if(e.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."');}this.fn=b}function A(a,b,d){this.path=a||[];this.param=a[a.length-1]||null;this.signature=b||null;this.childs=d||[]}function n(a){var b,d={},c=[],e,f;for(f in a)if(a.hasOwnProperty(f)&&(b=new x(f,a[f]),!b.ignore()))for(b=b.expand(),e=0;e<b.length;e++){var k=b[e],m=k.toString(),l=d[m];if(l)if(l=x.compare(k,l),0>l)d[m]=k;else{if(0===l)throw Error('Signature "'+m+'" is defined twice');}else d[m]=k}for(m in d)d.hasOwnProperty(m)&&
c.push(d[m]);c.sort(function(a,b){return x.compare(a,b)});for(e=0;e<c.length;e++)if(b=c[e],b.varArgs)for(a=b.params.length-1,d=b.params[a],f=0;f<d.types.length;){if(d.conversions[f])for(m=d.types[f],k=0;k<c.length;k++){var l=c[k],n=l.params[a];if(l!==b&&n&&-1!==n.types.indexOf(m)&&!n.conversions[a]){d.types.splice(f,1);d.conversions.splice(f,1);f--;break}}f++}return c}function s(a,b){var d,c,e=b.length,f,k=[];for(d=0;d<a.length;d++)c=a[d],c.params.length!==e||f||(f=c),void 0!=c.params[e]&&k.push(c);
k.sort(function(a,b){return m.compare(a.params[e],b.params[e])});var x=[];for(d=0;d<k.length;d++){c=k[d];var l=c.params[e],n=x.filter(function(a){return a.param.overlapping(l)})[0];if(n){if(n.param.varArgs)throw Error('Conflicting types "'+n.param+'" and "'+l+'"');n.signatures.push(c)}else x.push({param:l,signatures:[c]})}c=Array(x.length);for(d=0;d<x.length;d++)k=x[d],c[d]=s(k.signatures,b.concat(k.param));return new A(b,f,c)}function v(a,b){var d=new k,c=n(b);if(0==c.length)throw Error("No signatures provided");
for(var e=s(c,[]),m=[],x=a||"",l=0,A=0;A<c.length;A++){var r=c[A].params.length;r>l&&(l=r)}A=[];for(r=0;r<l;r++)A[r]="arg"+r;m.push("function "+x+"("+A.join(", ")+") {");m.push('  "use strict";');m.push("  var name = '"+x+"';");m.push(e.toCode(d,"  "));m.push("}");e=[d.toCode(),"return "+m.join("\n")].join("\n");d=(new Function(d.name,"createError",e))(d,f);e={};for(m=0;m<c.length;m++)x=c[m],x.fn&&!x.hasConversions()&&(l=x.params.join(","),e[l]=x.fn);d.signatures=e;return d}function l(a){for(var b,
d=0;d<h.types.length;d++){var c=h.types[d];if("Object"===c.name)b=c;else if(c.test(a))return c.name}return b&&b.test(a)?b.name:"unknown"}k.prototype.add=function(a,b){var d=b||"fn";this.categories[d]||(this.categories[d]=[]);var c=this.categories[d].indexOf(a);-1==c&&(c=this.categories[d].length,this.categories[d].push(a));return d+c};k.prototype.toCode=function(){var a=[],b=this.name+".categories",d=this.categories,c;for(c in d)if(d.hasOwnProperty(c))for(var e=d[c],f=0;f<e.length;f++)a.push("var "+
c+f+" = "+b+"['"+c+"']["+f+"];");return a.join("\n")};m.compare=function(a,b){if(a.anyType)return 1;if(b.anyType)return-1;if(-1!==a.types.indexOf("Object"))return 1;if(-1!==b.types.indexOf("Object"))return-1;if(a.hasConversions()){if(b.hasConversions()){var d,c,e;for(d=0;d<a.conversions.length;d++)if(void 0!==a.conversions[d]){c=a.conversions[d];break}for(d=0;d<b.conversions.length;d++)if(void 0!==b.conversions[d]){e=b.conversions[d];break}return h.conversions.indexOf(c)-h.conversions.indexOf(e)}return 1}if(b.hasConversions())return-1;
var f,k;for(d=0;d<h.types.length;d++)if(h.types[d].name===a.types[0]){f=d;break}for(d=0;d<h.types.length;d++)if(h.types[d].name===b.types[0]){k=d;break}return f-k};m.prototype.overlapping=function(a){for(var b=0;b<this.types.length;b++)if(-1!==a.types.indexOf(this.types[b]))return!0;return!1};m.prototype.clone=function(){var a=new m(this.types.slice(),this.varArgs);a.conversions=this.conversions.slice();return a};m.prototype.hasConversions=function(){return 0<this.conversions.length};m.prototype.contains=
function(a){for(var b=0;b<this.types.length;b++)if(a[this.types[b]])return!0;return!1};m.prototype.toString=function(a){for(var b=[],d={},c=0;c<this.types.length;c++){var e=this.conversions[c],e=a&&e?e.to:this.types[c];e in d||(d[e]=!0,b.push(e))}return(this.varArgs?"...":"")+b.join("|")};x.prototype.clone=function(){return new x(this.params.slice(),this.fn)};x.prototype.expand=function(){function a(d,c){if(c.length<d.params.length){var e,f,k,l=d.params[c.length];if(l.varArgs){f=l.clone();for(e=0;e<
h.conversions.length;e++)if(k=h.conversions[e],-1===l.types.indexOf(k.from)&&-1!==l.types.indexOf(k.to)){var n=f.types.length;f.types[n]=k.from;f.conversions[n]=k}a(d,c.concat(f))}else{for(e=0;e<l.types.length;e++)a(d,c.concat(new m(l.types[e])));for(e=0;e<h.conversions.length;e++)k=h.conversions[e],-1===l.types.indexOf(k.from)&&-1!==l.types.indexOf(k.to)&&(f=new m(k.from),f.conversions[0]=k,a(d,c.concat(f)))}}else b.push(new x(c,d.fn))}var b=[];a(this,[]);return b};x.compare=function(a,b){if(a.params.length>
b.params.length)return 1;if(a.params.length<b.params.length)return-1;var d,c=a.params.length,e=0,f=0;for(d=0;d<c;d++)a.params[d].hasConversions()&&e++,b.params[d].hasConversions()&&f++;if(e>f)return 1;if(e<f)return-1;for(d=0;d<a.params.length;d++)if(c=m.compare(a.params[d],b.params[d]),0!==c)return c;return 0};x.prototype.hasConversions=function(){for(var a=0;a<this.params.length;a++)if(this.params[a].hasConversions())return!0;return!1};x.prototype.ignore=function(){for(var a={},b=0;b<h.ignore.length;b++)a[h.ignore[b]]=
!0;for(b=0;b<this.params.length;b++)if(this.params[b].contains(a))return!0;return!1};x.prototype.toCode=function(a,b){for(var d=Array(this.params.length),c=0;c<this.params.length;c++){var e=this.params[c],f=e.conversions[0];d[c]=e.varArgs?"varArgs":f?a.add(f.convert,"convert")+"(arg"+c+")":"arg"+c}return(c=this.fn?a.add(this.fn,"signature"):void 0)?b+"return "+c+"("+d.join(", ")+"); // signature: "+this.params.join(", "):""};x.prototype.toString=function(){return this.params.join(", ")};A.prototype.toCode=
function(a,b,c){var e=[];if(this.param){var f=this.path.length-1,k=this.param.conversions[0],k="// type: "+(k?k.from+" (convert to "+k.to+")":this.param);if(this.param.varArgs){if(this.param.anyType)e.push(b+"if (arguments.length > "+f+") {"),e.push(b+"  var varArgs = [];"),e.push(b+"  for (var i = "+f+"; i < arguments.length; i++) {"),e.push(b+"    varArgs.push(arguments[i]);");else{var m=function(b,c){for(var e=[],f=0;f<b.length;f++)e[f]=a.add(d(b[f]),"test")+"("+c+")";return e.join(" || ")}.bind(this);
c=this.param.types;for(var x=[],l=0;l<c.length;l++)void 0===this.param.conversions[l]&&x.push(c[l]);e.push(b+"if ("+m(c,"arg"+f)+") { "+k);e.push(b+"  var varArgs = [arg"+f+"];");e.push(b+"  for (var i = "+(f+1)+"; i < arguments.length; i++) {");e.push(b+"    if ("+m(x,"arguments[i]")+") {");e.push(b+"      varArgs.push(arguments[i]);");for(l=0;l<c.length;l++)if(f=this.param.conversions[l])m=a.add(d(c[l]),"test"),f=a.add(f.convert,"convert"),e.push(b+"    }"),e.push(b+"    else if ("+m+"(arguments[i])) {"),
e.push(b+"      varArgs.push("+f+"(arguments[i]));");e.push(b+"    } else {");e.push(b+"      throw createError(name, arguments.length, i, arguments[i], '"+x.join(",")+"');");e.push(b+"    }")}e.push(b+"  }");e.push(this.signature.toCode(a,b+"  "));e.push(b+"}")}else this.param.anyType?(e.push(b+"// type: any"),e.push(this._innerCode(a,b,c))):(x=this.param.types[0],m="any"!==x?a.add(d(x),"test"):null,e.push(b+"if ("+m+"(arg"+f+")) { "+k),e.push(this._innerCode(a,b+"  ",c)),e.push(b+"}"))}else e.push(this._innerCode(a,
b,c));return e.join("\n")};A.prototype._innerCode=function(a,b,d){var c=[],e;this.signature&&(c.push(b+"if (arguments.length === "+this.path.length+") {"),c.push(this.signature.toCode(a,b+"  ")),c.push(b+"}"));var f;for(e=0;e<this.childs.length;e++)if(this.childs[e].param.anyType){f=this.childs[e];break}for(e=0;e<this.childs.length;e++)c.push(this.childs[e].toCode(a,b,f));d&&!this.param.anyType&&c.push(d.toCode(a,b,f));(a=this._exceptions(a,b))&&c.push(a);return c.join("\n")};A.prototype._exceptions=
function(a,b){var d=this.path.length;if(0===this.childs.length)return[b+"if (arguments.length > "+d+") {",b+"  throw createError(name, arguments.length, "+d+", arguments["+d+"]);",b+"}"].join("\n");for(var c={},e=[],f=0;f<this.childs.length;f++){var k=this.childs[f];if(k.param)for(var m=0;m<k.param.types.length;m++){var x=k.param.types[m];x in c||k.param.conversions[m]||(c[x]=!0,e.push(x))}}return b+"throw createError(name, arguments.length, "+d+", arguments["+d+"], '"+e.join(",")+"');"};var g=[{name:"number",
test:function(a){return"number"===typeof a}},{name:"string",test:function(a){return"string"===typeof a}},{name:"boolean",test:function(a){return"boolean"===typeof a}},{name:"Function",test:function(a){return"function"===typeof a}},{name:"Array",test:Array.isArray},{name:"Date",test:function(a){return a instanceof Date}},{name:"RegExp",test:function(a){return a instanceof RegExp}},{name:"Object",test:function(a){return"object"===typeof a}},{name:"null",test:function(a){return null===a}},{name:"undefined",
test:function(a){return void 0===a}}],t={},r=[],y=[],h={config:t,types:g,conversions:r,ignore:y},h=v("typed",{Object:function(a){var b=[],d;for(d in a)a.hasOwnProperty(d)&&b.push(a[d]);b=c(b);return v(b,a)},"string, Object":v,"...Function":function(a){for(var b=c(a),d={},f=0;f<a.length;f++){var k=a[f];if("object"!==typeof k.signatures)throw a=new TypeError("Function is no typed-function (index: "+f+")"),a.data={index:f},a;for(var m in k.signatures)if(k.signatures.hasOwnProperty(m))if(d.hasOwnProperty(m)){if(k.signatures[m]!==
d[m])throw a=Error('Signature "'+m+'" is defined twice'),a.data={signature:m},a;}else d[m]=k.signatures[m]}return v(b,d)}});h.config=t;h.types=g;h.conversions=r;h.ignore=y;h.create=a;h.find=function(a,b){if(!a.signatures)throw new TypeError("Function is no typed-function");var d;if("string"===typeof b){d=b.split(",");for(var c=0;c<d.length;c++)d[c]=d[c].trim()}else if(Array.isArray(b))d=b;else throw new TypeError("String array or a comma separated string expected");c=d.join(",");if(c=a.signatures[c])return c;
throw new TypeError("Signature not found (signature: "+(a.name||"unnamed")+"("+d.join(", ")+"))");};h.convert=function(a,b){var d=l(a);if(b===d)return a;for(var c=0;c<h.conversions.length;c++){var e=h.conversions[c];if(e.from===d&&e.to===b)return e.convert(a)}throw Error("Cannot convert from "+d+" to "+b);};h.addType=function(a){if(!a||"string"!==typeof a.name||"function"!==typeof a.test)throw new TypeError("Object with properties {name: string, test: function} expected");h.types.push(a)};h.addConversion=
function(a){if(!a||"string"!==typeof a.from||"string"!==typeof a.to||"function"!==typeof a.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");h.conversions.push(a)};return h}return a()})},function(q,h,g){var p=g(7);h.isNumber=function(c){return"number"===typeof c};h.isInteger=function(c){return isFinite(c)?c==Math.round(c):!1};h.sign=function(c){return 0<c?1:0>c?-1:0};h.format=function(c,a){if("function"===typeof a)return a(c);if(Infinity===
c)return"Infinity";if(-Infinity===c)return"-Infinity";if(isNaN(c))return"NaN";var b="auto",d=void 0;a&&(a.notation&&(b=a.notation),h.isNumber(a)?d=a:a.precision&&(d=a.precision));switch(b){case "fixed":return h.toFixed(c,d);case "exponential":return h.toExponential(c,d);case "auto":return h.toPrecision(c,d,a&&a.exponential).replace(/((\.\d*?)(0+))($|e)/,function(a,b,d,c,x){return"."!==d?d+x:x});default:throw Error('Unknown notation "'+b+'". Choose "auto", "exponential", or "fixed".');}};h.toExponential=
function(c,a){return(new p(c)).toExponential(a)};h.toFixed=function(c,a){return(new p(c)).toFixed(a)};h.toPrecision=function(c,a,b){return(new p(c)).toPrecision(a,b)};h.digits=function(c){return c.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length};h.DBL_EPSILON=Number.EPSILON||2.220446049250313E-16;h.nearlyEqual=function(c,a,b){if(null==b)return c==a;if(c==a)return!0;if(isNaN(c)||isNaN(a))return!1;if(isFinite(c)&&isFinite(a)){var d=Math.abs(c-a);return d<h.DBL_EPSILON?!0:d<=Math.max(Math.abs(c),
Math.abs(a))*b}return!1}},function(q,h){function g(c){var a=String(c).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!a)throw new SyntaxError("Invalid number");c=a[1];var b=a[2],d=parseFloat(a[4]||"0"),a=b.indexOf("."),d=d+(-1!==a?a-1:b.length-1);this.sign=c;this.coefficients=b.replace(".","").replace(/^0*/,function(a){d-=a.length;return""}).replace(/0*$/,"").split("").map(function(a){return parseInt(a)});0===this.coefficients.length&&(this.coefficients.push(0),d++);this.exponent=d}
function p(c){for(var a=[],b=0;b<c;b++)a.push(0);return a}g.prototype.toFixed=function(c){var a=this.roundDigits(this.exponent+1+(c||0)),b=a.coefficients,a=a.exponent+1,d=a+(c||0);b.length<d&&(b=b.concat(p(d-b.length)));0>a&&(b=p(-a+1).concat(b),a=1);c&&b.splice(a,0,0===a?"0.":".");return this.sign+b.join("")};g.prototype.toExponential=function(c){var a=c?this.roundDigits(c):this.clone(),b=a.coefficients,a=a.exponent;b.length<c&&(b=b.concat(p(c-b.length)));c=b.shift();return this.sign+c+(0<b.length?
"."+b.join(""):"")+"e"+(0<=a?"+":"")+a};g.prototype.toPrecision=function(c,a){var b=a&&void 0!==a.lower?a.lower:.001,d=a&&void 0!==a.upper?a.upper:1E5,e=Math.abs(Math.pow(10,this.exponent));if(e<b||e>=d)return this.toExponential(c);d=c?this.roundDigits(c):this.clone();b=d.coefficients;d=d.exponent;b.length<c&&(b=b.concat(p(c-b.length)));b=b.concat(p(d-b.length+1+(b.length<c?c-b.length:0)));b=p(-d).concat(b);d=0<d?d:0;d<b.length-1&&b.splice(d+1,0,".");return this.sign+b.join("")};g.prototype.clone=
function(){var c=new g("0");c.sign=this.sign;c.coefficients=this.coefficients.slice(0);c.exponent=this.exponent;return c};g.prototype.roundDigits=function(c){for(var a=this.clone(),b=a.coefficients;0>=c;)b.unshift(0),a.exponent++,c++;if(b.length>c&&5<=b.splice(c)[0])for(c-=1,b[c]++;10===b[c];)b.pop(),0===c&&(b.unshift(0),a.exponent++,c++),c--,b[c]++;return a};q.exports=g},function(q,h,g){var p=g(9);h.mixin=function(c){var a=new p;c.on=a.on.bind(a);c.off=a.off.bind(a);c.once=a.once.bind(a);c.emit=
a.emit.bind(a);return c}},function(q,h){function g(){}g.prototype={on:function(g,c,a){var b=this.e||(this.e={});(b[g]||(b[g]=[])).push({fn:c,ctx:a});return this},once:function(g,c,a){function b(){d.off(g,b);c.apply(a,arguments)}var d=this;b._=c;return this.on(g,b,a)},emit:function(g){var c=[].slice.call(arguments,1),a=((this.e||(this.e={}))[g]||[]).slice(),b=0,d=a.length;for(b;b<d;b++)a[b].fn.apply(a[b].ctx,c);return this},off:function(g,c){var a=this.e||(this.e={}),b=a[g],d=[];if(b&&c)for(var e=
0,f=b.length;e<f;e++)b[e].fn!==c&&b[e].fn._!==c&&d.push(b[e]);d.length?a[g]=d:delete a[g];return this}};q.exports=g},function(q,h,g){var p=g(3).lazy,c=g(3).isFactory,a=g(3).traverse;g(3);var b=g(11);h.math=!0;h.name="import";h.factory=function(d,e,f,k,m){function x(a,d){var e=arguments.length;if(1!=e&&2!=e)throw new b("import",e,1,2);d||(d={});if(c(a))v(a,d);else if(Array.isArray(a))a.forEach(function(a){x(a,d)});else if("object"===typeof a)for(var f in a)a.hasOwnProperty(f)&&(e=a[f],"function"==
typeof e||"number"===typeof e||"string"===typeof e||"boolean"===typeof e||null===e||e&&!0===e.isUnit||e&&!0===e.isComplex?A(f,e,d):c(a)?v(a,d):x(e,d));else if(!d.silent)throw new TypeError("Factory, Object, or Array expected");}function A(a,b,d){d.wrap&&"function"===typeof b&&(b=s(b));if(l(m[a])&&l(b))b=d.override?k(a,b.signatures):k(m[a],b),m[a]=b,n(a,b),m.emit("import",a,function(){return b});else if(void 0===m[a]||d.override)m[a]=b,n(a,b),m.emit("import",a,function(){return b});else if(!d.silent)throw Error('Cannot import "'+
a+'": already exists');}function n(a,b){b&&"function"===typeof b.transform&&(m.expression.transform[a]=b.transform)}function s(a){var b=function(){for(var b=[],d=0,c=arguments.length;d<c;d++){var e=arguments[d];b[d]=e&&e.valueOf()}return a.apply(m,b)};a.transform&&(b.transform=a.transform);return b}function v(b,d){if("string"===typeof b.name){var c=b.name,e=b.path?a(m,b.path):m,x=e.hasOwnProperty(c)?e[c]:void 0,n=function(){var a=f(b);if(l(x)&&l(a))return d.override||(a=k(x,a)),a;if(void 0===x||d.override)return a;
if(!d.silent)throw Error('Cannot import "'+c+'": already exists');};!1!==b.lazy?p(e,c,n):e[c]=n();m.emit("import",c,n,b.path)}else f(b)}function l(a){return"function"===typeof a&&"object"===typeof a.signatures}return x};h.lazy=!0},function(q,h){function g(h,c,a,b){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");this.fn=h;this.count=c;this.min=a;this.max=b;this.message="Wrong number of arguments in function "+h+" ("+c+" provided, "+a+(void 0!=b?"-"+
b:"")+" expected)";this.stack=Error().stack}g.prototype=Error();g.prototype.constructor=Error;g.prototype.name="ArgumentsError";g.prototype.isArgumentsError=!0;q.exports=g},function(q,h,g){var p=g(3);h.name="config";h.math=!0;h.factory=function(c,a,b,d,e){return function(b){if(b){var d=p.clone(a);p.deepExtend(a,b);b=p.clone(a);e.emit("config",b,d);return b}return p.clone(a)}}},function(q,h,g){var p=g(14).string.isString;h.name="Matrix";h.path="type";h.factory=function(c,a,b,d){function e(){if(!(this instanceof
e))throw new SyntaxError("Constructor must be called with the new operator");}e.prototype.type="Matrix";e.prototype.isMatrix=!0;e.storage=function(a){if(!p(a))throw new TypeError("format must be a string value");var b=e._storage[a];if(!b)throw new SyntaxError("Unsupported matrix storage format: "+a);return b};e._storage={};e.prototype.storage=function(){throw Error("Cannot invoke storage on a Matrix interface");};e.prototype.datatype=function(){throw Error("Cannot invoke datatype on a Matrix interface");
};e.prototype.create=function(a,b){throw Error("Cannot invoke create on a Matrix interface");};e.prototype.subset=function(a,b,d){throw Error("Cannot invoke subset on a Matrix interface");};e.prototype.get=function(a){throw Error("Cannot invoke get on a Matrix interface");};e.prototype.set=function(a,b,d){throw Error("Cannot invoke set on a Matrix interface");};e.prototype.resize=function(a,b){throw Error("Cannot invoke resize on a Matrix interface");};e.prototype.clone=function(){throw Error("Cannot invoke clone on a Matrix interface");
};e.prototype.size=function(){throw Error("Cannot invoke size on a Matrix interface");};e.prototype.map=function(a,b){throw Error("Cannot invoke map on a Matrix interface");};e.prototype.forEach=function(a){throw Error("Cannot invoke forEach on a Matrix interface");};e.prototype.toArray=function(){throw Error("Cannot invoke toArray on a Matrix interface");};e.prototype.valueOf=function(){throw Error("Cannot invoke valueOf on a Matrix interface");};e.prototype.format=function(a){throw Error("Cannot invoke format on a Matrix interface");
};e.prototype.toString=function(){throw Error("Cannot invoke toString on a Matrix interface");};return e}},function(q,h,g){h.array=g(15);h["boolean"]=g(21);h["function"]=g(22);h.number=g(6);h.object=g(3);h.string=g(16);h.types=g(18);h.emitter=g(8)},function(q,h,g){function p(a,b,d){var c=a.length;if(c!=b[d])throw new k(c,b[d]);if(d<b.length-1){var e=d+1;for(d=0;d<c;d++){if(!Array.isArray(a[d]))throw new k(b.length-1,b.length,"<");p(a[d],b,e)}}else for(d=0;d<c;d++)if(Array.isArray(a[d]))throw new k(b.length+
1,b.length,">");}function c(a,b,d,e){var k,m=b[d],g=Math.min(a.length,m);a.length=m;if(d<b.length-1){var t=d+1;for(d=0;d<g;d++)k=a[d],Array.isArray(k)||(k=[k],a[d]=k),c(k,b,t,e);for(d=g;d<m;d++)k=[],a[d]=k,c(k,b,t,e)}else{for(d=0;d<g;d++)for(;Array.isArray(a[d]);)a[d]=a[d][0];if(e!==h.UNINITIALIZED)for(d=g;d<m;d++)a[d]=f.clone(e)}}function a(b,d,c){var e;if(c<d){var f=c+1;c=0;for(e=b.length;c<e;c++)b[c]=a(b[c],d,f)}else for(;Array.isArray(b);)b=b[0];return b}function b(a,d,c){var e;if(Array.isArray(a)){var f=
c+1;c=0;for(e=a.length;c<e;c++)a[c]=b(a[c],d,f)}else for(;c<d;c++)a=[a];return a}var d=g(6),e=g(16),f=g(3);g(18);var k=g(19),m=g(20);h.size=function(a){for(var b=[];Array.isArray(a);)b.push(a.length),a=a[0];return b};h.validate=function(a,b){if(0==b.length){if(Array.isArray(a))throw new k(a.length,0);}else p(a,b,0)};h.validateIndex=function(a,b){if(!d.isNumber(a)||!d.isInteger(a))throw new TypeError("Index must be an integer (value: "+a+")");if(0>a)throw new m(a);if(void 0!==b&&a>=b)throw new m(a,
b);};h.UNINITIALIZED={};h.resize=function(a,b,f){if(!Array.isArray(a)||!Array.isArray(b))throw new TypeError("Array expected");if(0===b.length)throw Error("Resizing to scalar is not supported");b.forEach(function(a){if(!d.isNumber(a)||!d.isInteger(a)||0>a)throw new TypeError("Invalid size, must contain positive integers (size: "+e.format(b)+")");});c(a,b,0,void 0!==f?f:0);return a};h.squeeze=function(b,d){for(var c=d||h.size(b);Array.isArray(b)&&1===b.length;)b=b[0],c.shift();for(var e=c.length;1===
c[e-1];)e--;e<c.length&&(b=a(b,e,0),c.length=e);return b};h.unsqueeze=function(a,d,c,e){e=e||h.size(a);if(c)for(var f=0;f<c;f++)a=[a],e.unshift(1);for(a=b(a,d,0);e.length<d;)e.push(1);return a};h.flatten=function(a){if(!Array.isArray(a))return a;var b=[];a.forEach(function s(a){Array.isArray(a)?a.forEach(s):b.push(a)});return b};h.isArray=Array.isArray},function(q,h,g){function p(a,d){if(Array.isArray(a)){for(var c="[",f=a.length,k=0;k<f;k++)0!=k&&(c+=", "),c+=p(a[k],d);return c+"]"}return h.format(a,
d)}var c=g(6).format,a=g(17).format;h.isString=function(a){return"string"===typeof a};h.endsWith=function(a,d){return a.substring(a.length-d.length,a.length)===d};h.format=function(b,d){return"number"===typeof b?c(b,d):b&&!0===b.isBigNumber?a(b,d):b&&!0===b.isFraction?d&&"decimal"===d.fraction?b.toString():b.s*b.n+"/"+b.d:Array.isArray(b)?p(b,d):h.isString(b)?'"'+b+'"':"function"===typeof b?b.syntax?b.syntax+"":"function":"object"===typeof b?"function"===typeof b.format?b.format(d):b.toString():String(b)}},
function(q,h){h.format=function(g,p){if("function"===typeof p)return p(g);if(!g.isFinite())return g.isNaN()?"NaN":g.gt(0)?"Infinity":"-Infinity";var c="auto",a=void 0;void 0!==p&&(p.notation&&(c=p.notation),"number"===typeof p?a=p:p.precision&&(a=p.precision));switch(c){case "fixed":return h.toFixed(g,a);case "exponential":return h.toExponential(g,a);case "auto":var c=.001,b=1E5;p&&p.exponential&&(void 0!==p.exponential.lower&&(c=p.exponential.lower),void 0!==p.exponential.upper&&(b=p.exponential.upper));
g.constructor.config({toExpNeg:Math.round(Math.log(c)/Math.LN10),toExpPos:Math.round(Math.log(b)/Math.LN10)});if(g.isZero())return"0";var d=g.abs();return(d.gte(c)&&d.lt(b)?g.toSignificantDigits(a).toFixed():h.toExponential(g,a)).replace(/((\.\d*?)(0+))($|e)/,function(a,b,d,c,x){return"."!==d?d+x:x});default:throw Error('Unknown notation "'+c+'". Choose "auto", "exponential", or "fixed".');}};h.toExponential=function(g,h){return void 0!==h?g.toExponential(h-1):g.toExponential()};h.toFixed=function(g,
h){return g.toFixed(h||0)}},function(q,h){h.type=function(g){var h=typeof g;return"object"===h?null===g?"null":g instanceof Boolean?"boolean":g instanceof Number?"number":g instanceof String?"string":Array.isArray(g)?"Array":g instanceof Date?"Date":g instanceof RegExp?"RegExp":"Object":"function"===h?"Function":h}},function(q,h){function g(h,c,a){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");this.actual=h;this.expected=c;this.relation=a;this.message=
"Dimension mismatch ("+(Array.isArray(h)?"["+h.join(", ")+"]":h)+" "+(this.relation||"!=")+" "+(Array.isArray(c)?"["+c.join(", ")+"]":c)+")";this.stack=Error().stack}g.prototype=new RangeError;g.prototype.constructor=RangeError;g.prototype.name="DimensionError";g.prototype.isDimensionError=!0;q.exports=g},function(q,h){function g(h,c,a){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");this.index=h;3>arguments.length?(this.min=0,this.max=c):(this.min=
c,this.max=a);this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+this.index+")";this.stack=Error().stack}g.prototype=new RangeError;g.prototype.constructor=RangeError;g.prototype.name="IndexError";g.prototype.isIndexError=!0;q.exports=g},function(q,h){h.isBoolean=function(g){return"boolean"==typeof g}},function(q,h){h.memoize=
function(g,h){return function a(){"object"!==typeof a.cache&&(a.cache={});for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];d=h?h(b):JSON.stringify(b);return d in a.cache?a.cache[d]:a.cache[d]=g.apply(g,b)}}},function(q,h,g){var p=g(14),c=g(19),a=p.string,b=p.array,d=p.object;q=p.number;var e=Array.isArray,f=q.isNumber,k=q.isInteger,m=a.isString,x=b.validateIndex;h.name="DenseMatrix";h.path="type";h.factory=function(A,n,s,v){function l(a,c){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");
if(c&&!m(c))throw Error("Invalid datatype: "+c);if(a&&!0===a.isMatrix)"DenseMatrix"===a.type?(this._data=d.clone(a._data),this._size=d.clone(a._size)):(this._data=a.toArray(),this._size=a.size()),this._datatype=c||a._datatype;else if(a&&e(a.data)&&e(a.size))this._data=a.data,this._size=a.size,this._datatype=c||a.datatype;else{if(e(a))this._data=z(a),this._size=b.size(this._data),b.validate(this._data,this._size);else{if(a)throw new TypeError("Unsupported type of data ("+p.types.type(a)+")");this._data=
[];this._size=[0]}this._datatype=c}}function h(a,b,d,c){var e=c==d-1,f=b.dimension(c);return e?f.map(function(b){return a[b]}).valueOf():f.map(function(e){return h(a[e],b,d,c+1)}).valueOf()}function t(a,e,f,k){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var m=e.size(),l=e.isScalar(),x;f&&!0===f.isMatrix?(x=f.size(),f=f.valueOf()):x=b.size(f);if(l){if(0!==x.length)throw new TypeError("Scalar expected");a.set(e.min(),f,k)}else{if(m.length<a._size.length)throw new c(m.length,a._size.length,
"<");if(x.length<m.length){for(var n=l=0;1===m[l]&&1===x[l];)l++;for(;1===m[l];)n++,l++;f=b.unsqueeze(f,m.length,n,x)}if(!d.deepEqual(m,x))throw new c(m,x,">");x=e.max().map(function(a){return a+1});y(a,x,k);r(a._data,e,f,m.length,0)}return a}function r(a,b,d,c,e){var f=e==c-1,k=b.dimension(e);f?k.forEach(function(b,c){x(b);a[b]=d[c[0]]}):k.forEach(function(f,k){x(f);r(a[f],b,d[k[0]],c,e+1)})}function y(a,b,c){for(var e=d.clone(a._size),f=!1;e.length<b.length;)e.push(0),f=!0;for(var k=0,m=b.length;k<
m;k++)b[k]>e[k]&&(e[k]=b[k],f=!0);f&&w(a,e,c)}function z(a){for(var b=0,d=a.length;b<d;b++){var c=a[b];e(c)?a[b]=z(c):c&&!0===c.isMatrix&&(a[b]=z(c.valueOf()))}return a}n=s(g(13));l.prototype=new n;l.prototype.type="DenseMatrix";l.prototype.isDenseMatrix=!0;l.prototype.storage=function(){return"dense"};l.prototype.datatype=function(){return this._datatype};l.prototype.create=function(a,b){return new l(a,b)};l.prototype.subset=function(a,b,d){switch(arguments.length){case 1:var e;if(!a||!0!==a.isIndex)throw new TypeError("Invalid index");
if(a.isScalar())e=this.get(a.min());else{e=a.size();if(e.length!=this._size.length)throw new c(e.length,this._size.length);for(var f=a.min(),k=a.max(),m=0,n=this._size.length;m<n;m++)x(f[m],this._size[m]),x(k[m],this._size[m]);e=new l(h(this._data,a,e.length,0),this._datatype)}return e;case 2:case 3:return t(this,a,b,d);default:throw new SyntaxError("Wrong number of arguments");}};l.prototype.get=function(a){if(!e(a))throw new TypeError("Array expected");if(a.length!=this._size.length)throw new c(a.length,
this._size.length);for(var b=0;b<a.length;b++)x(a[b],this._size[b]);for(var b=this._data,f=0,k=a.length;f<k;f++){var m=a[f];x(m,b.length);b=b[m]}return d.clone(b)};l.prototype.set=function(a,b,d){if(!e(a))throw new TypeError("Array expected");if(a.length<this._size.length)throw new c(a.length,this._size.length,"<");var f,k;f=a.map(function(a){return a+1});y(this,f,d);var m=this._data;d=0;for(f=a.length-1;d<f;d++)k=a[d],x(k,m.length),m=m[k];k=a[a.length-1];x(k,m.length);m[k]=b;return this};l.prototype.resize=
function(a,b,d){if(!e(a))throw new TypeError("Array expected");d=d?this.clone():this;return w(d,a,b)};var w=function(a,c,f){if(0===c.length){for(a=a._data;e(a);)a=a[0];return d.clone(a)}a._size=d.clone(c);a._data=b.resize(a._data,a._size,f);return a};l.prototype.clone=function(){return new l({data:d.clone(this._data),size:d.clone(this._size),datatype:this._datatype})};l.prototype.size=function(){return this._size};l.prototype.map=function(a){var b=this,c=function(d,f){return e(d)?d.map(function(a,
b){return c(a,f.concat(b))}):a(d,f,b)};return new l({data:c(this._data,[]),size:d.clone(this._size),datatype:this._datatype})};l.prototype.forEach=function(a){var b=this,d=function(c,f){e(c)?c.forEach(function(a,b){d(a,f.concat(b))}):a(c,f,b)};d(this._data,[])};l.prototype.toArray=function(){return d.clone(this._data)};l.prototype.valueOf=function(){return this._data};l.prototype.format=function(b){return a.format(this._data,b)};l.prototype.toString=function(){return a.format(this._data)};l.prototype.toJSON=
function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}};l.prototype.diagonal=function(a){if(a){if(!0===a.isBigNumber&&(a=a.toNumber()),!f(a)||!k(a))throw new TypeError("The parameter k must be an integer number");}else a=0;var b=0<a?a:0;a=0>a?-a:0;for(var c=Math.min(this._size[0]-a,this._size[1]-b),e=[],m=0;m<c;m++)e[m]=d.clone(this._data[m+a][m+b]);return new l({data:e,size:[c],datatype:this._datatype})};l.diagonal=function(a,d,c,x,n){if(!e(a))throw new TypeError("Array expected, size parameter");
if(2!==a.length)throw Error("Only two dimensions matrix are supported");a=a.map(function(a){a&&!0===a.isBigNumber&&(a=a.toNumber());if(!f(a)||!k(a)||1>a)throw Error("Size values must be positive integers");return a});if(c){if(c&&!0===c.isBigNumber&&(c=c.toNumber()),!f(c)||!k(c))throw new TypeError("The parameter k must be an integer number");}else c=0;x&&m(n)&&(x=v.convert(x,n));n=0<c?c:0;c=0>c?-c:0;var s=a[0],r=a[1],g=Math.min(s-c,r-n),h;if(e(d)){if(d.length!==g)throw Error("Invalid value array length");
h=function(a){return d[a]}}else if(d&&!0===d.isMatrix){h=d.size();if(1!==h.length||h[0]!==g)throw Error("Invalid matrix length");h=function(a){return d.get([a])}}else h=function(){return d};x||(x=h(0)&&!0===h(0).isBigNumber?new A.BigNumber(0):0);var t=[];if(0<a.length)for(t=b.resize(t,a,x),a=0;a<g;a++)t[a+c][a+n]=h(a);return new l({data:t,size:[s,r]})};l.fromJSON=function(a){return new l(a)};l.prototype.swapRows=function(a,b){if(!(f(a)&&k(a)&&f(b)&&k(b)))throw Error("Row index must be positive integers");
if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");x(a,this._size[0]);x(b,this._size[0]);l._swapRows(a,b,this._data);return this};l._swapRows=function(a,b,d){var c=d[a];d[a]=d[b];d[b]=c};A.Matrix._storage.dense=l;return A.Matrix._storage["default"]=l};h.lazy=!1},function(q,h,g){var p=g(25),c=g(26);h.name="sin";h.factory=function(a,b,d,e){var f=e.find(d(g(31)),["number"]),k=e.find(d(g(33)),["number"]),m=e("sin",{number:Math.sin,Complex:function(b){return new a.Complex(Math.sin(b.re)*
f(-b.im),Math.cos(b.re)*k(b.im))},BigNumber:function(b){return c(b,a.BigNumber,1,!1)},Unit:function(b){if(!b.hasBase(a.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return Math.sin(b.value)},"Array | Matrix":function(a){return p(a,m,!0)}});m.toTex="\\sin\\left(${args[0]}\\right)";return m}},function(q,h){q.exports=function p(c,a,b){return c&&"function"===typeof c.map?c.map(function(d){return p(d,a,b)}):a(c)}},function(q,h,g){var p=g(27),c=g(30);q.exports=function(a,
b,d,e){if(a.isNaN()||!a.isFinite())return new b(NaN);var f=b.precision,k=new b(a);if(a=k.isNegative())k.s=-k.s;var m=f+(Math.log(f)|0)+3;b.config({precision:m});k=p(k,b.constructor({precision:m}),d);k[0].constructor=b;if(k[1])return k=k[0],e&&k.isZero()&&(k=new b(Infinity)),b.config({precision:f}),k;k=k[0];if(d){d=c(k.div(3125),d);b.config({precision:Math.min(m,f+15)});for(var k=new b(5),x=new b(16),A=new b(20),n=0;5>n;++n){var m=d.times(d),s=m.times(d),m=s.times(m);d=x.times(m).minus(A.times(s)).plus(k.times(d))}a&&
(d.s=-d.s)}else for(k.abs().lt(b.ONE)?(x=64,a=3):(x=256,a=4),d=c(k.div(x),d),b.config({precision:Math.min(m,f+8)}),k=new b(8);0<a;--a)m=d.times(d),d=m.times(m),d=k.times(d.minus(m)).plus(b.ONE);e&&(d=d.e<=-f?new b(Infinity):b.ONE.div(d));b.config({precision:f});return d.toDP(f-1)}},function(q,h,g){var p=g(28);q.exports=function(c,a,b){var d=p.pi(a.constructor({precision:a.precision+2})),e=p.tau(a);if(c.abs().lte(d.toDP(c.dp())))return[c,!1];if(0<c.dp()&&0==c.div(d.toDP(c.dp())).toNumber()%2)return[new a(b^
1),!0];var f=c.mod(e);if(0<c.dp()&&f.toDP(c.dp(),1).isZero())return[new a(b^1),!0];f.gt(d)&&(b?(f=f.minus(d),f.s=-f.s):f=e.minus(f));f.constructor=c.constructor;return[f,!1]}},function(q,h,g){function p(a){return a[0].precision}q=g(22).memoize;var c=g(29);h.e=q(function(a){return(new a(1)).exp()},p);h.phi=q(function(a){return(new a(1)).plus((new a(5)).sqrt()).div(2)},p);h.pi=q(function(a){var b=a.constructor({precision:a.precision+4}),b=(new b(4)).times(c((new b(1)).div(5))).minus(c((new b(1)).div(239)));
return(new a(4)).times(b)},p);h.tau=q(function(a){var b=h.pi(a.constructor({precision:a.precision+2}));return(new a(2)).times(b)},p)},function(q,h){q.exports=function(g){for(var h=g,c=NaN,a=g.times(g),b=!0,d=3;!h.equals(c);d+=2)g=g.times(a),c=h,h=(b=!b)?h.plus(g.div(d)):h.minus(g.div(d));return h}},function(q,h){q.exports=function(g,h){for(var c=g.constructor.ONE,a=g,b=NaN,d=g.times(g),e=h?a:a=c,f=!0,k=h;!a.equals(b);k+=2)e=e.times(d),c=c.times(k+1).times(k+2),b=a,a=(f=!f)?a.plus(e.div(c)):a.minus(e.div(c));
return a}},function(q,h,g){function p(a){return(Math.exp(a)+Math.exp(-a))/2}var c=g(25),a=g(32);h.name="cosh";h.factory=function(b,d,e,f){var k=f("cosh",{number:p,Complex:function(a){var d=Math.exp(a.re),c=Math.exp(-a.re);return new b.Complex(Math.cos(a.im)*(d+c)/2,Math.sin(a.im)*(d-c)/2)},BigNumber:function(d){return a(d,b.BigNumber,!1,!1)},Unit:function(a){if(!a.hasBase(b.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return p(a.value)},"Array | Matrix":function(a){return c(a,
k)}});k.toTex="\\cosh\\left(${args[0]}\\right)";return k}},function(q,h){q.exports=function(g,h,c,a){if(g.isNaN())return new h(NaN);if(!g.isFinite())return a?new h(0):new h(c?g:Infinity);var b=h.precision;h.config({precision:b+4});g=new h(g);g.constructor=h;g=g.exp();g=c?g.minus(h.ONE.div(g)):g.plus(h.ONE.div(g));g=a?(new h(2)).div(g):g.div(2);h.config({precision:b});return new h(g.toPrecision(b))}},function(q,h,g){function p(a){return 1>Math.abs(a)?a+a*a*a/6+a*a*a*a*a/120:(Math.exp(a)-Math.exp(-a))/
2}var c=g(25),a=g(32);h.name="sinh";h.factory=function(b,d,e,f){var k=f("sinh",{number:p,Complex:function(a){var d=Math.cos(a.im),c=Math.sin(a.im),e=Math.exp(a.re);a=Math.exp(-a.re);return new b.Complex(d*(e-a)/2,c*(e+a)/2)},BigNumber:function(d){return a(d,b.BigNumber,!0,!1)},Unit:function(a){if(!a.hasBase(b.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return p(a.value)},"Array | Matrix":function(a){return c(a,k,!0)}});k.toTex="\\sinh\\left(${args[0]}\\right)";
return k}},function(q,h,g){var p=g(25),c=g(26);h.name="cos";h.factory=function(a,b,d,e){var f=e.find(d(g(31)),["number"]),k=e.find(d(g(33)),["number"]),m=e("cos",{number:Math.cos,Complex:function(b){return new a.Complex(Math.cos(b.re)*f(-b.im),Math.sin(b.re)*k(-b.im))},BigNumber:function(b){return c(b,a.BigNumber,0,!1)},Unit:function(b){if(!b.hasBase(a.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return Math.cos(b.value)},"Array | Matrix":function(a){return p(a,m)}});
m.toTex="\\cos\\left(${args[0]}\\right)";return m}},function(q,h,g){var p=g(25);h.name="sqrt";h.factory=function(c,a,b,d){function e(b){return 0<=b||a.predictable?Math.sqrt(b):f(new c.Complex(b,0))}function f(a){var b=Math.sqrt(a.re*a.re+a.im*a.im),d;d=0<=a.re?.5*Math.sqrt(2*(b+a.re)):Math.abs(a.im)/Math.sqrt(2*(b-a.re));b=0>=a.re?.5*Math.sqrt(2*(b-a.re)):Math.abs(a.im)/Math.sqrt(2*(b+a.re));return 0<=a.im?new c.Complex(d,b):new c.Complex(d,-b)}var k=d("sqrt",{number:e,Complex:f,BigNumber:function(b){return!b.isNegative()||
a.predictable?b.sqrt():e(b.toNumber())},"Array | Matrix":function(a){return p(a,k,!0)},Unit:function(a){return a.pow(.5)}});k.toTex="\\sqrt{${args[0]}}";return k}},function(q,h,g){h.name="norm";h.factory=function(h,c,a,b){function d(a,b){var c=a.size();if(1==c.length){if(b===Number.POSITIVE_INFINITY||"inf"===b){var v=0;a.forEach(function(a){a=e(a);n(a,v)&&(v=a)},!0);return v}if(b===Number.NEGATIVE_INFINITY||"-inf"===b){var g;a.forEach(function(a){a=e(a);if(!g||s(a,g))g=a},!0);return g||0}if("fro"===
b)return d(a,2);if("number"===typeof b&&!isNaN(b)){if(!A(b,0)){var h=0;a.forEach(function(a){h=f(k(e(a),b),h)},!0);return k(h,1/b)}return Number.POSITIVE_INFINITY}throw Error("Unsupported parameter value");}if(2==c.length){if(1===b){var t=[],p=0;a.forEach(function(a,b){var d=b[1],c=f(t[d]||0,e(a));n(c,p)&&(p=c);t[d]=c},!0);return p}if(b===Number.POSITIVE_INFINITY||"inf"===b){var q=[],F=0;a.forEach(function(a,b){var d=b[0],c=f(q[d]||0,e(a));n(c,F)&&(F=c);q[d]=c},!0);return F}if("fro"===b)return m(l(x(u(a),
a)));if(2===b)throw Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw Error("Unsupported parameter value");}}var e=a(g(37)),f=a(g(38)),k=a(g(48)),m=a(g(35)),x=a(g(53)),A=a(g(44)),n=a(g(56)),s=a(g(60)),v=a(g(39)),l=a(g(61)),u=a(g(62));h=b.find(e,["Complex"]);var t=b("norm",{number:Math.abs,Complex:h,BigNumber:function(a){return a.abs()},"boolean | null":function(a){return Math.abs(a)},Array:function(a){return d(v(a),2)},Matrix:function(a){return d(a,
2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(a){return t(a)},"Array, number | BigNumber | string":function(a,b){return d(v(a),b)},"Matrix, number | BigNumber | string":function(a,b){return d(a,b)}});t.toTex={1:"\\left\\|${args[0]}\\right\\|",2:"\\mathrm{${name}}\\left(${args}\\right)"};return t}},function(q,h,g){var p=g(25);h.name="abs";h.factory=function(c,a,b,d){var e=d("abs",{number:Math.abs,Complex:function(a){var b=Math.abs(a.re);a=Math.abs(a.im);
if(1E3>b&&1E3>a)return Math.sqrt(b*b+a*a);if(b>=a)return a/=b,b*Math.sqrt(1+a*a);b/=a;return a*Math.sqrt(1+b*b)},BigNumber:function(a){return a.abs()},Fraction:function(a){return a.abs()},"Array | Matrix":function(a){return p(a,e,!0)},Unit:function(a){a=a.clone();a.value=Math.abs(a.value);return a}});e.toTex="\\left|${args[0]}\\right|";return e}},function(q,h,g){var p=g(3).extend;h.name="add";h.factory=function(c,a,b,d){var e=b(g(39)),f=b(g(40));c=g(41);var k=b(g(42)),m=b(g(43)),x=b(g(45)),A=b(g(46)),
n=b(g(47)),s=d("add",p({"Matrix, Matrix":function(a,b){var d;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":d=m(a,b,f);break;default:d=k(b,a,f,!0)}break;default:switch(b.storage()){case "sparse":d=k(a,b,f,!1);break;default:d=A(a,b,f)}}return d},"Array, Array":function(a,b){return s(e(a),e(b)).valueOf()},"Array, Matrix":function(a,b){return s(e(a),b)},"Matrix, Array":function(a,b){return s(a,e(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=x(a,b,f,!1);
break;default:d=n(a,b,f,!1)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=x(b,a,f,!0);break;default:d=n(b,a,f,!0)}return d},"Array, any":function(a,b){return n(e(a),b,f,!1).valueOf()},"any, Array":function(a,b){return n(e(b),a,f,!0).valueOf()}},f.signatures));s.toTex="\\left(${args[0]}"+c.operators.add+"${args[1]}\\right)";return s}},function(q,h){h.name="matrix";h.factory=function(g,h,c,a){function b(a,b,c){return new (g.Matrix.storage(b||"default"))(a,c)}h=a("matrix",
{"":function(){return b([])},string:function(a){return b([],a)},"string, string":function(a,c){return b([],a,c)},Array:function(a){return b(a)},Matrix:function(a){return b(a,a.storage())},"Array | Matrix, string":b,"Array | Matrix, string, string":b});h.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"};return h}},function(q,h){h.factory=function(g,h,c,a){return a("add",{"number, number":function(a,d){return a+d},"Complex, Complex":function(a,d){return new g.Complex(a.re+
d.re,a.im+d.im)},"BigNumber, BigNumber":function(a,d){return a.plus(d)},"Fraction, Fraction":function(a,d){return a.add(d)},"Unit, Unit":function(a,d){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");if(null==d.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(d))throw Error("Units do not match");var c=a.clone();c.value+=d.value;c.fixPrefix=!1;return c}})}},function(q,h){h.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",
Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",
varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega","true":"\\mathrm{True}","false":"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"};h.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",
divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"};h.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var g={deg:"^\\circ"};h.toSymbol=function(p,c){if("undefined"===typeof c?0:c)return g.hasOwnProperty(p)?g[p]:
"\\mathrm{"+p+"}";if(h.symbols.hasOwnProperty(p))return h.symbols[p];if(-1!==p.indexOf("_")){var a=p.indexOf("_");return h.toSymbol(p.substring(0,a))+"_{"+h.toSymbol(p.substring(a+1))+"}"}return p}},function(q,h,g){var p=g(19);h.name="algorithm01";h.factory=function(c,a,b,d){var e=c.DenseMatrix;return function(a,b,c,x){var A=a._data,n=a._size,s=a._datatype;a=b._values;var g=b._index,l=b._ptr,h=b._size,t=b._datatype;if(n.length!==h.length)throw new p(n.length,h.length);if(n[0]!==h[0]||n[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+
n+") must match Matrix B ("+h+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");b=n[0];n=n[1];c=(s="string"===typeof s&&s===t?s:void 0)?d.find(c,[s,s]):c;for(var r=[],t=0;t<b;t++)r[t]=[];for(var y=[],z=[],h=0;h<n;h++){for(var w=h+1,q=l[h+1],B=l[h];B<q;B++)t=g[B],y[t]=x?c(a[B],A[t][h]):c(A[t][h],a[B]),z[t]=w;for(t=0;t<b;t++)r[t][h]=z[t]===w?y[t]:A[t][h]}return new e({data:r,size:[b,n],datatype:s})}}},function(q,h,g){var p=g(19);h.name="algorithm04";h.factory=
function(c,a,b,d){var e=b(g(44)),f=c.SparseMatrix;return function(a,b,c){var A=a._values,n=a._index,s=a._ptr,g=a._size,l=a._datatype;a=b._values;var h=b._index,t=b._ptr,r=b._size,y=b._datatype;if(g.length!==r.length)throw new p(g.length,r.length);if(g[0]!==r[0]||g[1]!==r[1])throw new RangeError("Dimension mismatch. Matrix A ("+g+") must match Matrix B ("+r+")");var z=g[0],g=g[1],w;b=e;var r=0,q=c;"string"===typeof l&&l===y&&(w=l,b=d.find(e,[w,w]),r=d.convert(0,w),q=d.find(c,[w,w]));c=A&&a?[]:void 0;
l=[];y=[];w=new f({values:c,index:l,ptr:y,size:[z,g],datatype:w});var z=A&&a?[]:void 0,B=A&&a?[]:void 0,E=[],K=[],H,F,D,V;for(F=0;F<g;F++){y[F]=l.length;var L=F+1;H=s[F];V=s[F+1];for(D=H;D<V;D++)H=n[D],l.push(H),E[H]=L,z&&(z[H]=A[D]);H=t[F];V=t[F+1];for(D=H;D<V;D++)if(H=h[D],E[H]===L){if(z){var P=q(z[H],a[D]);b(P,r)?E[H]=null:z[H]=P}}else l.push(H),K[H]=L,B&&(B[H]=a[D]);if(z&&B)for(D=y[F];D<l.length;)H=l[D],E[H]===L?(c[D]=z[H],D++):K[H]===L?(c[D]=B[H],D++):l.splice(D,1)}y[g]=l.length;return w}}},
function(q,h,g){var p=g(6).nearlyEqual;h.factory=function(c,a,b,d){return d("equalScalar",{"boolean, boolean":function(a,b){return a===b},"number, number":function(b,d){return b===d||p(b,d,a.epsilon)},"BigNumber, BigNumber":function(a,b){return a.eq(b)},"Fraction, Fraction":function(a,b){return a.equals(b)},"Complex, Complex":function(b,d){return(b.re===d.re||p(b.re,d.re,a.epsilon))&&(b.im===d.im||p(b.im,d.im,a.epsilon))},"Unit, Unit":function(b,d){if(!b.equalBase(d))throw Error("Cannot compare units with different base");
return b.value===d.value||p(b.value,d.value,a.epsilon)},"string, string":function(a,b){return a===b}})}},function(q,h){h.name="algorithm10";h.factory=function(g,h,c,a){var b=g.DenseMatrix;return function(d,c,f,k){var m=d._values,x=d._index,A=d._ptr,n=d._size,s=d._datatype;if(!m)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");d=n[0];var n=n[1],g,l=f;"string"===typeof s&&(g=s,c=a.convert(c,g),l=a.find(f,[g,g]));f=[];g=new b({data:f,size:[d,n],datatype:g});for(var s=
[],h=[],t=0;t<n;t++){for(var r=t+1,y=A[t+1],p=A[t];p<y;p++){var w=x[p];s[w]=m[p];h[w]=r}for(y=0;y<d;y++)0===t&&(f[y]=[]),f[y][t]=h[y]===r?k?l(c,s[y]):l(s[y],c):c}return g}}},function(q,h,g){g(14);var p=g(19);h.name="algorithm13";h.factory=function(c,a,b,d){var e=c.DenseMatrix,f=function(a,b,d,c,e,s){var g=[];if(b===d.length-1)for(b=0;b<c;b++)g[b]=a(e[b],s[b]);else for(var l=0;l<c;l++)g[l]=f(a,b+1,d,d[b+1],e[l],s[l]);return g};return function(a,b,c){var A=a._data,n=a._size,s=a._datatype,g=b._data,
l=b._size,h=b._datatype;a=[];if(n.length!==l.length)throw new p(n.length,l.length);for(var t=0;t<n.length;t++){if(n[t]!==l[t])throw new RangeError("Dimension mismatch. Matrix A ("+n+") must match Matrix B ("+l+")");a[t]=n[t]}var r,n=c;"string"===typeof s&&s===h&&(r=s,d.convert(b,r),n=d.find(c,[r,r]));b=0<a.length?f(n,0,a,a[0],A,g):[];return new e({data:b,size:a,datatype:r})}}},function(q,h,g){var p=g(3).clone;h.name="algorithm14";h.factory=function(c,a,b,d){var e=c.DenseMatrix,f=function(a,b,d,c,
e,g,h){var l=[];if(b===d.length-1)for(b=0;b<c;b++)l[b]=h?a(g,e[b]):a(e[b],g);else for(var u=0;u<c;u++)l[u]=f(a,b+1,d,d[b+1],e[u],g,h);return l};return function(a,b,c,g){var n=a._data,s=a._size;a=a._datatype;var h,l=c;"string"===typeof a&&(h=a,b=d.convert(b,h),l=d.find(c,[h,h]));b=0<s.length?f(l,0,s,s[0],n,b,g):[];return new e({data:b,size:p(s),datatype:h})}}},function(q,h,g){var p=g(6).isInteger,c=g(15).size;h.name="pow";h.factory=function(a,b,d,e){function f(d,c){return p(c)||0<=d||b.predictable?
Math.pow(d,c):k(new a.Complex(d,0),new a.Complex(c,0))}function k(a,b){return n(l(h(a),b))}function m(a,b){if(!p(b)||0>b)throw new TypeError("For A^b, b must be a positive integer (value is "+b+")");var d=c(a);if(2!=d.length)throw Error("For A^b, A must be 2 dimensional (A has "+d.length+" dimensions)");if(d[0]!=d[1])throw Error("For A^b, A must be square (size is "+d[0]+"x"+d[1]+")");for(var d=s(d[0]).valueOf(),e=a;1<=b;)1==(b&1)&&(d=l(e,d)),b>>=1,e=l(e,e);return d}function x(a,b){return u(m(a.valueOf(),
b))}var A=g(41),n=d(g(49)),s=d(g(50)),h=d(g(51)),l=d(g(53)),u=d(g(39));d=e("pow",{"number, number":f,"Complex, Complex":k,"BigNumber, BigNumber":function(d,c){return c.isInteger()||0<=d||b.predictable?d.pow(c):k(new a.Complex(d.toNumber(),0),new a.Complex(c.toNumber(),0))},"Fraction, Fraction":function(a,d){if(1!==d.d){if(b.predictable)throw Error("Function pow does not support non-integer exponents for fractions.");return f(a.valueOf(),d.valueOf())}return a.pow(d)},"Array, number":m,"Array, BigNumber":function(a,
b){return m(a,b.toNumber())},"Matrix, number":x,"Matrix, BigNumber":function(a,b){return x(a,b.toNumber())},"Unit, number":function(a,b){return a.pow(b)}});d.toTex="\\left(${args[0]}\\right)"+A.operators.pow+"{${args[1]}}";return d}},function(q,h,g){var p=g(25);h.name="exp";h.factory=function(c,a,b,d){var e=d("exp",{number:Math.exp,Complex:function(a){var b=Math.exp(a.re);return new c.Complex(b*Math.cos(a.im),b*Math.sin(a.im))},BigNumber:function(a){return a.exp()},"Array | Matrix":function(a){return p(a,
e)}});e.toTex="\\exp\\left(${args[0]}\\right)";return e}},function(q,h,g){var p=g(15),c=g(6).isInteger;h.name="eye";h.factory=function(a,b,d,e){function f(a,b){switch(a.length){case 0:return b?m(b):[];case 1:return k(a[0],a[0],b);case 2:return k(a[0],a[1],b);default:throw Error("Vector containing two values expected");}}function k(b,d,e){var f=b&&!0===b.isBigNumber?a.BigNumber:d&&!0===d.isBigNumber?a.BigNumber:null;b&&!0===b.isBigNumber&&(b=b.toNumber());d&&!0===d.isBigNumber&&(d=d.toNumber());if(!c(b)||
1>b)throw Error("Parameters in function eye must be positive integers");if(!c(d)||1>d)throw Error("Parameters in function eye must be positive integers");var k=f?new a.BigNumber(1):1,f=f?new f(0):0,m=[b,d];if(e)return a.Matrix.storage(e).diagonal(m,k,0,f);e=p.resize([],m,f);b=b<d?b:d;for(d=0;d<b;d++)e[d][d]=k;return e}var m=d(g(39));d=e("eye",{"":function(){return"matrix"===b.matrix?m([]):[]},string:function(a){return m(a)},"number | BigNumber":function(a){return k(a,a,"matrix"===b.matrix?"default":
void 0)},"number | BigNumber, string":function(a,b){return k(a,a,b)},"number | BigNumber, number | BigNumber":function(a,d){return k(a,d,"matrix"===b.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(a,b,d){return k(a,b,d)},Array:function(a){return f(a)},"Array, string":function(a,b){return f(a,b)},Matrix:function(a){return f(a.valueOf(),a.storage())},"Matrix, string":function(a,b){return f(a.valueOf(),b)}});d.toTex="\\mathrm{${name}}\\left(${args}\\right)";return d}},
function(q,h,g){var p=g(25);h.name="log";h.factory=function(c,a,b,d){function e(a){return new c.Complex(Math.log(Math.sqrt(a.re*a.re+a.im*a.im)),Math.atan2(a.im,a.re))}var f=b(g(52)),k=d("log",{number:function(b){return 0<=b||a.predictable?Math.log(b):k(new c.Complex(b,0))},Complex:e,BigNumber:function(b){return!b.isNegative()||a.predictable?b.ln():e(new c.Complex(b.toNumber(),0))},"Array | Matrix":function(a){return p(a,k)},"any, any":function(a,b){return f(k(a),k(b))}});k.toTex={1:"\\ln\\left(${args[0]}\\right)",
2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"};return k}},function(q,h){h.factory=function(g,h,c,a){return a("divide",{"number, number":function(a,d){return a/d},"Complex, Complex":function(a,d){var c=d.re*d.re+d.im*d.im;return 0!=c?new g.Complex((a.re*d.re+a.im*d.im)/c,(a.im*d.re-a.re*d.im)/c):new g.Complex(0!=a.re?a.re/0:0,0!=a.im?a.im/0:0)},"BigNumber, BigNumber":function(a,d){return a.div(d)},"Fraction, Fraction":function(a,d){return a.div(d)},"Unit, number":function(a,d){var c=a.clone();c.value=
(null===c.value?c._normalize(1):c.value)/d;return c},"number, Unit":function(a,d){var c=d.pow(-1);c.value=(null===c.value?c._normalize(1):c.value)*a;return c},"Unit, Unit":function(a,d){return a.divide(d)}})}},function(q,h,g){var p=g(3).extend,c=g(15);h.name="multiply";h.factory=function(a,b,d,e){b=g(41);var f=d(g(39)),k=d(g(40)),m=d(g(54)),x=d(g(44)),h=d(g(55)),n=d(g(47)),s=a.DenseMatrix,v=a.SparseMatrix,l=e("multiply",p({"Array, Array":function(a,b){u(c.size(a),c.size(b));var d=l(f(a),f(b));return d&&
!0===d.isMatrix?d.valueOf():d},"Matrix, Matrix":function(a,b){var d=a.size(),c=b.size();u(d,c);if(1===d.length){if(1===c.length){var f=d[0];if(0===f)throw Error("Cannot multiply two empty vectors");var l=a._data,n=a._datatype,g=b._data,h=b._datatype,d=k,c=m;n&&h&&n===h&&"string"===typeof n&&(d=e.find(k,[n,n]),c=e.find(m,[n,n]));n=c(l[0],g[0]);for(h=1;h<f;h++)n=d(n,c(l[h],g[h]));return n}a:{switch(b.storage()){case "dense":var f=a._data,A=a._datatype,l=b._data,p=b._datatype,d=a._size[0],c=b._size[1],
n=k,h=m;A&&p&&A===p&&"string"===typeof A&&(g=A,n=e.find(k,[g,g]),h=e.find(m,[g,g]));A=[];for(p=0;p<c;p++){for(var q=h(f[0],l[0][p]),L=1;L<d;L++)q=n(q,h(f[L],l[L][p]));A[p]=q}f=1===c?A[0]:new s({data:A,size:[c],datatype:g});break a}throw Error("Not implemented");}return f}if(1===c.length){a:{switch(a.storage()){case "dense":f=a._data;c=a._size;A=a._datatype;g=b._data;p=b._datatype;d=c[0];c=c[1];n=k;h=m;A&&p&&A===p&&"string"===typeof A&&(l=A,n=e.find(k,[l,l]),h=e.find(m,[l,l]));A=[];for(p=0;p<d;p++){for(var q=
f[p],L=h(q[0],g[0]),P=1;P<c;P++)L=n(L,h(q[P],g[P]));A[p]=L}f=1===d?A[0]:new s({data:A,size:[d],datatype:l});break a;case "sparse":var n=a._values,h=a._index,A=a._ptr,G=a._datatype;if(!n)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var p=b._data,C=b._datatype,l=a._size[0],q=b._size[0],g=[],d=[],c=[],L=k,P=m,J=x,M=0;G&&C&&G===C&&"string"===typeof G&&(f=G,L=e.find(k,[f,f]),P=e.find(m,[f,f]),J=e.find(x,[f,f]),M=e.convert(0,f));for(var G=[],C=[],U=c[0]=0;U<q;U++){var X=p[U];if(!J(X,
M))for(var Z=A[U+1],ua=A[U];ua<Z;ua++){var xa=h[ua];C[xa]?G[xa]=L(G[xa],P(X,n[ua])):(C[xa]=!0,d.push(xa),G[xa]=P(X,n[ua]))}}n=d.length;for(h=0;h<n;h++)g[h]=G[d[h]];c[1]=d.length;f=1===l?1===g.length?g[0]:0:new v({values:g,index:d,ptr:c,size:[l,1],datatype:f});break a}f=void 0}return f}return t(a,b)},"Matrix, Array":function(a,b){return l(a,f(b))},"Array, Matrix":function(a,b){return l(f(a,b.storage()),b)},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=h(a,b,m,!1);break;case "dense":d=
n(a,b,m,!1)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=h(b,a,m,!0);break;case "dense":d=n(b,a,m,!0)}return d},"Array, any":function(a,b){return n(f(a),b,m,!1).valueOf()},"any, Array":function(a,b){return n(f(b),a,m,!0).valueOf()}},m.signatures)),u=function(a,b){switch(a.length){case 1:switch(b.length){case 1:if(a[0]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(a[0]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+
a[0]+") must match Matrix rows ("+b[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+b.length+" dimensions)");}break;case 2:switch(b.length){case 1:if(a[1]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+a[1]+") must match Vector length ("+b[0]+")");break;case 2:if(a[1]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+a[1]+") must match Matrix B rows ("+b[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+
b.length+" dimensions)");}break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+a.length+" dimensions)");}},t=function(a,b){switch(a.storage()){case "dense":switch(b.storage()){case "dense":var d;var c=a._data,f=a._size,l=a._datatype,n=b._data,g=b._datatype,h=f[0],A=f[1],t=b._size[1],u,p=k,q=m;l&&g&&l===g&&"string"===typeof l&&(u=l,p=e.find(k,[u,u]),q=e.find(m,[u,u]));for(var G=[],C=0;C<h;C++){var J=c[C];G[C]=[];for(var M=0;M<t;M++){for(var U=q(J[0],n[0][M]),X=1;X<
A;X++)U=p(U,q(J[X],n[X][M]));G[C][M]=U}}d=1===h&&1===t?G[0][0]:new s({data:G,size:[h,t],datatype:u});return d;case "sparse":var Z;var ua=a._data,xa=a._size,sa=a._datatype,ja=b._values,ca=b._index,Ia=b._ptr,ba=b._size,fa=b._datatype;if(!ja)throw Error("Cannot multiply Dense Matrix times Pattern only Matrix");var ma=xa[0],va=ba[1],na,Ca=k,ya=m,N=x,Da=0;sa&&fa&&sa===fa&&"string"===typeof sa&&(na=sa,Ca=e.find(k,[na,na]),ya=e.find(m,[na,na]),N=e.find(x,[na,na]),Da=e.convert(0,na));for(var ga=[],za=[],
ia=[],S=new v({values:ga,index:za,ptr:ia,size:[ma,va],datatype:na}),ea=0;ea<va;ea++){ia[ea]=za.length;var ka=Ia[ea],W=Ia[ea+1];if(W>ka)for(var Y=0,O=0;O<ma;O++){for(var Q=O+1,da,aa=ka;aa<W;aa++){var pa=ca[aa];Y!==Q?(da=ya(ua[O][pa],ja[aa]),Y=Q):da=Ca(da,ya(ua[O][pa],ja[aa]))}Y!==Q||N(da,Da)||(za.push(O),ga.push(da))}}ia[va]=za.length;Z=1===ma&&1===va?1===ga.length?ga[0]:0:S;return Z}break;case "sparse":switch(b.storage()){case "dense":var $;var R=a._values,Ba=a._index,Na=a._ptr,Ea=a._datatype;if(!R)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");
var Oa=b._data,Pa=b._datatype,la=a._size[0],Fa=b._size[0],Ua=b._size[1],wa,ob=k,jb=m,T=x,pb=0;Ea&&Pa&&Ea===Pa&&"string"===typeof Ea&&(wa=Ea,ob=e.find(k,[wa,wa]),jb=e.find(m,[wa,wa]),T=e.find(x,[wa,wa]),pb=e.convert(0,wa));for(var Va=[],Ja=[],Wa=[],Ab=new v({values:Va,index:Ja,ptr:Wa,size:[la,Ua],datatype:wa}),Xa=[],qb=[],ha=0;ha<Ua;ha++){Wa[ha]=Ja.length;for(var rb=ha+1,Qa=0;Qa<Fa;Qa++){var kb=Oa[Qa][ha];if(!T(kb,pb))for(var Bb=Na[Qa+1],Ra=Na[Qa];Ra<Bb;Ra++){var Ka=Ba[Ra];qb[Ka]!==rb?(qb[Ka]=rb,Ja.push(Ka),
Xa[Ka]=jb(kb,R[Ra])):Xa[Ka]=ob(Xa[Ka],jb(kb,R[Ra]))}}for(var Cb=Ja.length,Ya=Wa[ha];Ya<Cb;Ya++)Va[Ya]=Xa[Ja[Ya]]}Wa[Ua]=Ja.length;$=1===la&&1===Ua?1===Va.length?Va[0]:0:Ab;return $;case "sparse":var sb;var lb=a._values,tb=a._index,Za=a._ptr,$a=a._datatype,mb=b._values,Db=b._index,ub=b._ptr,vb=b._datatype,wb=a._size[0],ab=b._size[1],Sa=lb&&mb,La,xb=k,nb=m;$a&&vb&&$a===vb&&"string"===typeof $a&&(La=$a,xb=e.find(k,[La,La]),nb=e.find(m,[La,La]));for(var bb=Sa?[]:void 0,Ga=[],cb=[],Eb=new v({values:bb,
index:Ga,ptr:cb,size:[wb,ab],datatype:La}),db=Sa?[]:void 0,eb=[],ta,fb,gb,Ma,yb,zb,ra,Ta,Ha=0;Ha<ab;Ha++){cb[Ha]=Ga.length;var hb=Ha+1;yb=ub[Ha];zb=ub[Ha+1];for(Ma=yb;Ma<zb;Ma++)if(Ta=Db[Ma],Sa)for(fb=Za[Ta],gb=Za[Ta+1],ta=fb;ta<gb;ta++)ra=tb[ta],eb[ra]!==hb?(eb[ra]=hb,Ga.push(ra),db[ra]=nb(mb[Ma],lb[ta])):db[ra]=xb(db[ra],nb(mb[Ma],lb[ta]));else for(fb=Za[Ta],gb=Za[Ta+1],ta=fb;ta<gb;ta++)ra=tb[ta],eb[ra]!==hb&&(eb[ra]=hb,Ga.push(ra));if(Sa)for(var Fb=Ga.length,ib=cb[Ha];ib<Fb;ib++)bb[ib]=db[Ga[ib]]}cb[ab]=
Ga.length;sb=1===wb&&1===ab&&Sa?1===bb.length?bb[0]:0:Eb;return sb}}};l.toTex="\\left(${args[0]}"+b.operators.multiply+"${args[1]}\\right)";return l}},function(q,h){h.factory=function(g,h,c,a){return a("multiplyScalar",{"number, number":function(a,d){return a*d},"Complex, Complex":function(a,d){return new g.Complex(a.re*d.re-a.im*d.im,a.re*d.im+a.im*d.re)},"BigNumber, BigNumber":function(a,d){return a.times(d)},"Fraction, Fraction":function(a,d){return a.mul(d)},"number, Unit":function(a,d){var c=
d.clone();c.value=null===c.value?c._normalize(a):c.value*a;return c},"Unit, number":function(a,d){var c=a.clone();c.value=null===c.value?c._normalize(d):c.value*d;return c},"Unit, Unit":function(a,d){return a.multiply(d)}})}},function(q,h,g){h.name="algorithm11";h.factory=function(h,c,a,b){var d=a(g(44)),e=h.SparseMatrix;return function(a,c,m,x){var g=a._values,n=a._index,h=a._ptr,v=a._size,l=a._datatype;if(!g)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u=
v[0],v=v[1],t;a=d;var r=0,p=m;"string"===typeof l&&(t=l,a=b.find(d,[t,t]),r=b.convert(0,t),c=b.convert(c,t),p=b.find(m,[t,t]));m=[];var l=[],q=[];t=new e({values:m,index:l,ptr:q,size:[u,v],datatype:t});for(u=0;u<v;u++){q[u]=l.length;for(var w=h[u+1],I=h[u];I<w;I++){var B=n[I],E=x?p(c,g[I]):p(g[I],c);a(E,r)||(l.push(B),m.push(E))}}q[v]=l.length;return t}}},function(q,h,g){var p=g(6).nearlyEqual;h.name="larger";h.factory=function(c,a,b,d){var e=b(g(39)),f=b(g(57)),k=b(g(58)),m=b(g(59)),x=b(g(46)),h=
b(g(47));c=g(41);var n=d("larger",{"boolean, boolean":function(a,b){return a>b},"number, number":function(b,d){return b>d&&!p(b,d,a.epsilon)},"BigNumber, BigNumber":function(a,b){return a.gt(b)},"Fraction, Fraction":function(a,b){return 1===a.compare(b)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(b,d){if(!b.equalBase(d))throw Error("Cannot compare units with different base");return b.value>d.value&&!p(b.value,d.value,
a.epsilon)},"string, string":function(a,b){return a>b},"Matrix, Matrix":function(a,b){var d;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":d=k(a,b,n);break;default:d=f(b,a,n,!0)}break;default:switch(b.storage()){case "sparse":d=f(a,b,n,!1);break;default:d=x(a,b,n)}}return d},"Array, Array":function(a,b){return n(e(a),e(b)).valueOf()},"Array, Matrix":function(a,b){return n(e(a),b)},"Matrix, Array":function(a,b){return n(a,e(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=
m(a,b,n,!1);break;default:d=h(a,b,n,!1)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=m(b,a,n,!0);break;default:d=h(b,a,n,!0)}return d},"Array, any":function(a,b){return h(e(a),b,n,!1).valueOf()},"any, Array":function(a,b){return h(e(b),a,n,!0).valueOf()}});n.toTex="\\left(${args[0]}"+c.operators.larger+"${args[1]}\\right)";return n}},function(q,h,g){var p=g(19);h.name="algorithm03";h.factory=function(c,a,b,d){var e=c.DenseMatrix;return function(a,b,c,x){var g=a._data,
n=a._size,h=a._datatype;a=b._values;var v=b._index,l=b._ptr,u=b._size,t=b._datatype;if(n.length!==u.length)throw new p(n.length,u.length);if(n[0]!==u[0]||n[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+n+") must match Matrix B ("+u+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");b=n[0];var n=n[1],r,u=0,y=c;"string"===typeof h&&h===t&&(r=h,u=d.convert(0,r),y=d.find(c,[r,r]));c=[];for(h=0;h<b;h++)c[h]=[];for(var h=[],t=[],q=0;q<n;q++){for(var w=
q+1,I=l[q+1],B=l[q];B<I;B++){var E=v[B];h[E]=x?y(a[B],g[E][q]):y(g[E][q],a[B]);t[E]=w}for(I=0;I<b;I++)c[I][q]=t[I]===w?h[I]:x?y(u,g[I][q]):y(g[I][q],u)}return new e({data:c,size:[b,n],datatype:r})}}},function(q,h,g){var p=g(19);h.name="algorithm07";h.factory=function(c,a,b,d){var e=c.DenseMatrix,f=function(a,b,d,c,e){var f=a._values,g=a._index,l=a._ptr;a=l[b];for(b=l[b+1];a<b;a++)l=g[a],d[l]=e,c[l]=f[a]};return function(a,b,c){var g=a._size,n=a._datatype,h=b._size,v=b._datatype;if(g.length!==h.length)throw new p(g.length,
h.length);if(g[0]!==h[0]||g[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+g+") must match Matrix B ("+h+")");var h=g[0],g=g[1],l,u=0,t=c;"string"===typeof n&&n===v&&(l=n,u=d.convert(0,l),t=d.find(c,[l,l]));n=[];for(c=0;c<h;c++)n[c]=[];var v=new e({data:n,size:[h,g],datatype:l}),r=[],q=[],z=[],w=[];for(l=0;l<g;l++){var I=l+1;f(a,l,z,r,I);f(b,l,w,q,I);for(c=0;c<h;c++)n[c][l]=t(z[c]===I?r[c]:u,w[c]===I?q[c]:u)}return v}}},function(q,h){h.name="algorithm12";h.factory=function(g,h,c,
a){var b=g.DenseMatrix;return function(d,c,f,k){var m=d._values,x=d._index,g=d._ptr,n=d._size,h=d._datatype;if(!m)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");d=n[0];var n=n[1],v,l=f;"string"===typeof h&&(v=h,c=a.convert(c,v),l=a.find(f,[v,v]));f=[];v=new b({data:f,size:[d,n],datatype:v});for(var h=[],u=[],t=0;t<n;t++){for(var r=t+1,p=g[t+1],q=g[t];q<p;q++){var w=x[q];h[w]=m[q];u[w]=r}for(p=0;p<d;p++)0===t&&(f[p]=[]),f[p][t]=u[p]===r?k?l(c,h[p]):l(h[p],c):k?l(c,
0):l(0,c)}return v}}},function(q,h,g){var p=g(6).nearlyEqual;h.name="smaller";h.factory=function(c,a,b,d){var e=b(g(39)),f=b(g(57)),k=b(g(58)),m=b(g(59)),x=b(g(46)),h=b(g(47));c=g(41);var n=d("smaller",{"boolean, boolean":function(a,b){return a<b},"number, number":function(b,d){return b<d&&!p(b,d,a.epsilon)},"BigNumber, BigNumber":function(a,b){return a.lt(b)},"Fraction, Fraction":function(a,b){return-1===a.compare(b)},"Complex, Complex":function(a,b){throw new TypeError("No ordering relation is defined for complex numbers");
},"Unit, Unit":function(b,d){if(!b.equalBase(d))throw Error("Cannot compare units with different base");return b.value<d.value&&!p(b.value,d.value,a.epsilon)},"string, string":function(a,b){return a<b},"Matrix, Matrix":function(a,b){var d;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":d=k(a,b,n);break;default:d=f(b,a,n,!0)}break;default:switch(b.storage()){case "sparse":d=f(a,b,n,!1);break;default:d=x(a,b,n)}}return d},"Array, Array":function(a,b){return n(e(a),e(b)).valueOf()},
"Array, Matrix":function(a,b){return n(e(a),b)},"Matrix, Array":function(a,b){return n(a,e(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=m(a,b,n,!1);break;default:d=h(a,b,n,!1)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=m(b,a,n,!0);break;default:d=h(b,a,n,!0)}return d},"Array, any":function(a,b){return h(e(a),b,n,!1).valueOf()},"any, Array":function(a,b){return h(e(b),a,n,!0).valueOf()}});n.toTex="\\left(${args[0]}"+c.operators.smaller+
"${args[1]}\\right)";return n}},function(q,h,g){var p=g(3).clone,c=g(16).format;h.name="trace";h.factory=function(a,b,d,e){var f=d(g(39)),k=d(g(38)),m=e("trace",{Array:function(a){return m(f(a))},Matrix:function(a){var b;switch(a.storage()){case "dense":a:{var d=a._size;b=a._data;switch(d.length){case 1:if(1==d[0]){b=p(b[0]);break a}throw new RangeError("Matrix must be square (size: "+c(d)+")");case 2:var e=d[0];if(e===d[1]){for(a=d=0;a<e;a++)d=k(d,b[a][a]);b=d;break a}throw new RangeError("Matrix must be square (size: "+
c(d)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+c(d)+")");}}break;case "sparse":b=a._values;var e=a._index,d=a._ptr,f=a._size;a=f[1];if(f[0]===a){f=0;if(0<b.length)for(var m=0;m<a;m++)for(var h=d[m+1],g=d[m];g<h;g++){var r=e[g];if(r===m){f=k(f,b[g]);break}if(r>m)break}b=f}else throw new RangeError("Matrix must be square (size: "+c(f)+")");}return b},any:p});m.toTex="\\mathrm{tr}\\left(${args[0]}\\right)";return m}},function(q,h,g){var p=g(3).clone,c=g(16).format;h.name=
"transpose";h.factory=function(a,b,d,e){b=g(41);var f=d(g(39)),k=a.DenseMatrix,m=a.SparseMatrix,h=e("transpose",{Array:function(a){return h(f(a)).valueOf()},Matrix:function(a){var b=a.size(),d;switch(b.length){case 1:d=a.clone();break;case 2:var e=b[0],f=b[1];if(0===f)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+c(b)+")");switch(a.storage()){case "dense":b=a._data;d=[];for(var h,g=0;g<f;g++){h=d[g]=[];for(var x=0;x<e;x++)h[x]=p(b[x][g])}d=new k({data:d,size:[f,e],datatype:a._datatype});
break;case "sparse":b=a._values;d=a._index;h=a._ptr;for(var g=b?[]:void 0,x=[],q=[],z=[],w=0;w<e;w++)z[w]=0;var I,w=0;for(I=d.length;w<I;w++)z[d[w]]++;for(I=w=0;I<e;I++)q.push(w),w+=z[I],z[I]=q[I];q.push(w);for(w=0;w<f;w++){I=h[w+1];for(var B=h[w];B<I;B++){var E=z[d[B]]++;x[E]=w;b&&(g[E]=p(b[B]))}}d=new m({values:g,index:x,ptr:q,size:[f,e],datatype:a._datatype})}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+c(this._size)+")");}return d},any:function(a){return p(a)}});
h.toTex="\\left(${args[0]}\\right)"+b.operators.transpose;return h}},function(q,h,g){var p=g(3).extend;h.name="divide";h.factory=function(c,a,b,d){var e=b(g(52)),f=b(g(53)),k=b(g(64)),m=b(g(39)),h=b(g(55)),A=b(g(47));c=d("divide",p({"Array | Matrix, Array | Matrix":function(a,b){return f(a,k(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=h(a,b,e,!1);break;case "dense":d=A(a,b,e,!1)}return d},"Array, any":function(a,b){return A(m(a),b,e,!1).valueOf()},"any, Array | Matrix":function(a,
b){return f(a,k(b))}},e.signatures));c.toTex="\\frac{${args[0]}}{${args[1]}}";return c}},function(q,h,g){var p=g(14);h.name="inv";h.factory=function(c,a,b,d){function e(a,b,d){var c,e;if(1==b){b=a[0][0];if(0==b)throw Error("Cannot calculate inverse, determinant is zero");return[[k(1,b)]]}if(2==b){b=n(a);if(0==b)throw Error("Cannot calculate inverse, determinant is zero");return[[k(a[1][1],b),k(A(a[0][1]),b)],[k(A(a[1][0]),b),k(a[0][0],b)]]}var f=a.concat();for(a=0;a<b;a++)f[a]=f[a].concat();for(var g=
s(b).valueOf(),p=0;p<d;p++){for(a=p;a<b&&0==f[a][p];)a++;if(a==b||0==f[a][p])throw Error("Cannot calculate inverse, determinant is zero");a!=p&&(c=f[p],f[p]=f[a],f[a]=c,c=g[p],g[p]=g[a],g[a]=c);var q=f[p],B=g[p];for(a=0;a<b;a++){var E=f[a],K=g[a];if(a!=p){if(0!=E[p]){e=k(A(E[p]),q[p]);for(c=p;c<d;c++)E[c]=m(E[c],h(e,q[c]));for(c=0;c<d;c++)K[c]=m(K[c],h(e,B[c]))}}else{e=q[p];for(c=p;c<d;c++)E[c]=k(E[c],e);for(c=0;c<d;c++)K[c]=k(K[c],e)}}}return g}var f=b(g(39)),k=b(g(52)),m=b(g(40)),h=b(g(53)),A=b(g(65)),
n=b(g(66)),s=b(g(50));c=d("inv",{"Array | Matrix":function(a){var b=!0===a.isMatrix?a.size():p.array.size(a);switch(b.length){case 1:if(1==b[0])return!0===a.isMatrix?f([k(1,a.valueOf()[0])]):[k(1,a[0])];throw new RangeError("Matrix must be square (size: "+p.string.format(b)+")");case 2:var d=b[0],c=b[1];if(d==c)return!0===a.isMatrix?f(e(a.valueOf(),d,c),a.storage()):e(a,d,c);throw new RangeError("Matrix must be square (size: "+p.string.format(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+
p.string.format(b)+")");}},any:function(a){return k(1,a)}});c.toTex="\\left(${args[0]}\\right)^{-1}";return c}},function(q,h,g){var p=g(25);h.name="unaryMinus";h.factory=function(c,a,b,d){a=g(41);var e=d("unaryMinus",{number:function(a){return-a},Complex:function(a){return new c.Complex(-a.re,-a.im)},BigNumber:function(a){return a.neg()},Fraction:function(a){return a.neg()},Unit:function(a){var b=a.clone();b.value=-a.value;return b},"Array | Matrix":function(a){return p(a,e,!0)}});e.toTex=a.operators.unaryMinus+
"\\left(${args[0]}\\right)";return e}},function(q,h,g){q=g(14);var p=q.object,c=q.string;h.name="det";h.factory=function(a,b,d,e){var f=d(g(39)),k=d(g(38)),m=d(g(67)),h=d(g(53)),A=d(g(65));a=e("det",{any:function(a){return p.clone(a)},"Array | Matrix":function(a){var b;a&&!0===a.isMatrix?b=a.size():Array.isArray(a)?(a=f(a),b=a.size()):b=[];switch(b.length){case 0:return p.clone(a);case 1:if(1==b[0])return p.clone(a.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+c.format(b)+")");
case 2:var d=b[0];if(d==b[1]){a=a.clone().valueOf();if(1==d)d=p.clone(a[0][0]);else if(2==d)d=m(h(a[0][0],a[1][1]),h(a[1][0],a[0][1]));else{var e=a;for(b=0;b<d-1;b++){for(var g=void 0,t=void 0,r=Array(e.length),q=0,g=1;g<e.length;g++)q=k(q,e[g][g]);for(g=0;g<e.length;g++){r[g]=Array(e.length);r[g][g]=A(q);for(t=0;t<g;t++)r[g][t]=0;for(t=g+1;t<e.length;t++)r[g][t]=e[g][t];g+1<e.length&&(q=m(q,e[g+1][g+1]))}e=h(r,a)}d=0==d%2?A(e[0][0]):e[0][0]}return d}throw new RangeError("Matrix must be square (size: "+
c.format(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+c.format(b)+")");}}});a.toTex="\\det\\left(${args[0]}\\right)";return a}},function(q,h,g){var p=g(19);h.name="subtract";h.factory=function(c,a,b,d){a=g(41);var e=b(g(39)),f=b(g(40)),k=b(g(65)),m=b(g(42)),h=b(g(57)),A=b(g(68)),n=b(g(45)),s=b(g(46)),v=b(g(47)),l=d("subtract",{"number, number":function(a,b){return a-b},"Complex, Complex":function(a,b){return new c.Complex(a.re-b.re,a.im-b.im)},"BigNumber, BigNumber":function(a,
b){return a.minus(b)},"Fraction, Fraction":function(a,b){return a.sub(b)},"Unit, Unit":function(a,b){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");if(null==b.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(b))throw Error("Units do not match");var d=a.clone();d.value-=b.value;d.fixPrefix=!1;return d},"Matrix, Matrix":function(a,b){var d=a.size(),c=b.size();if(d.length!==c.length)throw new p(d.length,c.length);switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":d=
A(a,b,l);break;default:d=h(b,a,l,!0)}break;default:switch(b.storage()){case "sparse":d=m(a,b,l,!1);break;default:d=s(a,b,l)}}return d},"Array, Array":function(a,b){return l(e(a),e(b)).valueOf()},"Array, Matrix":function(a,b){return l(e(a),b)},"Matrix, Array":function(a,b){return l(a,e(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=n(a,k(b),f);break;default:d=v(a,b,l)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=n(b,a,l,!0);break;default:d=
v(b,a,l,!0)}return d},"Array, any":function(a,b){return v(e(a),b,l,!1).valueOf()},"any, Array":function(a,b){return v(e(b),a,l,!0).valueOf()}});l.toTex="\\left(${args[0]}"+a.operators.subtract+"${args[1]}\\right)";return l}},function(q,h,g){var p=g(19);h.name="algorithm05";h.factory=function(c,a,b,d){var e=b(g(44)),f=c.SparseMatrix;return function(a,b,c){var g=a._values,h=a._index,s=a._ptr,v=a._size,l=a._datatype;a=b._values;var q=b._index,t=b._ptr,r=b._size,y=b._datatype;if(v.length!==r.length)throw new p(v.length,
r.length);if(v[0]!==r[0]||v[1]!==r[1])throw new RangeError("Dimension mismatch. Matrix A ("+v+") must match Matrix B ("+r+")");var z=v[0],v=v[1],w;b=e;var r=0,I=c;"string"===typeof l&&l===y&&(w=l,b=d.find(e,[w,w]),r=d.convert(0,w),I=d.find(c,[w,w]));c=g&&a?[]:void 0;l=[];y=[];w=new f({values:c,index:l,ptr:y,size:[z,v],datatype:w});var z=c?[]:void 0,B=c?[]:void 0,E=[],K=[],H,F,D,V;for(F=0;F<v;F++){y[F]=l.length;var L=F+1;D=s[F];for(V=s[F+1];D<V;D++)H=h[D],l.push(H),E[H]=L,z&&(z[H]=g[D]);D=t[F];for(V=
t[F+1];D<V;D++)H=q[D],E[H]!==L&&l.push(H),K[H]=L,B&&(B[H]=a[D]);if(c)for(D=y[F];D<l.length;){H=l[D];V=E[H];var P=K[H];if(V===L||P===L)H=I(V===L?z[H]:r,P===L?B[H]:r),b(H,r)?l.splice(D,1):(c.push(H),D++)}}y[v]=l.length;return w}}},function(q,h,g){var p=g(15).size;h.name="cross";h.factory=function(c,a,b,d){function e(a,b){var d=p(a),c=p(b);if(1!=d.length||1!=c.length||3!=d[0]||3!=c[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+d.join(", ")+"], B = ["+c.join(", ")+"])");return[k(m(a[1],
b[2]),m(a[2],b[1])),k(m(a[2],b[0]),m(a[0],b[2])),k(m(a[0],b[1]),m(a[1],b[0]))]}var f=b(g(39)),k=b(g(67)),m=b(g(53));c=d("cross",{"Matrix, Matrix":function(a,b){return f(e(a.toArray(),b.toArray()))},"Matrix, Array":function(a,b){return f(e(a.toArray(),b))},"Array, Matrix":function(a,b){return f(e(a,b.toArray()))},"Array, Array":e});c.toTex="\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)";return c}},function(q,h,g){var p=g(15).size;h.name="dot";h.factory=function(c,a,b,d){function e(a,b){var d=
p(a),c=p(b),e=d[0];if(1!==d.length||1!==c.length)throw new RangeError("Vector expected");if(d[0]!=c[0])throw new RangeError("Vectors must have equal length ("+d[0]+" != "+c[0]+")");if(0==e)throw new RangeError("Cannot calculate the dot product of empty vectors");for(c=d=0;c<e;c++)d=f(d,k(a[c],b[c]));return d}var f=b(g(38)),k=b(g(53));c=d("dot",{"Matrix, Matrix":function(a,b){return e(a.toArray(),b.toArray())},"Matrix, Array":function(a,b){return e(a.toArray(),b)},"Array, Matrix":function(a,b){return e(a,
b.toArray())},"Array, Array":e});c.toTex="\\left(${args[0]}\\cdot${args[1]}\\right)";return c}}])})},function(O,Q,R){var q,h,g;(function(p){function c(a){return"[object Function]"===V.call(a)}function a(a){return"[object Array]"===V.call(a)}function b(a,b){if(a){var d;for(d=0;d<a.length&&(!a[d]||!b(a[d],d,a));d+=1);}}function d(a,b){if(a){var d;for(d=a.length-1;-1<d&&(!a[d]||!b(a[d],d,a));d-=1);}}function e(a,b){return L.call(a,b)}function f(a,b){return e(a,b)&&a[b]}function k(a,b){for(var d in a)if(e(a,
d)&&b(a[d],d))break}function m(b,d,f,g){d&&k(d,function(d,k){if(f||!e(b,k))!g||"object"!==typeof d||!d||a(d)||c(d)||d instanceof RegExp?b[k]=d:(b[k]||(b[k]={}),m(b[k],d,f,g))});return b}function x(a,b){return function(){return b.apply(a,arguments)}}function A(a){throw a;}function n(a){if(!a)return a;var d=p;b(a.split("."),function(a){d=d[a]});return d}function s(a,b,d,c){b=Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);b.requireType=a;b.requireModules=c;d&&(b.originalError=d);return b}function v(g){function h(a,
b,d){var c,e,k,m,g,l,x,n;b=b&&b.split("/");var A=W.map,r=A&&A["*"];if(a){a=a.split("/");e=a.length-1;W.nodeIdCompat&&F.test(a[e])&&(a[e]=a[e].replace(F,""));"."===a[0].charAt(0)&&b&&(e=b.slice(0,b.length-1),a=e.concat(a));e=a;for(k=0;k<e.length;k++)(m=e[k],"."===m)?(e.splice(k,1),k-=1):".."===m&&0!==k&&(1!==k||".."!==e[2])&&".."!==e[k-1]&&0<k&&(e.splice(k-1,2),k-=2);a=a.join("/")}if(d&&A&&(b||r)){e=a.split("/");k=e.length;a:for(;0<k;k-=1){g=e.slice(0,k).join("/");if(b)for(m=b.length;0<m;m-=1)if(d=
f(A,b.slice(0,m).join("/")))if(d=f(d,g)){c=d;l=k;break a}!x&&r&&f(r,g)&&(x=f(r,g),n=k)}!c&&x&&(c=x,l=n);c&&(e.splice(0,l,c),a=e.join("/"))}return(c=f(W.pkgs,a))?c:a}function r(a){P&&b(document.getElementsByTagName("script"),function(b){if(b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===S.contextName)return b.parentNode.removeChild(b),!0})}function t(b){var d=f(W.paths,b);if(d&&a(d)&&1<d.length)return d.shift(),S.require.undef(b),S.makeRequire(null,{skipMap:!0})([b]),
!0}function q(a){var b,d=a?a.indexOf("!"):-1;-1<d&&(b=a.substring(0,d),a=a.substring(d+1,a.length));return[b,a]}function v(a,b,d,c){var e,k,m=null,g=b?b.name:null,l=a,x=!0,n="";a||(x=!1,a="_@r"+(oa+=1));a=q(a);m=a[0];a=a[1];m&&(m=h(m,g,c),k=f(aa,m));a&&(m?n=k&&k.normalize?k.normalize(a,function(a){return h(a,g,c)}):-1===a.indexOf("!")?h(a,g,c):a:(n=h(a,g,c),a=q(n),m=a[0],n=a[1],d=!0,e=S.nameToUrl(n)));d=!m||k||d?"":"_unnormalized"+(Ba+=1);return{prefix:m,name:n,parentMap:b,unnormalized:!!d,url:e,
originalName:l,isDefine:x,id:(m?m+"!"+n:n)+d}}function u(a){var b=a.id,d=f(Y,b);d||(d=Y[b]=new S.Module(a));return d}function y(a,b,d){var c=a.id,k=f(Y,c);if(!e(aa,c)||k&&!k.defineEmitComplete)if(k=u(a),k.error&&"error"===b)d(k.error);else k.on(b,d);else"defined"===b&&d(aa[c])}function U(a,d){var c=a.requireModules,e=!1;if(d)d(a);else if(b(c,function(b){if(b=f(Y,b))b.error=a,b.events.error&&(e=!0,b.emit("error",a))}),!e)l.onError(a)}function z(){X.length&&(b(X,function(a){var b=a[0];"string"===typeof b&&
(S.defQueueMap[b]=!0);da.push(a)}),X=[])}function B(a){delete Y[a];delete Q[a]}function K(a,d,c){var e=a.map.id;a.error?a.emit("error",a.error):(d[e]=!0,b(a.depMaps,function(b,e){var k=b.id,m=f(Y,k);m&&!a.depMatched[e]&&!c[k]&&(f(d,k)?(a.defineDep(e,aa[k]),a.check()):K(m,d,c))}),c[e]=!0)}function E(){var a,d,c=(a=1E3*W.waitSeconds)&&S.startTime+a<(new Date).getTime(),e=[],f=[],m=!1,g=!0;if(!L){L=!0;k(Q,function(a){var b=a.map,k=b.id;if(a.enabled&&(b.isDefine||f.push(a),!a.error))if(!a.inited&&c)t(k)?
m=d=!0:(e.push(k),r(k));else if(!a.inited&&a.fetched&&b.isDefine&&(m=!0,!b.prefix))return g=!1});if(c&&e.length)return a=s("timeout","Load timeout for modules: "+e,null,e),a.contextName=S.contextName,U(a);g&&b(f,function(a){K(a,{},{})});c&&!d||!m||!P&&!G||O||(O=setTimeout(function(){O=0;E()},50));L=!1}}function N(a){e(aa,a[0])||u(v(a[0],null,!0)).init(a[1],a[2])}function I(a){a=a.currentTarget||a.srcElement;var b=S.onScriptLoad;a.detachEvent&&!J?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",
b,!1);b=S.onScriptError;a.detachEvent&&!J||a.removeEventListener("error",b,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}function H(){var a;for(z();da.length;){a=da.shift();if(null===a[0])return U(s("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));N(a)}S.defQueueMap={}}var L,V,S,M,O,W={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},Y={},Q={},R={},da=[],aa={},pa={},$={},oa=1,Ba=1;M={require:function(a){return a.require?a.require:a.require=
S.makeRequire(a.map)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports?aa[a.map.id]=a.exports:a.exports=aa[a.map.id]={}},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return f(W.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}};V=function(a){this.events=f(R,a.id)||{};this.map=a;this.shim=f(W.shim,a.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};V.prototype={init:function(a,
b,d,c){c=c||{};if(!this.inited){this.factory=b;if(d)this.on("error",d);else this.events.error&&(d=x(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.errback=d;this.inited=!0;this.ignore=c.ignore;c.enabled||this.enabled?this.enable():this.check()}},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0;S.startTime=(new Date).getTime();var a=this.map;if(this.shim)S.makeRequire(this.map,
{enableBuildCallback:!0})(this.shim.deps||[],x(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;pa[a]||(pa[a]=!0,S.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,d=this.map.id;b=this.depExports;var f=this.exports,k=this.factory;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(c(k)){if(this.events.error&&
this.map.isDefine||l.onError!==A)try{f=S.execCb(d,k,b,f)}catch(m){a=m}else f=S.execCb(d,k,b,f);this.map.isDefine&&void 0===f&&((b=this.module)?f=b.exports:this.usingExports&&(f=this.exports));if(a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",U(this.error=a)}else f=k;this.exports=f;if(this.map.isDefine&&!this.ignore&&(aa[d]=f,l.onResourceLoad))l.onResourceLoad(S,this.map,this.depMaps);B(d);this.defined=!0}this.defining=
!1;this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else e(S.defQueueMap,d)||this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=v(a.prefix);this.depMaps.push(d);y(d,"defined",x(this,function(d){var c,m;m=f($,this.map.id);var g=this.map.name,n=this.map.parentMap?this.map.parentMap.name:null,A=S.makeRequire(a.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(d.normalize&&(g=d.normalize(g,function(a){return h(a,
n,!0)})||""),d=v(a.prefix+"!"+g,this.map.parentMap),y(d,"defined",x(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),m=f(Y,d.id)){this.depMaps.push(d);if(this.events.error)m.on("error",x(this,function(a){this.emit("error",a)}));m.enable()}}else m?(this.map.url=S.nameToUrl(m),this.load()):(c=x(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),c.error=x(this,function(a){this.inited=!0;this.error=a;a.requireModules=[b];k(Y,function(a){0===a.map.id.indexOf(b+
"_unnormalized")&&B(a.map.id)});U(a)}),c.fromText=x(this,function(d,f){var k=a.name,m=v(k),g=Z;f&&(d=f);g&&(Z=!1);u(m);e(W.config,b)&&(W.config[k]=W.config[b]);try{l.exec(d)}catch(h){return U(s("fromtexteval","fromText eval for "+b+" failed: "+h,h,[b]))}g&&(Z=!0);this.depMaps.push(m);S.completeLoad(k);A([k],c)}),d.load(a.name,A,c,W))}));S.enable(d,this);this.pluginMaps[d.id]=d},enable:function(){Q[this.map.id]=this;this.enabling=this.enabled=!0;b(this.depMaps,x(this,function(a,b){var d,c;if("string"===
typeof a){a=v(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap);this.depMaps[b]=a;if(d=f(M,a.id)){this.depExports[b]=d(this);return}this.depCount+=1;y(a,"defined",x(this,function(a){this.undefed||(this.defineDep(b,a),this.check())}));this.errback?y(a,"error",x(this,this.errback)):this.events.error&&y(a,"error",x(this,function(a){this.emit("error",a)}))}d=a.id;c=Y[d];!e(M,d)&&c&&!c.enabled&&S.enable(a,this)}));k(this.pluginMaps,x(this,function(a){var b=f(Y,a.id);b&&!b.enabled&&S.enable(a,
this)}));this.enabling=!1;this.check()},on:function(a,b){var d=this.events[a];d||(d=this.events[a]=[]);d.push(b)},emit:function(a,d){b(this.events[a],function(a){a(d)});"error"===a&&delete this.events[a]}};S={config:W,contextName:g,registry:Y,defined:aa,urlFetched:pa,defQueue:da,defQueueMap:{},Module:V,makeModuleMap:v,nextTick:l.nextTick,onError:U,configure:function(d){d.baseUrl&&"/"!==d.baseUrl.charAt(d.baseUrl.length-1)&&(d.baseUrl+="/");var c=W.shim,e={paths:!0,bundles:!0,config:!0,map:!0};k(d,
function(a,b){e[b]?(W[b]||(W[b]={}),m(W[b],a,!0,!0)):W[b]=a});d.bundles&&k(d.bundles,function(a,d){b(a,function(a){a!==d&&($[a]=d)})});d.shim&&(k(d.shim,function(b,d){a(b)&&(b={deps:b});!b.exports&&!b.init||b.exportsFn||(b.exportsFn=S.makeShimExports(b));c[d]=b}),W.shim=c);d.packages&&b(d.packages,function(a){var b;a="string"===typeof a?{name:a}:a;b=a.name;a.location&&(W.paths[b]=a.location);W.pkgs[b]=a.name+"/"+(a.main||"main").replace(D,"").replace(F,"")});k(Y,function(a,b){a.inited||a.map.unnormalized||
(a.map=v(b,null,!0))});(d.deps||d.callback)&&S.require(d.deps||[],d.callback)},makeShimExports:function(a){return function(){var b;a.init&&(b=a.init.apply(p,arguments));return b||a.exports&&n(a.exports)}},makeRequire:function(a,b){function k(d,f,m){var h,x;b.enableBuildCallback&&f&&c(f)&&(f.__requireJsBuild=!0);if("string"===typeof d){if(c(f))return U(s("requireargs","Invalid require call"),m);if(a&&e(M,d))return M[d](Y[a.id]);if(l.get)return l.get(S,d,a,k);h=v(d,a,!1,!0);h=h.id;return e(aa,h)?aa[h]:
U(s("notloaded",'Module name "'+h+'" has not been loaded yet for context: '+g+(a?"":". Use require([])")))}H();S.nextTick(function(){H();x=u(v(null,a));x.skipMap=b.skipMap;x.init(d,f,m,{enabled:!0});E()});return k}b=b||{};m(k,{isBrowser:P,toUrl:function(b){var d,c=b.lastIndexOf("."),e=b.split("/")[0];-1!==c&&("."!==e&&".."!==e||1<c)&&(d=b.substring(c,b.length),b=b.substring(0,c));return S.nameToUrl(h(b,a&&a.id,!0),d,!0)},defined:function(b){return e(aa,v(b,a,!1,!0).id)},specified:function(b){b=v(b,
a,!1,!0).id;return e(aa,b)||e(Y,b)}});a||(k.undef=function(b){z();var c=v(b,a,!0),e=f(Y,b);e.undefed=!0;r(b);delete aa[b];delete pa[c.url];delete R[b];d(da,function(a,d){a[0]===b&&da.splice(d,1)});delete S.defQueueMap[b];e&&(e.events.defined&&(R[b]=e.events),B(b))});return k},enable:function(a){f(Y,a.id)&&u(a).enable()},completeLoad:function(a){var b,d,c=f(W.shim,a)||{},k=c.exports;for(z();da.length;){d=da.shift();if(null===d[0]){d[0]=a;if(b)break;b=!0}else d[0]===a&&(b=!0);N(d)}S.defQueueMap={};
d=f(Y,a);if(!b&&!e(aa,a)&&d&&!d.inited){if(W.enforceDefine&&(!k||!n(k)))return t(a)?void 0:U(s("nodefine","No define call for "+a,null,[a]));N([a,c.deps||[],c.exportsFn])}E()},nameToUrl:function(b,d,c){var e,k,m;(e=f(W.pkgs,b))&&(b=e);if(e=f($,b))return S.nameToUrl(e,d,c);if(l.jsExtRegExp.test(b))e=b+(d||"");else{e=W.paths;b=b.split("/");for(k=b.length;0<k;k-=1)if(m=b.slice(0,k).join("/"),m=f(e,m)){a(m)&&(m=m[0]);b.splice(0,k,m);break}e=b.join("/");e+=d||(/^data\:|\?/.test(e)||c?"":".js");e=("/"===
e.charAt(0)||e.match(/^[\w\+\.\-]+:/)?"":W.baseUrl)+e}return W.urlArgs?e+((-1===e.indexOf("?")?"?":"&")+W.urlArgs):e},load:function(a,b){l.load(S,a,b)},execCb:function(a,b,d,c){return b.apply(c,d)},onScriptLoad:function(a){if("load"===a.type||C.test((a.currentTarget||a.srcElement).readyState))w=null,a=I(a),S.completeLoad(a.id)},onScriptError:function(a){var b=I(a);if(!t(b.id))return U(s("scripterror","Script error for: "+b.id,a,[b.id]))}};S.require=S.makeRequire();return S}var l,u,t,r,y,z,w,I,B,E,
K=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,H=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,F=/\.js$/,D=/^\.\//;u=Object.prototype;var V=u.toString,L=u.hasOwnProperty,P=!("undefined"===typeof window||"undefined"===typeof navigator||!window.document),G=!P&&"undefined"!==typeof importScripts,C=P&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,J="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),M={},U={},X=[],Z=!1;if("undefined"===typeof g){if("undefined"!==
typeof h){if(c(h))return;U=h;h=void 0}"undefined"!==typeof q&&!c(q)&&(U=q,q=void 0);l=h=function(b,d,c,e){var k,m="_";!a(b)&&"string"!==typeof b&&(k=b,a(d)?(b=d,d=c,c=e):b=[]);k&&k.context&&(m=k.context);(e=f(M,m))||(e=M[m]=l.s.newContext(m));k&&e.configure(k);return e.require(b,d,c)};l.config=function(a){return l(a)};l.nextTick="undefined"!==typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()};q||(q=l);l.version="2.1.20";l.jsExtRegExp=/^\/|:|\?|\.js$/;l.isBrowser=P;u=l.s={contexts:M,newContext:v};
l({});b(["toUrl","undef","defined","specified"],function(a){l[a]=function(){var b=M._;return b.require[a].apply(b,arguments)}});P&&(t=u.head=document.getElementsByTagName("head")[0],r=document.getElementsByTagName("base")[0])&&(t=u.head=r.parentNode);l.onError=A;l.createNode=function(a){var b=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");b.type=a.scriptType||"text/javascript";b.charset="utf-8";b.async=!0;return b};l.load=function(a,
b,d){var c=a&&a.config||{},e;if(P){e=l.createNode(c,b,d);if(c.onNodeCreated)c.onNodeCreated(e,c,b,d);e.setAttribute("data-requirecontext",a.contextName);e.setAttribute("data-requiremodule",b);!e.attachEvent||e.attachEvent.toString&&0>e.attachEvent.toString().indexOf("[native code")||J?(e.addEventListener("load",a.onScriptLoad,!1),e.addEventListener("error",a.onScriptError,!1)):(Z=!0,e.attachEvent("onreadystatechange",a.onScriptLoad));e.src=d;I=e;r?t.insertBefore(e,r):t.appendChild(e);I=null;return e}if(G)try{importScripts(d),
a.completeLoad(b)}catch(f){a.onError(s("importscripts","importScripts failed for "+b+" at "+d,f,[b]))}};P&&!U.skipDataMain&&d(document.getElementsByTagName("script"),function(a){t||(t=a.parentNode);if(y=a.getAttribute("data-main"))return B=y,U.baseUrl||(z=B.split("/"),B=z.pop(),E=z.length?z.join("/")+"/":"./",U.baseUrl=E),B=B.replace(F,""),l.jsExtRegExp.test(B)&&(B=y),U.deps=U.deps?U.deps.concat(B):[B],!0});g=function(b,e,f){var k,m;"string"!==typeof b&&(f=e,e=b,b=null);a(e)||(f=e,e=null);!e&&c(f)&&
(e=[],f.length&&(f.toString().replace(K,"").replace(H,function(a,b){e.push(b)}),e=(1===f.length?["require"]:["require","exports","module"]).concat(e)));Z&&((k=I)||(w&&"interactive"===w.readyState||d(document.getElementsByTagName("script"),function(a){if("interactive"===a.readyState)return w=a}),k=w),k&&(b||(b=k.getAttribute("data-requiremodule")),m=M[k.getAttribute("data-requirecontext")]));m?(m.defQueue.push([b,e,f]),m.defQueueMap[b]=!0):X.push([b,e,f])};g.amd={jQuery:!0};l.exec=function(a){return eval(a)};
l(U)}})(this)},function(O,Q,R){var q,h,g;(function(p,c){!(h=[Q],q=c,g="function"===typeof q?q.apply(Q,h):q,void 0!==g&&(O.exports=g))})(this,function(h){var c={REVISION:"72"};!(q=c,g="function"===typeof q?q.call(h,R,h,O):q,void 0!==g&&(O.exports=g));void 0!==self.requestAnimationFrame&&void 0!==self.cancelAnimationFrame||function(){for(var a=0,b=["ms","moz","webkit","o"],d=0;d<b.length&&!self.requestAnimationFrame;++d)self.requestAnimationFrame=self[b[d]+"RequestAnimationFrame"],self.cancelAnimationFrame=
self[b[d]+"CancelAnimationFrame"]||self[b[d]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(b){var d=Date.now(),c=Math.max(0,16-(d-a)),m=self.setTimeout(function(){b(d+c)},c);a=d+c;return m});void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(a){self.clearTimeout(a)})}();void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});void 0===Function.prototype.name&&
void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}});c.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};c.CullFaceNone=0;c.CullFaceBack=1;c.CullFaceFront=2;c.CullFaceFrontBack=3;c.FrontFaceDirectionCW=0;c.FrontFaceDirectionCCW=1;c.BasicShadowMap=0;c.PCFShadowMap=1;c.PCFSoftShadowMap=2;c.FrontSide=0;c.BackSide=1;c.DoubleSide=2;c.FlatShading=1;c.SmoothShading=2;c.NoColors=0;c.FaceColors=1;c.VertexColors=2;c.NoBlending=
0;c.NormalBlending=1;c.AdditiveBlending=2;c.SubtractiveBlending=3;c.MultiplyBlending=4;c.CustomBlending=5;c.AddEquation=100;c.SubtractEquation=101;c.ReverseSubtractEquation=102;c.MinEquation=103;c.MaxEquation=104;c.ZeroFactor=200;c.OneFactor=201;c.SrcColorFactor=202;c.OneMinusSrcColorFactor=203;c.SrcAlphaFactor=204;c.OneMinusSrcAlphaFactor=205;c.DstAlphaFactor=206;c.OneMinusDstAlphaFactor=207;c.DstColorFactor=208;c.OneMinusDstColorFactor=209;c.SrcAlphaSaturateFactor=210;c.NeverDepth=0;c.AlwaysDepth=
1;c.LessDepth=2;c.LessEqualDepth=3;c.EqualDepth=4;c.GreaterEqualDepth=5;c.GreaterDepth=6;c.NotEqualDepth=7;c.MultiplyOperation=0;c.MixOperation=1;c.AddOperation=2;c.UVMapping=300;c.CubeReflectionMapping=301;c.CubeRefractionMapping=302;c.EquirectangularReflectionMapping=303;c.EquirectangularRefractionMapping=304;c.SphericalReflectionMapping=305;c.RepeatWrapping=1E3;c.ClampToEdgeWrapping=1001;c.MirroredRepeatWrapping=1002;c.NearestFilter=1003;c.NearestMipMapNearestFilter=1004;c.NearestMipMapLinearFilter=
1005;c.LinearFilter=1006;c.LinearMipMapNearestFilter=1007;c.LinearMipMapLinearFilter=1008;c.UnsignedByteType=1009;c.ByteType=1010;c.ShortType=1011;c.UnsignedShortType=1012;c.IntType=1013;c.UnsignedIntType=1014;c.FloatType=1015;c.HalfFloatType=1025;c.UnsignedShort4444Type=1016;c.UnsignedShort5551Type=1017;c.UnsignedShort565Type=1018;c.AlphaFormat=1019;c.RGBFormat=1020;c.RGBAFormat=1021;c.LuminanceFormat=1022;c.LuminanceAlphaFormat=1023;c.RGBEFormat=c.RGBAFormat;c.RGB_S3TC_DXT1_Format=2001;c.RGBA_S3TC_DXT1_Format=
2002;c.RGBA_S3TC_DXT3_Format=2003;c.RGBA_S3TC_DXT5_Format=2004;c.RGB_PVRTC_4BPPV1_Format=2100;c.RGB_PVRTC_2BPPV1_Format=2101;c.RGBA_PVRTC_4BPPV1_Format=2102;c.RGBA_PVRTC_2BPPV1_Format=2103;c.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");
a.unproject(b)};this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};c.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElement("canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};c.Color=function(a){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):
this.set(a)};c.Color.prototype={constructor:c.Color,r:1,g:1,b:1,set:function(a){a instanceof c.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,d){this.r=a;this.g=b;this.b=d;return this},setHSL:function(){function a(a,d,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(d-a)*c:.5>c?d:c<2/3?a+6*(d-a)*(2/3-c):a}return function(b,
d,e){b=c.Math.euclideanModulo(b,1);d=c.Math.clamp(d,0,1);e=c.Math.clamp(e,0,1);0===d?this.r=this.g=this.b=e:(d=.5>=e?e*(1+d):e+d-e*d,e=2*e-d,this.r=a(e,d,b+1/3),this.g=a(e,d,b),this.b=a(e,d,b-1/3));return this}}(),setStyle:function(a){var b=function(b){b=parseFloat(b);1>b&&console.warn("THREE.Color: Alpha component of color "+a+" will be ignored.");return b},d;if(d=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var e=d[2];switch(d[1]){case "rgb":if(d=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*$/.exec(e))return this.r=
Math.min(255,parseInt(d[1],10))/255,this.g=Math.min(255,parseInt(d[2],10))/255,this.b=Math.min(255,parseInt(d[3],10))/255,this;if(d=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*$/.exec(e))return this.r=Math.min(100,parseInt(d[1],10))/100,this.g=Math.min(100,parseInt(d[2],10))/100,this.b=Math.min(100,parseInt(d[3],10))/100,this;break;case "rgba":if(d=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(e))return this.r=Math.min(255,parseInt(d[1],10))/255,this.g=Math.min(255,parseInt(d[2],10))/
255,this.b=Math.min(255,parseInt(d[3],10))/255,b(d[4]),this;if(d=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(e))return this.r=Math.min(100,parseInt(d[1],10))/100,this.g=Math.min(100,parseInt(d[2],10))/100,this.b=Math.min(100,parseInt(d[3],10))/100,b(d[4]),this;break;case "hsl":if(d=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*$/.exec(e)){var e=parseFloat(d[1]),f=parseInt(d[2],10)/100,k=parseInt(d[3],10)/100;return this.setHSL(e,f,k)}break;case "hsla":if(d=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(e))return e=
parseFloat(d[1]),f=parseInt(d[2],10)/100,k=parseInt(d[3],10)/100,b(d[4]),this.setHSL(e,f,k)}}else if(d=/^\#([A-Fa-f0-9]+)$/.exec(a)){b=d[1];d=b.length;if(3===d)return this.r=parseInt(b.charAt(0)+b.charAt(0),16)/255,this.g=parseInt(b.charAt(1)+b.charAt(1),16)/255,this.b=parseInt(b.charAt(2)+b.charAt(2),16)/255,this;if(6===d)return this.r=parseInt(b.charAt(0)+b.charAt(1),16)/255,this.g=parseInt(b.charAt(2)+b.charAt(3),16)/255,this.b=parseInt(b.charAt(4)+b.charAt(5),16)/255,this}a&&0<a.length&&(b=c.ColorKeywords[a],
void 0!==b?this.setHex(b):console.warn("THREE.Color: Unknown color "+a));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);var d=0<b?1/b:1;this.r=Math.pow(a.r,d);this.g=Math.pow(a.g,d);this.b=Math.pow(a.b,d);return this},convertGammaToLinear:function(){var a=
this.r,b=this.g,d=this.b;this.r=a*a;this.g=b*b;this.b=d*d;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,d=this.g,c=this.b,f=Math.max(b,d,c),k=Math.min(b,d,c),m,g=(k+f)/2;if(k===f)k=m=0;else{var h=f-k,k=.5>=g?h/(f+k):
h/(2-f-k);switch(f){case b:m=(d-c)/h+(d<c?6:0);break;case d:m=(c-b)/h+2;break;case c:m=(b-d)/h+4}m/=6}a.h=m;a.s=k;a.l=g;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,b,d){var c=this.getHSL();c.h+=a;c.s+=b;c.l+=d;this.setHSL(c.h,c.s,c.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=
a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a){this.r=a[0];this.g=a[1];this.b=a[2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.r;a[b+1]=this.g;a[b+
2]=this.b;return a}};c.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,
darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,
greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,
lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,
palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,
teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};c.Quaternion=function(a,b,d,c){this._x=a||0;this._y=b||0;this._z=d||0;this._w=void 0!==c?c:1};c.Quaternion.prototype={constructor:c.Quaternion,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},
get w(){return this._w},set w(a){this._w=a;this.onChangeCallback()},set:function(a,b,d,c){this._x=a;this._y=b;this._z=d;this._w=c;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!1===a instanceof c.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
var d=Math.cos(a._x/2),e=Math.cos(a._y/2),f=Math.cos(a._z/2),k=Math.sin(a._x/2),m=Math.sin(a._y/2),g=Math.sin(a._z/2),h=a.order;"XYZ"===h?(this._x=k*e*f+d*m*g,this._y=d*m*f-k*e*g,this._z=d*e*g+k*m*f,this._w=d*e*f-k*m*g):"YXZ"===h?(this._x=k*e*f+d*m*g,this._y=d*m*f-k*e*g,this._z=d*e*g-k*m*f,this._w=d*e*f+k*m*g):"ZXY"===h?(this._x=k*e*f-d*m*g,this._y=d*m*f+k*e*g,this._z=d*e*g+k*m*f,this._w=d*e*f-k*m*g):"ZYX"===h?(this._x=k*e*f-d*m*g,this._y=d*m*f+k*e*g,this._z=d*e*g-k*m*f,this._w=d*e*f+k*m*g):"YZX"===
h?(this._x=k*e*f+d*m*g,this._y=d*m*f+k*e*g,this._z=d*e*g-k*m*f,this._w=d*e*f-k*m*g):"XZY"===h&&(this._x=k*e*f-d*m*g,this._y=d*m*f-k*e*g,this._z=d*e*g+k*m*f,this._w=d*e*f+k*m*g);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,b){var d=b/2,c=Math.sin(d);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(d);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,d=b[0];a=b[4];var c=b[8],f=b[1],k=b[5],m=b[9],g=b[2],h=b[6],b=b[10],n=d+
k+b;0<n?(d=.5/Math.sqrt(n+1),this._w=.25/d,this._x=(h-m)*d,this._y=(c-g)*d,this._z=(f-a)*d):d>k&&d>b?(d=2*Math.sqrt(1+d-k-b),this._w=(h-m)/d,this._x=.25*d,this._y=(a+f)/d,this._z=(c+g)/d):k>b?(d=2*Math.sqrt(1+k-d-b),this._w=(c-g)/d,this._x=(a+f)/d,this._y=.25*d,this._z=(m+h)/d):(d=2*Math.sqrt(1+b-d-k),this._w=(f-a)/d,this._x=(c+g)/d,this._y=(m+h)/d,this._z=.25*d);this.onChangeCallback();return this},setFromUnitVectors:function(){var a,b;return function(d,e){void 0===a&&(a=new c.Vector3);b=d.dot(e)+
1;1E-6>b?(b=0,Math.abs(d.x)>Math.abs(d.z)?a.set(-d.y,d.x,0):a.set(0,-d.z,d.y)):a.crossVectors(d,e);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},
length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},
multiplyQuaternions:function(a,b){var d=a._x,c=a._y,f=a._z,k=a._w,m=b._x,g=b._y,h=b._z,n=b._w;this._x=d*n+k*m+c*h-f*g;this._y=c*n+k*g+f*m-d*h;this._z=f*n+k*h+d*g-c*m;this._w=k*n-d*m-c*g-f*h;this.onChangeCallback();return this},multiplyVector3:function(a){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var d=this._x,c=
this._y,f=this._z,k=this._w,m=k*a._w+d*a._x+c*a._y+f*a._z;0>m?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,m=-m):this.copy(a);if(1<=m)return this._w=k,this._x=d,this._y=c,this._z=f,this;var g=Math.acos(m),h=Math.sqrt(1-m*m);if(.001>Math.abs(h))return this._w=.5*(k+this._w),this._x=.5*(d+this._x),this._y=.5*(c+this._y),this._z=.5*(f+this._z),this;m=Math.sin((1-b)*g)/h;g=Math.sin(b*g)/h;this._w=k*m+this._w*g;this._x=d*m+this._x*g;this._y=c*m+this._y*g;this._z=f*m+this._z*g;this.onChangeCallback();
return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};c.Quaternion.slerp=function(a,b,d,c){return d.copy(a).slerp(b,
c)};c.Vector2=function(a,b){this.x=a||0;this.y=b||0};c.Vector2.prototype={constructor:c.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,
this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=
a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},clampScalar:function(){var a,b;return function(d,e){void 0===a&&(a=new c.Vector2,b=new c.Vector2);a.set(d,d);b.set(e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=
Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+
Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(a,b,d){this.subVectors(b,a).multiplyScalar(d).add(a);return this},equals:function(a){return a.x===
this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromAttribute:function(a,b,d){void 0===d&&(d=0);b=b*a.itemSize+d;this.x=a.array[b];this.y=a.array[b+1];return this}};c.Vector3=function(a,b,d){this.x=a||0;this.y=b||0;this.z=d||0};c.Vector3.prototype={constructor:c.Vector3,set:function(a,b,d){this.x=a;this.y=b;this.z=d;return this},setX:function(a){this.x=
a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){this.x=a.x;this.y=
a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this},sub:function(a,b){if(void 0!==
b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,
b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a;return function(b){!1===b instanceof c.Euler&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.");void 0===a&&(a=new c.Quaternion);this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a;
return function(b,d){void 0===a&&(a=new c.Quaternion);this.applyQuaternion(a.setFromAxisAngle(b,d));return this}}(),applyMatrix3:function(a){var b=this.x,d=this.y,c=this.z;a=a.elements;this.x=a[0]*b+a[3]*d+a[6]*c;this.y=a[1]*b+a[4]*d+a[7]*c;this.z=a[2]*b+a[5]*d+a[8]*c;return this},applyMatrix4:function(a){var b=this.x,d=this.y,c=this.z;a=a.elements;this.x=a[0]*b+a[4]*d+a[8]*c+a[12];this.y=a[1]*b+a[5]*d+a[9]*c+a[13];this.z=a[2]*b+a[6]*d+a[10]*c+a[14];return this},applyProjection:function(a){var b=
this.x,d=this.y,c=this.z;a=a.elements;var f=1/(a[3]*b+a[7]*d+a[11]*c+a[15]);this.x=(a[0]*b+a[4]*d+a[8]*c+a[12])*f;this.y=(a[1]*b+a[5]*d+a[9]*c+a[13])*f;this.z=(a[2]*b+a[6]*d+a[10]*c+a[14])*f;return this},applyQuaternion:function(a){var b=this.x,d=this.y,c=this.z,f=a.x,k=a.y,m=a.z;a=a.w;var g=a*b+k*c-m*d,h=a*d+m*b-f*c,n=a*c+f*d-k*b,b=-f*b-k*d-m*c;this.x=g*a+b*-f+h*-m-n*-k;this.y=h*a+b*-k+n*-f-g*-m;this.z=n*a+b*-m+g*-k-h*-f;return this},project:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);
a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyProjection(a)}}(),unproject:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyProjection(a)}}(),transformDirection:function(a){var b=this.x,d=this.y,c=this.z;a=a.elements;this.x=a[0]*b+a[4]*d+a[8]*c;this.y=a[1]*b+a[5]*d+a[9]*c;this.z=a[2]*b+a[6]*d+a[10]*c;this.normalize();return this},divide:function(a){this.x/=a.x;
this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=
b.z);return this},clampScalar:function(){var a,b;return function(d,e){void 0===a&&(a=new c.Vector3,b=new c.Vector3);a.set(d,d,d);b.set(e,e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=
0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+
Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,d){this.subVectors(b,a).multiplyScalar(d).add(a);return this},cross:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),
this.crossVectors(a,b);var d=this.x,c=this.y,f=this.z;this.x=c*a.z-f*a.y;this.y=f*a.x-d*a.z;this.z=d*a.y-c*a.x;return this},crossVectors:function(a,b){var d=a.x,c=a.y,f=a.z,k=b.x,m=b.y,g=b.z;this.x=c*g-f*m;this.y=f*k-d*g;this.z=d*m-c*k;return this},projectOnVector:function(){var a,b;return function(d){void 0===a&&(a=new c.Vector3);a.copy(d).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){void 0===a&&(a=new c.Vector3);a.copy(this).projectOnVector(b);
return this.sub(a)}}(),reflect:function(){var a;return function(b){void 0===a&&(a=new c.Vector3);return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(c.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,d=this.y-a.y;a=this.z-a.z;return b*b+d*d+a*a},setEulerFromRotationMatrix:function(a,b){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},
setEulerFromQuaternion:function(a,b){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,
b){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),d=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=d;this.z=
a;return this},setFromMatrixColumn:function(a,b){var d=4*a,c=b.elements;this.x=c[d];this.y=c[d+1];this.z=c[d+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromAttribute:function(a,b,d){void 0===d&&(d=0);b=b*a.itemSize+d;this.x=a.array[b];this.y=a.array[b+1];this.z=
a.array[b+2];return this}};c.Vector4=function(a,b,d,c){this.x=a||0;this.y=b||0;this.z=d||0;this.w=void 0!==c?c:1};c.Vector4.prototype={constructor:c.Vector4,set:function(a,b,d,c){this.x=a;this.y=b;this.z=d;this.w=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=
b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,
b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,d=this.y,c=this.z,f=this.w;a=a.elements;this.x=a[0]*b+a[4]*d+a[8]*c+a[12]*f;this.y=a[1]*b+a[5]*d+a[9]*c+a[13]*f;this.z=a[2]*b+a[6]*d+a[10]*c+a[14]*
f;this.w=a[3]*b+a[7]*d+a[11]*c+a[15]*f;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,d,c;a=a.elements;var f=a[0];c=a[4];var k=a[8],m=a[1],g=a[5],h=a[9];d=a[2];b=a[6];var n=a[10];if(.01>
Math.abs(c-m)&&.01>Math.abs(k-d)&&.01>Math.abs(h-b)){if(.1>Math.abs(c+m)&&.1>Math.abs(k+d)&&.1>Math.abs(h+b)&&.1>Math.abs(f+g+n-3))return this.set(1,0,0,0),this;a=Math.PI;f=(f+1)/2;g=(g+1)/2;n=(n+1)/2;c=(c+m)/4;k=(k+d)/4;h=(h+b)/4;f>g&&f>n?.01>f?(b=0,c=d=.707106781):(b=Math.sqrt(f),d=c/b,c=k/b):g>n?.01>g?(b=.707106781,d=0,c=.707106781):(d=Math.sqrt(g),b=c/d,c=h/d):.01>n?(d=b=.707106781,c=0):(c=Math.sqrt(n),b=k/c,d=h/c);this.set(b,d,c,a);return this}a=Math.sqrt((b-h)*(b-h)+(k-d)*(k-d)+(m-c)*(m-c));
.001>Math.abs(a)&&(a=1);this.x=(b-h)/a;this.y=(k-d)/a;this.z=(m-c)/a;this.w=Math.acos((f+g+n-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);this.w<a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=
a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},clampScalar:function(){var a,b;return function(d,e){void 0===a&&(a=new c.Vector4,b=new c.Vector4);a.set(d,d,d,d);b.set(e,e,e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},
round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*
a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=
(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,b,d){this.subVectors(b,a).multiplyScalar(d).add(a);return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromAttribute:function(a,
b,d){void 0===d&&(d=0);b=b*a.itemSize+d;this.x=a.array[b];this.y=a.array[b+1];this.z=a.array[b+2];this.w=a.array[b+3];return this}};c.Euler=function(a,b,d,e){this._x=a||0;this._y=b||0;this._z=d||0;this._order=e||c.Euler.DefaultOrder};c.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");c.Euler.DefaultOrder="XYZ";c.Euler.prototype={constructor:c.Euler,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},
set z(a){this._z=a;this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a;this.onChangeCallback()},set:function(a,b,d,c){this._x=a;this._y=b;this._z=d;this._order=c||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,d){var e=c.Math.clamp,f=a.elements;
a=f[0];var k=f[4],m=f[8],g=f[1],h=f[5],n=f[9],s=f[2],p=f[6],f=f[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(e(m,-1,1)),.99999>Math.abs(m)?(this._x=Math.atan2(-n,f),this._z=Math.atan2(-k,a)):(this._x=Math.atan2(p,h),this._z=0)):"YXZ"===b?(this._x=Math.asin(-e(n,-1,1)),.99999>Math.abs(n)?(this._y=Math.atan2(m,f),this._z=Math.atan2(g,h)):(this._y=Math.atan2(-s,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(e(p,-1,1)),.99999>Math.abs(p)?(this._y=Math.atan2(-s,f),this._z=Math.atan2(-k,h)):(this._y=
0,this._z=Math.atan2(g,a))):"ZYX"===b?(this._y=Math.asin(-e(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(p,f),this._z=Math.atan2(g,a)):(this._x=0,this._z=Math.atan2(-k,h))):"YZX"===b?(this._z=Math.asin(e(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-n,h),this._y=Math.atan2(-s,a)):(this._x=0,this._y=Math.atan2(m,f))):"XZY"===b?(this._z=Math.asin(-e(k,-1,1)),.99999>Math.abs(k)?(this._x=Math.atan2(p,h),this._y=Math.atan2(m,a)):(this._x=Math.atan2(-n,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+
b);this._order=b;if(!1!==d)this.onChangeCallback();return this},setFromQuaternion:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Matrix4);a.makeRotationFromQuaternion(b);this.setFromRotationMatrix(a,d,e);return this}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new c.Quaternion;return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===
this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new c.Vector3(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};c.Matrix3=function(){this.elements=
new Float32Array([1,0,0,0,1,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};c.Matrix3.prototype={constructor:c.Matrix3,set:function(a,b,d,c,f,k,m,g,h){var n=this.elements;n[0]=a;n[3]=b;n[6]=d;n[1]=c;n[4]=f;n[7]=k;n[2]=m;n[5]=g;n[8]=h;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){a=a.elements;this.set(a[0],
a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},multiplyVector3Array:function(a){console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(a)},applyToVector3Array:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Vector3);
void 0===d&&(d=0);void 0===e&&(e=b.length);for(var f=0;f<e;f+=3,d+=3)a.fromArray(b,d),a.applyMatrix3(this),a.toArray(b,d);return b}}(),applyToBuffer:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Vector3);void 0===d&&(d=0);void 0===e&&(e=b.length/b.itemSize);for(var f=0;f<e;f++,d++)a.x=b.getX(d),a.y=b.getY(d),a.z=b.getZ(d),a.applyMatrix3(this),b.setXYZ(a.x,a.y,a.z);return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=
a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],d=a[1],c=a[2],f=a[3],k=a[4],m=a[5],g=a[6],h=a[7],a=a[8];return b*k*a-b*m*h-d*f*a+d*m*g+c*f*h-c*k*g},getInverse:function(a,b){var d=a.elements,c=this.elements;c[0]=d[10]*d[5]-d[6]*d[9];c[1]=-d[10]*d[1]+d[2]*d[9];c[2]=d[6]*d[1]-d[2]*d[5];c[3]=-d[10]*d[4]+d[6]*d[8];c[4]=d[10]*d[0]-d[2]*d[8];c[5]=-d[6]*d[0]+d[2]*d[4];c[6]=d[9]*d[4]-d[5]*d[8];c[7]=-d[9]*d[0]+d[1]*d[8];c[8]=d[5]*d[0]-d[1]*d[4];d=d[0]*c[0]+d[1]*c[3]+d[2]*c[6];if(0===
d){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/d);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},flattenToArrayOffset:function(a,b){var d=this.elements;a[b]=d[0];a[b+1]=d[1];a[b+2]=d[2];a[b+3]=d[3];a[b+4]=d[4];a[b+5]=d[5];a[b+6]=d[6];a[b+7]=d[7];
a[b+8]=d[8];return a},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]}};c.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0<arguments.length&&
console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};c.Matrix4.prototype={constructor:c.Matrix4,set:function(a,b,d,c,f,k,m,g,h,n,s,p,l,q,t,r){var y=this.elements;y[0]=a;y[4]=b;y[8]=d;y[12]=c;y[1]=f;y[5]=k;y[9]=m;y[13]=g;y[2]=h;y[6]=n;y[10]=s;y[14]=p;y[3]=l;y[7]=q;y[11]=t;y[15]=r;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new c.Matrix4).fromArray(this.elements)},copy:function(a){this.elements.set(a.elements);
return this},extractPosition:function(a){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(a)},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,d){var c=this.elements;a.set(c[0],c[1],c[2]);b.set(c[4],c[5],c[6]);d.set(c[8],c[9],c[10]);return this},makeBasis:function(a,b,d){this.set(a.x,b.x,d.x,0,a.y,b.y,d.y,0,a.z,b.z,d.z,0,0,0,0,1);return this},extractRotation:function(){var a;
return function(b){void 0===a&&(a=new c.Vector3);var d=this.elements;b=b.elements;var e=1/a.set(b[0],b[1],b[2]).length(),f=1/a.set(b[4],b[5],b[6]).length(),k=1/a.set(b[8],b[9],b[10]).length();d[0]=b[0]*e;d[1]=b[1]*e;d[2]=b[2]*e;d[4]=b[4]*f;d[5]=b[5]*f;d[6]=b[6]*f;d[8]=b[8]*k;d[9]=b[9]*k;d[10]=b[10]*k;return this}}(),makeRotationFromEuler:function(a){!1===a instanceof c.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=
this.elements,d=a.x,e=a.y,f=a.z,k=Math.cos(d),d=Math.sin(d),m=Math.cos(e),e=Math.sin(e),g=Math.cos(f),f=Math.sin(f);if("XYZ"===a.order){a=k*g;var h=k*f,n=d*g,s=d*f;b[0]=m*g;b[4]=-m*f;b[8]=e;b[1]=h+n*e;b[5]=a-s*e;b[9]=-d*m;b[2]=s-a*e;b[6]=n+h*e;b[10]=k*m}else"YXZ"===a.order?(a=m*g,h=m*f,n=e*g,s=e*f,b[0]=a+s*d,b[4]=n*d-h,b[8]=k*e,b[1]=k*f,b[5]=k*g,b[9]=-d,b[2]=h*d-n,b[6]=s+a*d,b[10]=k*m):"ZXY"===a.order?(a=m*g,h=m*f,n=e*g,s=e*f,b[0]=a-s*d,b[4]=-k*f,b[8]=n+h*d,b[1]=h+n*d,b[5]=k*g,b[9]=s-a*d,b[2]=-k*
e,b[6]=d,b[10]=k*m):"ZYX"===a.order?(a=k*g,h=k*f,n=d*g,s=d*f,b[0]=m*g,b[4]=n*e-h,b[8]=a*e+s,b[1]=m*f,b[5]=s*e+a,b[9]=h*e-n,b[2]=-e,b[6]=d*m,b[10]=k*m):"YZX"===a.order?(a=k*m,h=k*e,n=d*m,s=d*e,b[0]=m*g,b[4]=s-a*f,b[8]=n*f+h,b[1]=f,b[5]=k*g,b[9]=-d*g,b[2]=-e*g,b[6]=h*f+n,b[10]=a-s*f):"XZY"===a.order&&(a=k*m,h=k*e,n=d*m,s=d*e,b[0]=m*g,b[4]=-f,b[8]=e*g,b[1]=a*f+s,b[5]=k*g,b[9]=h*f-n,b[2]=n*f-h,b[6]=d*g,b[10]=s*f+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");
return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,d=a.x,c=a.y,f=a.z,k=a.w,m=d+d,g=c+c,h=f+f;a=d*m;var n=d*g,d=d*h,s=c*g,c=c*h,f=f*h,m=k*m,g=k*g,k=k*h;b[0]=1-(s+f);b[4]=n-k;b[8]=d+g;b[1]=n+k;b[5]=1-(a+f);b[9]=c-m;b[2]=d-g;b[6]=c+m;b[10]=1-(a+s);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a,b,d;return function(e,f,k){void 0===a&&(a=new c.Vector3);void 0===b&&(b=new c.Vector3);void 0===d&&(d=new c.Vector3);
var m=this.elements;d.subVectors(e,f).normalize();0===d.length()&&(d.z=1);a.crossVectors(k,d).normalize();0===a.length()&&(d.x+=1E-4,a.crossVectors(k,d).normalize());b.crossVectors(d,a);m[0]=a.x;m[4]=b.x;m[8]=d.x;m[1]=a.y;m[5]=b.y;m[9]=d.y;m[2]=a.z;m[6]=b.z;m[10]=d.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,
b){var d=a.elements,c=b.elements,f=this.elements,k=d[0],m=d[4],g=d[8],h=d[12],n=d[1],s=d[5],p=d[9],l=d[13],q=d[2],t=d[6],r=d[10],y=d[14],z=d[3],w=d[7],I=d[11],d=d[15],B=c[0],E=c[4],K=c[8],H=c[12],F=c[1],D=c[5],V=c[9],L=c[13],P=c[2],G=c[6],C=c[10],J=c[14],M=c[3],U=c[7],X=c[11],c=c[15];f[0]=k*B+m*F+g*P+h*M;f[4]=k*E+m*D+g*G+h*U;f[8]=k*K+m*V+g*C+h*X;f[12]=k*H+m*L+g*J+h*c;f[1]=n*B+s*F+p*P+l*M;f[5]=n*E+s*D+p*G+l*U;f[9]=n*K+s*V+p*C+l*X;f[13]=n*H+s*L+p*J+l*c;f[2]=q*B+t*F+r*P+y*M;f[6]=q*E+t*D+r*G+y*U;f[10]=
q*K+t*V+r*C+y*X;f[14]=q*H+t*L+r*J+y*c;f[3]=z*B+w*F+I*P+d*M;f[7]=z*E+w*D+I*G+d*U;f[11]=z*K+w*V+I*C+d*X;f[15]=z*H+w*L+I*J+d*c;return this},multiplyToArray:function(a,b,d){var c=this.elements;this.multiplyMatrices(a,b);d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];d[6]=c[6];d[7]=c[7];d[8]=c[8];d[9]=c[9];d[10]=c[10];d[11]=c[11];d[12]=c[12];d[13]=c[13];d[14]=c[14];d[15]=c[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=
a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return a.applyProjection(this)},multiplyVector4:function(a){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(a){console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");
return this.applyToVector3Array(a)},applyToVector3Array:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Vector3);void 0===d&&(d=0);void 0===e&&(e=b.length);for(var f=0;f<e;f+=3,d+=3)a.fromArray(b,d),a.applyMatrix4(this),a.toArray(b,d);return b}}(),applyToBuffer:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Vector3);void 0===d&&(d=0);void 0===e&&(e=b.length/b.itemSize);for(var f=0;f<e;f++,d++)a.x=b.getX(d),a.y=b.getY(d),a.z=b.getZ(d),a.applyMatrix4(this),b.setXYZ(a.x,a.y,
a.z);return b}}(),rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],d=a[4],c=a[8],f=a[12],k=a[1],m=a[5],g=a[9],h=a[13],n=a[2],s=a[6],p=a[10],l=a[14];return a[3]*(+f*g*s-c*h*s-f*
m*p+d*h*p+c*m*l-d*g*l)+a[7]*(+b*g*l-b*h*p+f*k*p-c*k*l+c*h*n-f*g*n)+a[11]*(+b*h*s-b*m*l-f*k*s+d*k*l+f*m*n-d*h*n)+a[15]*(-c*m*n-b*g*s+b*m*p+c*k*s-d*k*p+d*g*n)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArrayOffset:function(a,b){var d=this.elements;a[b]=d[0];a[b+1]=d[1];a[b+2]=d[2];a[b+3]=d[3];a[b+4]=d[4];a[b+5]=d[5];a[b+6]=d[6];
a[b+7]=d[7];a[b+8]=d[8];a[b+9]=d[9];a[b+10]=d[10];a[b+11]=d[11];a[b+12]=d[12];a[b+13]=d[13];a[b+14]=d[14];a[b+15]=d[15];return a},getPosition:function(){var a;return function(){void 0===a&&(a=new c.Vector3);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var d=this.elements,
c=a.elements,f=c[0],k=c[4],m=c[8],g=c[12],h=c[1],n=c[5],s=c[9],p=c[13],l=c[2],q=c[6],t=c[10],r=c[14],y=c[3],z=c[7],w=c[11],c=c[15];d[0]=s*r*z-p*t*z+p*q*w-n*r*w-s*q*c+n*t*c;d[4]=g*t*z-m*r*z-g*q*w+k*r*w+m*q*c-k*t*c;d[8]=m*p*z-g*s*z+g*n*w-k*p*w-m*n*c+k*s*c;d[12]=g*s*q-m*p*q-g*n*t+k*p*t+m*n*r-k*s*r;d[1]=p*t*y-s*r*y-p*l*w+h*r*w+s*l*c-h*t*c;d[5]=m*r*y-g*t*y+g*l*w-f*r*w-m*l*c+f*t*c;d[9]=g*s*y-m*p*y-g*h*w+f*p*w+m*h*c-f*s*c;d[13]=m*p*l-g*s*l+g*h*t-f*p*t-m*h*r+f*s*r;d[2]=n*r*y-p*q*y+p*l*z-h*r*z-n*l*c+h*q*c;
d[6]=g*q*y-k*r*y-g*l*z+f*r*z+k*l*c-f*q*c;d[10]=k*p*y-g*n*y+g*h*z-f*p*z-k*h*c+f*n*c;d[14]=g*n*l-k*p*l-g*h*q+f*p*q+k*h*r-f*n*r;d[3]=s*q*y-n*t*y-s*l*z+h*t*z+n*l*w-h*q*w;d[7]=k*t*y-m*q*y+m*l*z-f*t*z-k*l*w+f*q*w;d[11]=m*n*y-k*s*y-m*h*z+f*s*z+k*h*w-f*n*w;d[15]=k*s*l-m*n*l+m*h*q-f*s*q-k*h*t+f*n*t;d=f*d[0]+h*d[4]+l*d[8]+y*d[12];if(0===d){if(b)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();
return this}this.multiplyScalar(1/d);return this},translate:function(a){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(a){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(a){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(a){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(a,b){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(a){var b=this.elements,
d=a.x,c=a.y;a=a.z;b[0]*=d;b[4]*=c;b[8]*=a;b[1]*=d;b[5]*=c;b[9]*=a;b[2]*=d;b[6]*=c;b[10]*=a;b[3]*=d;b[7]*=c;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,d){this.set(1,0,0,a,0,1,0,b,0,0,1,d,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},
makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var d=Math.cos(b),c=Math.sin(b),f=1-d,k=a.x,m=a.y,g=a.z,h=f*k,n=f*m;this.set(h*k+d,h*m-c*g,h*g+c*m,0,h*m+c*g,n*m+d,n*g-c*k,0,h*g-c*m,n*g+c*k,f*g*g+d,0,0,0,0,1);return this},makeScale:function(a,b,d){this.set(a,0,0,0,0,b,0,0,0,0,d,0,0,0,0,1);return this},
compose:function(a,b,d){this.makeRotationFromQuaternion(b);this.scale(d);this.setPosition(a);return this},decompose:function(){var a,b;return function(d,e,f){void 0===a&&(a=new c.Vector3);void 0===b&&(b=new c.Matrix4);var k=this.elements,m=a.set(k[0],k[1],k[2]).length(),g=a.set(k[4],k[5],k[6]).length(),h=a.set(k[8],k[9],k[10]).length();0>this.determinant()&&(m=-m);d.x=k[12];d.y=k[13];d.z=k[14];b.elements.set(this.elements);d=1/m;var k=1/g,n=1/h;b.elements[0]*=d;b.elements[1]*=d;b.elements[2]*=d;b.elements[4]*=
k;b.elements[5]*=k;b.elements[6]*=k;b.elements[8]*=n;b.elements[9]*=n;b.elements[10]*=n;e.setFromRotationMatrix(b);f.x=m;f.y=g;f.z=h;return this}}(),makeFrustum:function(a,b,d,c,f,k){var m=this.elements;m[0]=2*f/(b-a);m[4]=0;m[8]=(b+a)/(b-a);m[12]=0;m[1]=0;m[5]=2*f/(c-d);m[9]=(c+d)/(c-d);m[13]=0;m[2]=0;m[6]=0;m[10]=-(k+f)/(k-f);m[14]=-2*k*f/(k-f);m[3]=0;m[7]=0;m[11]=-1;m[15]=0;return this},makePerspective:function(a,b,d,e){a=d*Math.tan(c.Math.degToRad(.5*a));var f=-a;return this.makeFrustum(f*b,a*
b,f,a,d,e)},makeOrthographic:function(a,b,d,c,f,k){var m=this.elements,g=b-a,h=d-c,n=k-f;m[0]=2/g;m[4]=0;m[8]=0;m[12]=-((b+a)/g);m[1]=0;m[5]=2/h;m[9]=0;m[13]=-((d+c)/h);m[2]=0;m[6]=0;m[10]=-2/n;m[14]=-((k+f)/n);m[3]=0;m[7]=0;m[11]=0;m[15]=1;return this},equals:function(a){var b=this.elements;a=a.elements;for(var d=0;16>d;d++)if(b[d]!==a[d])return!1;return!0},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],
a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]}};c.Ray=function(a,b){this.origin=void 0!==a?a:new c.Vector3;this.direction=void 0!==b?b:new c.Vector3};c.Ray.prototype={constructor:c.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new c.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},
recast:function(){var a=new c.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var d=b||new c.Vector3;d.subVectors(a,this.origin);var e=d.dot(this.direction);return 0>e?d.copy(this.origin):d.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new c.Vector3;return function(b){var d=a.subVectors(b,this.origin).dot(this.direction);
if(0>d)return this.origin.distanceToSquared(b);a.copy(this.direction).multiplyScalar(d).add(this.origin);return a.distanceToSquared(b)}}(),distanceSqToSegment:function(){var a=new c.Vector3,b=new c.Vector3,d=new c.Vector3;return function(c,f,k,m){a.copy(c).add(f).multiplyScalar(.5);b.copy(f).sub(c).normalize();d.copy(this.origin).sub(a);var g=.5*c.distanceTo(f),h=-this.direction.dot(b),n=d.dot(this.direction),s=-d.dot(b),p=d.lengthSq(),l=Math.abs(1-h*h),q;0<l?(c=h*s-n,f=h*n-s,q=g*l,0<=c?f>=-q?f<=
q?(g=1/l,c*=g,f*=g,h=c*(c+h*f+2*n)+f*(h*c+f+2*s)+p):(f=g,c=Math.max(0,-(h*f+n)),h=-c*c+f*(f+2*s)+p):(f=-g,c=Math.max(0,-(h*f+n)),h=-c*c+f*(f+2*s)+p):f<=-q?(c=Math.max(0,-(-h*g+n)),f=0<c?-g:Math.min(Math.max(-g,-s),g),h=-c*c+f*(f+2*s)+p):f<=q?(c=0,f=Math.min(Math.max(-g,-s),g),h=f*(f+2*s)+p):(c=Math.max(0,-(h*g+n)),f=0<c?g:Math.min(Math.max(-g,-s),g),h=-c*c+f*(f+2*s)+p)):(f=0<h?-g:g,c=Math.max(0,-(h*f+n)),h=-c*c+f*(f+2*s)+p);k&&k.copy(this.direction).multiplyScalar(c).add(this.origin);m&&m.copy(b).multiplyScalar(f).add(a);
return h}}(),isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},intersectSphere:function(){var a=new c.Vector3;return function(b,c){a.subVectors(b.center,this.origin);var e=a.dot(this.direction),f=a.dot(a)-e*e,k=b.radius*b.radius;if(f>k)return null;k=Math.sqrt(k-f);f=e-k;e+=k;return 0>f&&0>e?null:0>f?this.at(e,c):this.at(f,c)}}(),isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},distanceToPlane:function(a){var b=
a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},isIntersectionBox:function(){var a=new c.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectBox:function(a,b){var c,e,f,k,g;e=1/this.direction.x;k=1/this.direction.y;g=1/this.direction.z;var h=this.origin;0<=e?(c=(a.min.x-h.x)*e,e*=
a.max.x-h.x):(c=(a.max.x-h.x)*e,e*=a.min.x-h.x);0<=k?(f=(a.min.y-h.y)*k,k*=a.max.y-h.y):(f=(a.max.y-h.y)*k,k*=a.min.y-h.y);if(c>k||f>e)return null;if(f>c||c!==c)c=f;if(k<e||e!==e)e=k;0<=g?(f=(a.min.z-h.z)*g,g*=a.max.z-h.z):(f=(a.max.z-h.z)*g,g*=a.min.z-h.z);if(c>g||f>e)return null;if(f>c||c!==c)c=f;if(g<e||e!==e)e=g;return 0>e?null:this.at(0<=c?c:e,b)},intersectTriangle:function(){var a=new c.Vector3,b=new c.Vector3,d=new c.Vector3,e=new c.Vector3;return function(c,k,g,h,p){b.subVectors(k,c);d.subVectors(g,
c);e.crossVectors(b,d);k=this.direction.dot(e);if(0<k){if(h)return null;h=1}else if(0>k)h=-1,k=-k;else return null;a.subVectors(this.origin,c);c=h*this.direction.dot(d.crossVectors(a,d));if(0>c)return null;g=h*this.direction.dot(b.cross(a));if(0>g||c+g>k)return null;c=-h*a.dot(e);return 0>c?null:this.at(c/k,p)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&
a.direction.equals(this.direction)}};c.Box2=function(a,b){this.min=void 0!==a?a:new c.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new c.Vector2(-Infinity,-Infinity)};c.Box2.prototype={constructor:c.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new c.Vector2;return function(b,c){var e=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(e);
this.max.copy(b).add(e);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new c.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new c.Vector2).subVectors(this.max,this.min)},
expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new c.Vector2).set((a.x-
this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){return(b||new c.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new c.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);
this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}};c.Box3=function(a,b){this.min=void 0!==a?a:new c.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new c.Vector3(-Infinity,-Infinity,-Infinity)};c.Box3.prototype={constructor:c.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);
return this},setFromCenterAndSize:function(){var a=new c.Vector3;return function(b,c){var e=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),setFromObject:function(){var a=new c.Vector3;return function(b){var d=this;b.updateMatrixWorld(!0);this.makeEmpty();b.traverse(function(b){var f=b.geometry;if(void 0!==f)if(f instanceof c.Geometry)for(var k=f.vertices,f=0,g=k.length;f<g;f++)a.copy(k[f]),a.applyMatrix4(b.matrixWorld),d.expandByPoint(a);else if(f instanceof
c.BufferGeometry&&void 0!==f.attributes.position)for(k=f.attributes.position.array,f=0,g=k.length;f<g;f+=3)a.set(k[f],k[f+1],k[f+2]),a.applyMatrix4(b.matrixWorld),d.expandByPoint(a)});return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<
this.min.y||this.max.z<this.min.z},center:function(a){return(a||new c.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new c.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||
a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new c.Vector3).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>
this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new c.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new c.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new c.Vector3;return function(b){b=b||new c.Sphere;b.center=this.center();b.radius=.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},
union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3];return function(b){a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,
this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}};c.Sphere=function(a,b){this.center=void 0!==a?a:new c.Vector3;this.radius=void 0!==b?b:0};c.Sphere.prototype=
{constructor:c.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new c.Box3;return function(b,c){var e=this.center;void 0!==c?e.copy(c):a.setFromPoints(b).center(e);for(var f=0,k=0,g=b.length;k<g;k++)f=Math.max(f,e.distanceToSquared(b[k]));this.radius=Math.sqrt(f);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},
containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var d=this.center.distanceToSquared(a),e=b||new c.Vector3;e.copy(a);d>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center));return e},getBoundingBox:function(a){a=
a||new c.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius}};c.Plane=function(a,b){this.normal=void 0!==a?a:new c.Vector3(1,0,0);this.constant=void 0!==b?b:0};c.Plane.prototype={constructor:c.Plane,set:function(a,b){this.normal.copy(a);this.constant=
b;return this},setComponents:function(a,b,c,e){this.normal.set(a,b,c);this.constant=e;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new c.Vector3,b=new c.Vector3;return function(c,e,f){e=a.subVectors(f,e).cross(b.subVectors(c,e)).normalize();this.setFromNormalAndCoplanarPoint(e,c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);
this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,b){var d=this.distanceToPoint(a);return(b||
new c.Vector3).copy(this.normal).multiplyScalar(d)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new c.Vector3;return function(b,d){var e=d||new c.Vector3,f=b.delta(a),k=this.normal.dot(f);if(0===k){if(0===this.distanceToPoint(b.start))return e.copy(b.start)}else return k=-(b.start.dot(this.normal)+this.constant)/k,0>k||1<k?void 0:e.copy(f).multiplyScalar(k).add(b.start)}}(),coplanarPoint:function(a){return(a||
new c.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new c.Vector3,b=new c.Vector3,d=new c.Matrix3;return function(c,f){var k=f||d.getNormalMatrix(c),k=a.copy(this.normal).applyMatrix3(k),g=this.coplanarPoint(b);g.applyMatrix4(c);this.setFromNormalAndCoplanarPoint(k,g);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}};c.Frustum=function(a,
b,d,e,f,k){this.planes=[void 0!==a?a:new c.Plane,void 0!==b?b:new c.Plane,void 0!==d?d:new c.Plane,void 0!==e?e:new c.Plane,void 0!==f?f:new c.Plane,void 0!==k?k:new c.Plane]};c.Frustum.prototype={constructor:c.Frustum,set:function(a,b,c,e,f,k){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(e);g[4].copy(f);g[5].copy(k);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=
this.planes,c=a.elements;a=c[0];var e=c[1],f=c[2],k=c[3],g=c[4],h=c[5],p=c[6],n=c[7],s=c[8],q=c[9],l=c[10],u=c[11],t=c[12],r=c[13],y=c[14],c=c[15];b[0].setComponents(k-a,n-g,u-s,c-t).normalize();b[1].setComponents(k+a,n+g,u+s,c+t).normalize();b[2].setComponents(k+e,n+h,u+q,c+r).normalize();b[3].setComponents(k-e,n-h,u-q,c-r).normalize();b[4].setComponents(k-f,n-p,u-l,c-y).normalize();b[5].setComponents(k+f,n+p,u+l,c+y).normalize();return this},intersectsObject:function(){var a=new c.Sphere;return function(b){var c=
b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var e=0;6>e;e++)if(b[e].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new c.Vector3,b=new c.Vector3;return function(c){for(var e=this.planes,f=0;6>f;f++){var k=e[f];a.x=0<k.normal.x?c.min.x:c.max.x;b.x=0<k.normal.x?c.max.x:c.min.x;a.y=0<k.normal.y?c.min.y:
c.max.y;b.y=0<k.normal.y?c.max.y:c.min.y;a.z=0<k.normal.z?c.min.z:c.max.z;b.z=0<k.normal.z?c.max.z:c.min.z;var g=k.distanceToPoint(a),k=k.distanceToPoint(b);if(0>g&&0>k)return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}};c.Math={generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,e;return function(){for(var f=0;36>f;f++)8===f||13===f||18===f||23===f?b[f]=
"-":14===f?b[f]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),e=c&15,c>>=4,b[f]=a[19===f?e&3|8:e]);return b.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,e,f){return e+(a-b)*(f-e)/(c-b)},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*
(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nextPowerOfTwo:function(a){a--;a|=a>>1;a|=
a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a}};c.Triangle=function(a,b,d){this.a=void 0!==a?a:new c.Vector3;this.b=void 0!==b?b:new c.Vector3;this.c=void 0!==d?d:new c.Vector3};c.Triangle.normal=function(){var a=new c.Vector3;return function(b,d,e,f){f=f||new c.Vector3;f.subVectors(e,d);a.subVectors(b,d);f.cross(a);b=f.lengthSq();return 0<b?f.multiplyScalar(1/Math.sqrt(b)):f.set(0,0,0)}}();c.Triangle.barycoordFromPoint=function(){var a=new c.Vector3,b=new c.Vector3,d=new c.Vector3;return function(e,
f,k,g,h){a.subVectors(g,f);b.subVectors(k,f);d.subVectors(e,f);e=a.dot(a);f=a.dot(b);k=a.dot(d);var p=b.dot(b);g=b.dot(d);var n=e*p-f*f;h=h||new c.Vector3;if(0===n)return h.set(-2,-1,-1);n=1/n;p=(p*k-f*g)*n;e=(e*g-f*k)*n;return h.set(1-p-e,e,p)}}();c.Triangle.containsPoint=function(){var a=new c.Vector3;return function(b,d,e,f){b=c.Triangle.barycoordFromPoint(b,d,e,f,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();c.Triangle.prototype={constructor:c.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);
this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,e){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[e]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new c.Vector3,b=new c.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return.5*a.cross(b).length()}}(),midpoint:function(a){return(a||new c.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/
3)},normal:function(a){return c.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new c.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return c.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return c.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}};c.EventDispatcher=function(){};c.EventDispatcher.prototype={constructor:c.EventDispatcher,
apply:function(a){a.addEventListener=c.EventDispatcher.prototype.addEventListener;a.hasEventListener=c.EventDispatcher.prototype.hasEventListener;a.removeEventListener=c.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=c.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;
var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var e=c.indexOf(b);-1!==e&&c.splice(e,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=[],e=b.length,f=0;f<e;f++)c[f]=b[f];for(f=0;f<e;f++)c[f].call(this,a)}}}};(function(a){function b(a,b){return a.distance-b.distance}a.Raycaster=function(b,c,d,
g){this.ray=new a.Ray(b,c);this.near=d||0;this.far=g||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})};var c=function(a,b,k,g){if(!1!==a.visible&&(a.raycast(b,k),!0===g)){a=a.children;g=0;for(var h=a.length;g<h;g++)c(a[g],b,k,!0)}};a.Raycaster.prototype={constructor:a.Raycaster,linePrecision:1,set:function(a,
b){this.ray.set(a,b)},setFromCamera:function(b,c){c instanceof a.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(b.x,b.y,.5).unproject(c).sub(this.ray.origin).normalize()):c instanceof a.OrthographicCamera?(this.ray.origin.set(b.x,b.y,-1).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,f){var k=[];c(a,this,k,f);k.sort(b);return k},intersectObjects:function(a,
f){var k=[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),k;for(var g=0,h=a.length;g<h;g++)c(a[g],this,k,f);k.sort(b);return k}}})(c);c.Object3D=function(){Object.defineProperty(this,"id",{value:c.Object3DIdCount++});this.uuid=c.Math.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=c.Object3D.DefaultUp.clone();var a=new c.Vector3,b=new c.Euler,d=new c.Quaternion,e=new c.Vector3(1,1,1);b.onChange(function(){d.setFromEuler(b,
!1)});d.onChange(function(){b.setFromQuaternion(d,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:d},scale:{enumerable:!0,value:e},modelViewMatrix:{value:new c.Matrix4},normalMatrix:{value:new c.Matrix3}});this.rotationAutoUpdate=!0;this.matrix=new c.Matrix4;this.matrixWorld=new c.Matrix4;this.matrixAutoUpdate=c.Object3D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.visible=!0;this.receiveShadow=
this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}};c.Object3D.DefaultUp=new c.Vector3(0,1,0);c.Object3D.DefaultMatrixAutoUpdate=!0;c.Object3D.prototype={constructor:c.Object3D,get eulerOrder(){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order.");return this.rotation.order},set eulerOrder(a){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order.");this.rotation.order=a},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},
set useQuaternion(a){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set renderDepth(a){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,
!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new c.Quaternion;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=new c.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new c.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=
new c.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new c.Vector3;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},translateX:function(){var a=new c.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,
b)}}(),translateY:function(){var a=new c.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new c.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new c.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new c.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),
add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this;a instanceof c.Object3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);
b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1))},getChildByName:function(a){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a)},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,e=this.children.length;c<e;c++){var f=
this.children[c].getObjectByProperty(a,b);if(void 0!==f)return f}},getWorldPosition:function(a){a=a||new c.Vector3;this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new c.Vector3,b=new c.Vector3;return function(d){d=d||new c.Quaternion;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,d,b);return d}}(),getWorldRotation:function(){var a=new c.Quaternion;return function(b){b=b||new c.Euler;this.getWorldQuaternion(a);return b.setFromQuaternion(a,
this.rotation.order,!1)}}(),getWorldScale:function(){var a=new c.Vector3,b=new c.Quaternion;return function(d){d=d||new c.Vector3;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,b,d);return d}}(),getWorldDirection:function(){var a=new c.Quaternion;return function(b){b=b||new c.Vector3;this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=this.children,c=0,e=b.length;c<e;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==
this.visible){a(this);for(var b=this.children,c=0,e=b.length;c<e;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,
this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},toJSON:function(a){function b(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var c=void 0===a,e={},f={object:e};c&&(a={geometries:{},materials:{},textures:{},images:{}},f.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);"{}"!==JSON.stringify(this.userData)&&
(e.userData=this.userData);!0!==this.visible&&(e.visible=this.visible);e.matrix=this.matrix.toArray();if(0<this.children.length){e.children=[];for(var k=0;k<this.children.length;k++)e.children.push(this.children[k].toJSON(a).object)}c&&(c=b(a.geometries),e=b(a.materials),k=b(a.textures),a=b(a.images),0<c.length&&(f.geometries=c),0<e.length&&(f.materials=e),0<k.length&&(f.textures=k),0<a.length&&(f.images=a));return f},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===
b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.rotationAutoUpdate=a.rotationAutoUpdate;this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=
JSON.parse(JSON.stringify(a.userData));if(!0===b)for(var c=0;c<a.children.length;c++)this.add(a.children[c].clone());return this}};c.EventDispatcher.prototype.apply(c.Object3D.prototype);c.Object3DIdCount=0;c.Face3=function(a,b,d,e,f,k){this.a=a;this.b=b;this.c=d;this.normal=e instanceof c.Vector3?e:new c.Vector3;this.vertexNormals=Array.isArray(e)?e:[];this.color=f instanceof c.Color?f:new c.Color;this.vertexColors=Array.isArray(f)?f:[];this.materialIndex=void 0!==k?k:0};c.Face3.prototype={constructor:c.Face3,
clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}};c.Face4=function(a,b,d,e,f,k,g){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");
return new c.Face3(a,b,d,f,k,g)};c.BufferAttribute=function(a,b){this.uuid=c.Math.generateUUID();this.array=a;this.itemSize=b;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0};c.BufferAttribute.prototype={constructor:c.BufferAttribute,get length(){console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count.");return this.array.length},get count(){return this.array.length/this.itemSize},set needsUpdate(a){!0===a&&this.version++},setDynamic:function(a){this.dynamic=
a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var e=0,f=this.itemSize;e<f;e++)this.array[a+e]=b.array[c+e];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<f;e++){var k=a[e];void 0===k&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",e),
k=new c.Color);b[d++]=k.r;b[d++]=k.g;b[d++]=k.b}return this},copyIndicesArray:function(a){for(var b=this.array,c=0,e=0,f=a.length;e<f;e++){var k=a[e];b[c++]=k.a;b[c++]=k.b;b[c++]=k.c}return this},copyVector2sArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<f;e++){var k=a[e];void 0===k&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",e),k=new c.Vector2);b[d++]=k.x;b[d++]=k.y}return this},copyVector3sArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<
f;e++){var k=a[e];void 0===k&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",e),k=new c.Vector3);b[d++]=k.x;b[d++]=k.y;b[d++]=k.z}return this},copyVector4sArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<f;e++){var k=a[e];void 0===k&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",e),k=new c.Vector4);b[d++]=k.x;b[d++]=k.y;b[d++]=k.z;b[d++]=k.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},
getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,c){a*=this.itemSize;
this.array[a+0]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,e){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=e;return this},setXYZW:function(a,b,c,e,f){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=e;this.array[a+3]=f;return this},clone:function(){return(new this.constructor).copy(this)}};c.Int8Attribute=function(a,b){return new c.BufferAttribute(new Int8Array(a),b)};c.Uint8Attribute=function(a,b){return new c.BufferAttribute(new Uint8Array(a),
b)};c.Uint8ClampedAttribute=function(a,b){return new c.BufferAttribute(new Uint8ClampedArray(a),b)};c.Int16Attribute=function(a,b){return new c.BufferAttribute(new Int16Array(a),b)};c.Uint16Attribute=function(a,b){return new c.BufferAttribute(new Uint16Array(a),b)};c.Int32Attribute=function(a,b){return new c.BufferAttribute(new Int32Array(a),b)};c.Uint32Attribute=function(a,b){return new c.BufferAttribute(new Uint32Array(a),b)};c.Float32Attribute=function(a,b){return new c.BufferAttribute(new Float32Array(a),
b)};c.Float64Attribute=function(a,b){return new c.BufferAttribute(new Float64Array(a),b)};c.DynamicBufferAttribute=function(a,b){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new c.BufferAttribute(a,b)).setDynamic(!0)};c.Geometry=function(){Object.defineProperty(this,"id",{value:c.GeometryIdCount++});this.uuid=c.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=
[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};c.Geometry.prototype={constructor:c.Geometry,applyMatrix:function(a){for(var b=(new c.Matrix3).getNormalMatrix(a),d=0,e=this.vertices.length;d<e;d++)this.vertices[d].applyMatrix4(a);
d=0;for(e=this.faces.length;d<e;d++){a=this.faces[d];a.normal.applyMatrix3(b).normalize();for(var f=0,k=a.vertexNormals.length;f<k;f++)a.vertexNormals[f].applyMatrix3(b).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=this.verticesNeedUpdate=!0},rotateX:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a;return function(b){void 0===
a&&(a=new c.Matrix4);a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Matrix4);a.makeTranslation(b,d,e);this.applyMatrix(a);return this}}(),scale:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Matrix4);a.makeScale(b,d,e);this.applyMatrix(a);return this}}(),lookAt:function(){var a;
return function(b){void 0===a&&(a=new c.Object3D);a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){var b=this,d=null!==a.index?a.index.array:void 0,e=a.attributes,f=e.position.array,k=void 0!==e.normal?e.normal.array:void 0,g=void 0!==e.color?e.color.array:void 0,h=void 0!==e.uv?e.uv.array:void 0,p=void 0!==e.uv2?e.uv2.array:void 0;void 0!==p&&(this.faceVertexUvs[1]=[]);for(var n=[],s=[],q=[],l=e=0;e<f.length;e+=3,l+=2)b.vertices.push(new c.Vector3(f[e],f[e+
1],f[e+2])),void 0!==k&&n.push(new c.Vector3(k[e],k[e+1],k[e+2])),void 0!==g&&b.colors.push(new c.Color(g[e],g[e+1],g[e+2])),void 0!==h&&s.push(new c.Vector2(h[l],h[l+1])),void 0!==p&&q.push(new c.Vector2(p[l],p[l+1]));var u=function(a,d,e){var f=void 0!==k?[n[a].clone(),n[d].clone(),n[e].clone()]:[],l=void 0!==g?[b.colors[a].clone(),b.colors[d].clone(),b.colors[e].clone()]:[],f=new c.Face3(a,d,e,f,l);b.faces.push(f);void 0!==h&&b.faceVertexUvs[0].push([s[a].clone(),s[d].clone(),s[e].clone()]);void 0!==
p&&b.faceVertexUvs[1].push([q[a].clone(),q[d].clone(),q[e].clone()])};if(void 0!==d)if(f=a.groups,0<f.length)for(e=0;e<f.length;e++)for(var l=f[e],t=l.start,r=l.count,l=t,t=t+r;l<t;l+=3)u(d[l],d[l+1],d[l+2]);else for(e=0;e<d.length;e+=3)u(d[e],d[e+1],d[e+2]);else for(e=0;e<f.length/3;e+=3)u(e,e+1,e+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();
var a=this.boundingBox.center().negate();this.translate(a.x,a.y,a.z);return a},normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius,b=0===b?1:1/b,d=new c.Matrix4;d.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1);this.applyMatrix(d);return this},computeFaceNormals:function(){for(var a=new c.Vector3,b=new c.Vector3,d=0,e=this.faces.length;d<e;d++){var f=this.faces[d],k=this.vertices[f.a],g=this.vertices[f.b];a.subVectors(this.vertices[f.c],
g);b.subVectors(k,g);a.cross(b);a.normalize();f.normal.copy(a)}},computeVertexNormals:function(a){var b,d,e;e=Array(this.vertices.length);b=0;for(d=this.vertices.length;b<d;b++)e[b]=new c.Vector3;if(a){var f,k,g,h=new c.Vector3,p=new c.Vector3;a=0;for(b=this.faces.length;a<b;a++)d=this.faces[a],f=this.vertices[d.a],k=this.vertices[d.b],g=this.vertices[d.c],h.subVectors(g,k),p.subVectors(f,k),h.cross(p),e[d.a].add(h),e[d.b].add(h),e[d.c].add(h)}else for(a=0,b=this.faces.length;a<b;a++)d=this.faces[a],
e[d.a].add(d.normal),e[d.b].add(d.normal),e[d.c].add(d.normal);b=0;for(d=this.vertices.length;b<d;b++)e[b].normalize();a=0;for(b=this.faces.length;a<b;a++)d=this.faces[a],f=d.vertexNormals,3===f.length?(f[0].copy(e[d.a]),f[1].copy(e[d.b]),f[2].copy(e[d.c])):(f[0]=e[d.a].clone(),f[1]=e[d.b].clone(),f[2]=e[d.c].clone())},computeMorphNormals:function(){var a,b,d,e,f;d=0;for(e=this.faces.length;d<e;d++)for(f=this.faces[d],f.__originalFaceNormal?f.__originalFaceNormal.copy(f.normal):f.__originalFaceNormal=
f.normal.clone(),f.__originalVertexNormals||(f.__originalVertexNormals=[]),a=0,b=f.vertexNormals.length;a<b;a++)f.__originalVertexNormals[a]?f.__originalVertexNormals[a].copy(f.vertexNormals[a]):f.__originalVertexNormals[a]=f.vertexNormals[a].clone();var k=new c.Geometry;k.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];f=this.morphNormals[a].faceNormals;var g=this.morphNormals[a].vertexNormals,
h,p;d=0;for(e=this.faces.length;d<e;d++)h=new c.Vector3,p={a:new c.Vector3,b:new c.Vector3,c:new c.Vector3},f.push(h),g.push(p)}g=this.morphNormals[a];k.vertices=this.morphTargets[a].vertices;k.computeFaceNormals();k.computeVertexNormals();d=0;for(e=this.faces.length;d<e;d++)f=this.faces[d],h=g.faceNormals[d],p=g.vertexNormals[d],h.copy(f.normal),p.a.copy(f.vertexNormals[0]),p.b.copy(f.vertexNormals[1]),p.c.copy(f.vertexNormals[2])}d=0;for(e=this.faces.length;d<e;d++)f=this.faces[d],f.normal=f.__originalFaceNormal,
f.vertexNormals=f.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,e=b.length;c<e;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new c.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new c.Sphere);
this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,d){if(!1===a instanceof c.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a);else{var e,f=this.vertices.length,k=this.vertices,g=a.vertices,h=this.faces,p=a.faces,n=this.faceVertexUvs[0];a=a.faceVertexUvs[0];void 0===d&&(d=0);void 0!==b&&(e=(new c.Matrix3).getNormalMatrix(b));for(var s=0,q=g.length;s<q;s++){var l=g[s].clone();void 0!==b&&l.applyMatrix4(b);k.push(l)}s=0;for(q=p.length;s<
q;s++){var g=p[s],u,t=g.vertexNormals,r=g.vertexColors,l=new c.Face3(g.a+f,g.b+f,g.c+f);l.normal.copy(g.normal);void 0!==e&&l.normal.applyMatrix3(e).normalize();b=0;for(k=t.length;b<k;b++)u=t[b].clone(),void 0!==e&&u.applyMatrix3(e).normalize(),l.vertexNormals.push(u);l.color.copy(g.color);b=0;for(k=r.length;b<k;b++)u=r[b],l.vertexColors.push(u.clone());l.materialIndex=g.materialIndex+d;h.push(l)}s=0;for(q=a.length;s<q;s++)if(d=a[s],e=[],void 0!==d){b=0;for(k=d.length;b<k;b++)e.push(d[b].clone());
n.push(e)}}},mergeMesh:function(a){!1===a instanceof c.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",a):(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix))},mergeVertices:function(){var a={},b=[],c=[],e,f=Math.pow(10,4),k,g;k=0;for(g=this.vertices.length;k<g;k++)e=this.vertices[k],e=Math.round(e.x*f)+"_"+Math.round(e.y*f)+"_"+Math.round(e.z*f),void 0===a[e]?(a[e]=k,b.push(this.vertices[k]),c[k]=b.length-1):c[k]=c[a[e]];a=[];k=0;for(g=this.faces.length;k<
g;k++)for(f=this.faces[k],f.a=c[f.a],f.b=c[f.b],f.c=c[f.c],f=[f.a,f.b,f.c],e=0;3>e;e++)if(f[e]===f[(e+1)%3]){a.push(k);break}for(k=a.length-1;0<=k;k--)for(f=a[k],this.faces.splice(f,1),c=0,g=this.faceVertexUvs.length;c<g;c++)this.faceVertexUvs[c].splice(f,1);k=this.vertices.length-b.length;this.vertices=b;return k},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==n[b])return n[b];n[b]=p.length/3;p.push(a.x,a.y,
a.z);return n[b]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==q[b])return q[b];q[b]=s.length;s.push(a.getHex());return q[b]}function e(a){var b=a.x.toString()+a.y.toString();if(void 0!==u[b])return u[b];u[b]=l.length/2;l.push(a.x,a.y);return u[b]}var f={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);if(void 0!==this.parameters){var k=this.parameters,g;for(g in k)void 0!==k[g]&&
(f[g]=k[g]);return f}k=[];for(g=0;g<this.vertices.length;g++){var h=this.vertices[g];k.push(h.x,h.y,h.z)}var h=[],p=[],n={},s=[],q={},l=[],u={};for(g=0;g<this.faces.length;g++){var t=this.faces[g],r=void 0!==this.faceVertexUvs[0][g],y=0<t.normal.length(),z=0<t.vertexNormals.length,w=1!==t.color.r||1!==t.color.g||1!==t.color.b,I=0<t.vertexColors.length,B=0,B=a(B,0,0),B=a(B,1,!1),B=a(B,2,!1),B=a(B,3,r),B=a(B,4,y),B=a(B,5,z),B=a(B,6,w),B=a(B,7,I);h.push(B);h.push(t.a,t.b,t.c);r&&(r=this.faceVertexUvs[0][g],
h.push(e(r[0]),e(r[1]),e(r[2])));y&&h.push(b(t.normal));z&&(y=t.vertexNormals,h.push(b(y[0]),b(y[1]),b(y[2])));w&&h.push(c(t.color));I&&(t=t.vertexColors,h.push(c(t[0]),c(t[1]),c(t[2])))}f.data={};f.data.vertices=k;f.data.normals=p;0<s.length&&(f.data.colors=s);0<l.length&&(f.data.uvs=[l]);f.data.faces=h;return f},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.vertices=[];this.faces=[];this.faceVertexUvs=[[]];for(var b=a.vertices,c=0,e=b.length;c<e;c++)this.vertices.push(b[c].clone());
b=a.faces;c=0;for(e=b.length;c<e;c++)this.faces.push(b[c].clone());c=0;for(e=a.faceVertexUvs.length;c<e;c++){b=a.faceVertexUvs[c];void 0===this.faceVertexUvs[c]&&(this.faceVertexUvs[c]=[]);for(var f=0,k=b.length;f<k;f++){for(var g=b[f],h=[],p=0,n=g.length;p<n;p++)h.push(g[p].clone());this.faceVertexUvs[c].push(h)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};c.EventDispatcher.prototype.apply(c.Geometry.prototype);c.GeometryIdCount=0;c.BufferGeometry=function(){Object.defineProperty(this,
"id",{value:c.GeometryIdCount++});this.uuid=c.Math.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity}};c.BufferGeometry.prototype={constructor:c.BufferGeometry,addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(a)},getIndex:function(){return this.index},setIndex:function(a){this.index=
a},addAttribute:function(a,b,d){!1===b instanceof c.BufferAttribute&&!1===b instanceof c.InterleavedBufferAttribute?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(a,new c.BufferAttribute(b,d))):"index"===a?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(b)):this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a]},
get drawcalls(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups},get offsets(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups},addDrawCall:function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(a,b)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");
this.clearGroups()},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToVector3Array(b.array),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new c.Matrix3).getNormalMatrix(a).applyToVector3Array(b.array),b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();
null!==this.boundingSphere&&this.computeBoundingSphere()},rotateX:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a;return function(b,d,e){void 0===
a&&(a=new c.Matrix4);a.makeTranslation(b,d,e);this.applyMatrix(a);return this}}(),scale:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Matrix4);a.makeScale(b,d,e);this.applyMatrix(a);return this}}(),lookAt:function(){var a;return function(b){void 0===a&&(a=new c.Object3D);a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.translate(a.x,a.y,a.z);return a},setFromObject:function(a){var b=
a.geometry;if(a instanceof c.Points||a instanceof c.Line){a=new c.Float32Attribute(3*b.vertices.length,3);var d=new c.Float32Attribute(3*b.colors.length,3);this.addAttribute("position",a.copyVector3sArray(b.vertices));this.addAttribute("color",d.copyColorsArray(b.colors));b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new c.Float32Attribute(b.lineDistances.length,1),this.addAttribute("lineDistance",a.copyArray(b.lineDistances)));null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone());
null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a instanceof c.Mesh&&b instanceof c.Geometry&&this.fromGeometry(b);return this},updateFromObject:function(a){var b=a.geometry;if(a instanceof c.Mesh){var d=b.__directGeometry;if(void 0===d)return this.fromGeometry(b);d.verticesNeedUpdate=b.verticesNeedUpdate;d.normalsNeedUpdate=b.normalsNeedUpdate;d.colorsNeedUpdate=b.colorsNeedUpdate;d.uvsNeedUpdate=b.uvsNeedUpdate;d.groupsNeedUpdate=b.groupsNeedUpdate;b.verticesNeedUpdate=!1;b.normalsNeedUpdate=
!1;b.colorsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.groupsNeedUpdate=!1;b=d}!0===b.verticesNeedUpdate&&(d=this.attributes.position,void 0!==d&&(d.copyVector3sArray(b.vertices),d.needsUpdate=!0),b.verticesNeedUpdate=!1);!0===b.normalsNeedUpdate&&(d=this.attributes.normal,void 0!==d&&(d.copyVector3sArray(b.normals),d.needsUpdate=!0),b.normalsNeedUpdate=!1);!0===b.colorsNeedUpdate&&(d=this.attributes.color,void 0!==d&&(d.copyColorsArray(b.colors),d.needsUpdate=!0),b.colorsNeedUpdate=!1);b.lineDistancesNeedUpdate&&
(d=this.attributes.lineDistance,void 0!==d&&(d.copyArray(b.lineDistances),d.needsUpdate=!0),b.lineDistancesNeedUpdate=!1);b.groupsNeedUpdate&&(b.computeGroups(a.geometry),this.groups=b.groups,b.groupsNeedUpdate=!1);return this},fromGeometry:function(a){a.__directGeometry=(new c.DirectGeometry).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new c.BufferAttribute(b,3)).copyVector3sArray(a.vertices));
0<a.normals.length&&(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",(new c.BufferAttribute(b,3)).copyVector3sArray(a.normals)));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",(new c.BufferAttribute(b,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new c.BufferAttribute(b,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new c.BufferAttribute(b,
2)).copyVector2sArray(a.uvs2)));0<a.indices.length&&(b=new (65535<a.vertices.length?Uint32Array:Uint16Array)(3*a.indices.length),this.setIndex((new c.BufferAttribute(b,1)).copyIndicesArray(a.indices)));this.groups=a.groups;for(var d in a.morphTargets){for(var b=[],e=a.morphTargets[d],f=0,k=e.length;f<k;f++){var g=e[f],h=new c.Float32Attribute(3*g.length,3);b.push(h.copyVector3sArray(g))}this.morphAttributes[d]=b}0<a.skinIndices.length&&(d=new c.Float32Attribute(4*a.skinIndices.length,4),this.addAttribute("skinIndex",
d.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&(d=new c.Float32Attribute(4*a.skinWeights.length,4),this.addAttribute("skinWeight",d.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){var a=new c.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new c.Box3);var b=this.attributes.position.array;if(b){var d=
this.boundingBox;d.makeEmpty();for(var e=0,f=b.length;e<f;e+=3)a.fromArray(b,e),d.expandByPoint(a)}if(void 0===b||0===b.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0);(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var a=new c.Box3,b=new c.Vector3;
return function(){null===this.boundingSphere&&(this.boundingSphere=new c.Sphere);var d=this.attributes.position.array;if(d){a.makeEmpty();for(var e=this.boundingSphere.center,f=0,g=d.length;f<g;f+=3)b.fromArray(d,f),a.expandByPoint(b);a.center(e);for(var h=0,f=0,g=d.length;f<g;f+=3)b.fromArray(d,f),h=Math.max(h,e.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(h);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',
this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,b=this.attributes,d=this.groups;if(b.position){var e=b.position.array;if(void 0===b.normal)this.addAttribute("normal",new c.BufferAttribute(new Float32Array(e.length),3));else for(var f=b.normal.array,g=0,h=f.length;g<h;g++)f[g]=0;var f=b.normal.array,p,q,n,s=new c.Vector3,v=new c.Vector3,l=new c.Vector3,u=new c.Vector3,t=new c.Vector3;if(a){a=a.array;0===d.length&&this.addGroup(0,a.length);for(var r=0,y=d.length;r<
y;++r)for(g=d[r],h=g.start,p=g.count,g=h,h+=p;g<h;g+=3)p=3*a[g+0],q=3*a[g+1],n=3*a[g+2],s.fromArray(e,p),v.fromArray(e,q),l.fromArray(e,n),u.subVectors(l,v),t.subVectors(s,v),u.cross(t),f[p]+=u.x,f[p+1]+=u.y,f[p+2]+=u.z,f[q]+=u.x,f[q+1]+=u.y,f[q+2]+=u.z,f[n]+=u.x,f[n+1]+=u.y,f[n+2]+=u.z}else for(g=0,h=e.length;g<h;g+=9)s.fromArray(e,g),v.fromArray(e,g+3),l.fromArray(e,g+6),u.subVectors(l,v),t.subVectors(s,v),u.cross(t),f[g]=u.x,f[g+1]=u.y,f[g+2]=u.z,f[g+3]=u.x,f[g+4]=u.y,f[g+5]=u.z,f[g+6]=u.x,f[g+
7]=u.y,f[g+8]=u.z;this.normalizeNormals();b.normal.needsUpdate=!0}},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(a){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},merge:function(a,b){if(!1===a instanceof c.BufferGeometry)console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a);else{void 0===b&&(b=0);var d=this.attributes,e;for(e in d)if(void 0!==a.attributes[e])for(var f=
d[e].array,g=a.attributes[e],h=g.array,p=0,g=g.itemSize*b;p<h.length;p++,g++)f[g]=h[p];return this}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,e,f=0,g=a.length;f<g;f+=3)b=a[f],c=a[f+1],e=a[f+2],b=1/Math.sqrt(b*b+c*c+e*e),a[f]*=b,a[f+1]*=b,a[f+2]*=b},toJSON:function(){var a={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);if(void 0!==this.parameters){var b=this.parameters,
c;for(c in b)void 0!==b[c]&&(a[c]=b[c]);return a}a.data={attributes:{}};var e=this.index;null!==e&&(b=Array.prototype.slice.call(e.array),a.data.index={type:e.array.constructor.name,array:b});e=this.attributes;for(c in e){var f=e[c],b=Array.prototype.slice.call(f.array);a.data.attributes[c]={itemSize:f.itemSize,type:f.array.constructor.name,array:b}}c=this.groups;0<c.length&&(a.data.groups=JSON.parse(JSON.stringify(c)));c=this.boundingSphere;null!==c&&(a.data.boundingSphere={center:c.center.toArray(),
radius:c.radius});return a},clone:function(){return(new this.constructor).copy(this)},copy:function(a){var b=a.index;null!==b&&this.setIndex(b.clone());var b=a.attributes,c;for(c in b)this.addAttribute(c,b[c].clone());a=a.groups;c=0;for(b=a.length;c<b;c++){var e=a[c];this.addGroup(e.start,e.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};c.EventDispatcher.prototype.apply(c.BufferGeometry.prototype);c.BufferGeometry.MaxIndex=65535;c.Camera=function(){c.Object3D.call(this);
this.type="Camera";this.matrixWorldInverse=new c.Matrix4;this.projectionMatrix=new c.Matrix4};c.Camera.prototype=Object.create(c.Object3D.prototype);c.Camera.prototype.constructor=c.Camera;c.Camera.prototype.getWorldDirection=function(){var a=new c.Quaternion;return function(b){b=b||new c.Vector3;this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}();c.Camera.prototype.lookAt=function(){var a=new c.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();
c.Camera.prototype.clone=function(){return(new this.constructor).copy(this)};c.Camera.prototype.copy=function(a){c.Object3D.prototype.copy.call(this,a);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);return this};c.PerspectiveCamera=function(a,b,d,e){c.Camera.call(this);this.type="PerspectiveCamera";this.zoom=1;this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==d?d:.1;this.far=void 0!==e?e:2E3;this.updateProjectionMatrix()};c.PerspectiveCamera.prototype=
Object.create(c.Camera.prototype);c.PerspectiveCamera.prototype.constructor=c.PerspectiveCamera;c.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*c.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};c.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,e,f,g){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=e;this.width=f;this.height=g;this.updateProjectionMatrix()};c.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var a=c.Math.radToDeg(2*
Math.atan(Math.tan(.5*c.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var b=this.fullWidth/this.fullHeight,a=Math.tan(c.Math.degToRad(.5*a))*this.near,d=-a,e=b*d,b=Math.abs(b*a-e),d=Math.abs(a-d);this.projectionMatrix.makeFrustum(e+this.x*b/this.fullWidth,e+(this.x+this.width)*b/this.fullWidth,a-(this.y+this.height)*d/this.fullHeight,a-this.y*d/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(a,this.aspect,this.near,this.far)};c.PerspectiveCamera.prototype.copy=
function(a){c.Camera.prototype.copy.call(this,a);this.fov=a.fov;this.aspect=a.aspect;this.near=a.near;this.far=a.far;this.zoom=a.zoom;return this};c.PerspectiveCamera.prototype.toJSON=function(a){a=c.Object3D.prototype.toJSON.call(this,a);a.object.zoom=this.zoom;a.object.fov=this.fov;a.object.aspect=this.aspect;a.object.near=this.near;a.object.far=this.far;return a};c.Light=function(a){c.Object3D.call(this);this.type="Light";this.color=new c.Color(a)};c.Light.prototype=Object.create(c.Object3D.prototype);
c.Light.prototype.constructor=c.Light;c.Light.prototype.copy=function(a){c.Object3D.prototype.copy.call(this,a);this.color.copy(a.color);return this};c.AmbientLight=function(a){c.Light.call(this,a);this.type="AmbientLight"};c.AmbientLight.prototype=Object.create(c.Light.prototype);c.AmbientLight.prototype.constructor=c.AmbientLight;c.AmbientLight.prototype.toJSON=function(a){a=c.Object3D.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();return a};c.PointLight=function(a,b,d,e){c.Light.call(this,
a);this.type="PointLight";this.intensity=void 0!==b?b:1;this.distance=void 0!==d?d:0;this.decay=void 0!==e?e:1};c.PointLight.prototype=Object.create(c.Light.prototype);c.PointLight.prototype.constructor=c.PointLight;c.PointLight.prototype.copy=function(a){c.Light.prototype.copy.call(this,a);this.intensity=a.intensity;this.distance=a.distance;this.decay=a.decay;return this};c.PointLight.prototype.toJSON=function(a){a=c.Object3D.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();a.object.intensity=
this.intensity;a.object.distance=this.distance;a.object.decay=this.decay;return a};c.DirectionalLight=function(a,b){c.Light.call(this,a);this.type="DirectionalLight";this.position.set(0,1,0);this.updateMatrix();this.target=new c.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=
0;this.shadowDarkness=.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};c.DirectionalLight.prototype=Object.create(c.Light.prototype);c.DirectionalLight.prototype.constructor=c.DirectionalLight;c.DirectionalLight.prototype.copy=function(a){c.Light.prototype.copy.call(this,a);this.intensity=a.intensity;this.target=a.target.clone();this.castShadow=a.castShadow;this.onlyShadow=a.onlyShadow;this.shadowCameraNear=a.shadowCameraNear;
this.shadowCameraFar=a.shadowCameraFar;this.shadowCameraLeft=a.shadowCameraLeft;this.shadowCameraRight=a.shadowCameraRight;this.shadowCameraTop=a.shadowCameraTop;this.shadowCameraBottom=a.shadowCameraBottom;this.shadowCameraVisible=a.shadowCameraVisible;this.shadowBias=a.shadowBias;this.shadowDarkness=a.shadowDarkness;this.shadowMapWidth=a.shadowMapWidth;this.shadowMapHeight=a.shadowMapHeight;return this};c.DirectionalLight.prototype.toJSON=function(a){a=c.Object3D.prototype.toJSON.call(this,a);a.object.color=
this.color.getHex();a.object.intensity=this.intensity;return a};c.Material=function(){Object.defineProperty(this,"id",{value:c.MaterialIdCount++});this.uuid=c.Math.generateUUID();this.name="";this.type="Material";this.side=c.FrontSide;this.opacity=1;this.transparent=!1;this.blending=c.NormalBlending;this.blendSrc=c.SrcAlphaFactor;this.blendDst=c.OneMinusSrcAlphaFactor;this.blendEquation=c.AddEquation;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=c.LessEqualDepth;
this.colorWrite=this.depthWrite=this.depthTest=!0;this.precision=null;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this._needsUpdate=this.visible=!0};c.Material.prototype={constructor:c.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},setValues:function(a){if(void 0!==a)for(var b in a){var d=a[b];if(void 0===d)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else{var e=
this[b];void 0===e?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):e instanceof c.Color?e.set(d):e instanceof c.Vector3&&d instanceof c.Vector3?e.copy(d):this[b]="overdraw"===b?Number(d):d}}},toJSON:function(a){var b={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};b.uuid=this.uuid;b.type=this.type;""!==this.name&&(b.name=this.name);this.color instanceof c.Color&&(b.color=this.color.getHex());this.emissive instanceof c.Color&&(b.emissive=this.emissive.getHex());
this.specular instanceof c.Color&&(b.specular=this.specular.getHex());void 0!==this.shininess&&(b.shininess=this.shininess);this.map instanceof c.Texture&&(b.map=this.map.toJSON(a).uuid);this.alphaMap instanceof c.Texture&&(b.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap instanceof c.Texture&&(b.lightMap=this.lightMap.toJSON(a).uuid);this.bumpMap instanceof c.Texture&&(b.bumpMap=this.bumpMap.toJSON(a).uuid,b.bumpScale=this.bumpScale);this.normalMap instanceof c.Texture&&(b.normalMap=this.normalMap.toJSON(a).uuid,
b.normalScale=this.normalScale);this.displacementMap instanceof c.Texture&&(b.displacementMap=this.displacementMap.toJSON(a).uuid,b.displacementScale=this.displacementScale,b.displacementBias=this.displacementBias);this.specularMap instanceof c.Texture&&(b.specularMap=this.specularMap.toJSON(a).uuid);this.envMap instanceof c.Texture&&(b.envMap=this.envMap.toJSON(a).uuid,b.reflectivity=this.reflectivity);void 0!==this.size&&(b.size=this.size);void 0!==this.sizeAttenuation&&(b.sizeAttenuation=this.sizeAttenuation);
void 0!==this.vertexColors&&this.vertexColors!==c.NoColors&&(b.vertexColors=this.vertexColors);void 0!==this.shading&&this.shading!==c.SmoothShading&&(b.shading=this.shading);void 0!==this.blending&&this.blending!==c.NormalBlending&&(b.blending=this.blending);void 0!==this.side&&this.side!==c.FrontSide&&(b.side=this.side);1>this.opacity&&(b.opacity=this.opacity);!0===this.transparent&&(b.transparent=this.transparent);0<this.alphaTest&&(b.alphaTest=this.alphaTest);!0===this.wireframe&&(b.wireframe=
this.wireframe);1<this.wireframeLinewidth&&(b.wireframeLinewidth=this.wireframeLinewidth);return b},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.side=a.side;this.opacity=a.opacity;this.transparent=a.transparent;this.blending=a.blending;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=
a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.precision=a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.alphaTest=a.alphaTest;this.overdraw=a.overdraw;this.visible=a.visible;return this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})},get wrapAround(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},
set wrapAround(a){console.warn("THREE."+this.type+": .wrapAround has been removed.")},get wrapRGB(){console.warn("THREE."+this.type+": .wrapRGB has been removed.");return new c.Color}};c.EventDispatcher.prototype.apply(c.Material.prototype);c.MaterialIdCount=0;c.LineBasicMaterial=function(a){c.Material.call(this);this.type="LineBasicMaterial";this.color=new c.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=c.NoColors;this.fog=!0;this.setValues(a)};c.LineBasicMaterial.prototype=
Object.create(c.Material.prototype);c.LineBasicMaterial.prototype.constructor=c.LineBasicMaterial;c.LineBasicMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;this.vertexColors=a.vertexColors;this.fog=a.fog;return this};c.MeshBasicMaterial=function(a){c.Material.call(this);this.type="MeshBasicMaterial";this.color=new c.Color(16777215);this.aoMap=this.map=null;this.aoMapIntensity=
1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=c.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=c.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=c.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};c.MeshBasicMaterial.prototype=Object.create(c.Material.prototype);c.MeshBasicMaterial.prototype.constructor=c.MeshBasicMaterial;c.MeshBasicMaterial.prototype.copy=
function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;
this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;return this};c.MeshLambertMaterial=function(a){c.Material.call(this);this.type="MeshLambertMaterial";this.color=new c.Color(16777215);this.emissive=new c.Color(0);this.envMap=this.alphaMap=this.specularMap=this.map=null;this.combine=c.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=
c.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};c.MeshLambertMaterial.prototype=Object.create(c.Material.prototype);c.MeshLambertMaterial.prototype.constructor=c.MeshLambertMaterial;c.MeshLambertMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.emissive.copy(a.emissive);this.map=a.map;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;
this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};c.MultiMaterial=function(a){this.uuid=c.Math.generateUUID();this.type="MultiMaterial";this.materials=a instanceof Array?a:[];this.visible=!0};c.MultiMaterial.prototype=
{constructor:c.MultiMaterial,toJSON:function(){for(var a={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},b=0,c=this.materials.length;b<c;b++)a.materials.push(this.materials[b].toJSON());a.visible=this.visible;return a},clone:function(){for(var a=new this.constructor,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());a.visible=this.visible;return a}};c.MeshFaceMaterial=c.MultiMaterial;c.MeshPhongMaterial=function(a){c.Material.call(this);
this.type="MeshPhongMaterial";this.color=new c.Color(16777215);this.emissive=new c.Color(0);this.specular=new c.Color(1118481);this.shininess=30;this.metal=!1;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new c.Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=c.MultiplyOperation;
this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=c.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=c.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};c.MeshPhongMaterial.prototype=Object.create(c.Material.prototype);c.MeshPhongMaterial.prototype.constructor=c.MeshPhongMaterial;c.MeshPhongMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);
this.emissive.copy(a.emissive);this.specular.copy(a.specular);this.shininess=a.shininess;this.metal=a.metal;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissiveMap=a.emissiveMap;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;
this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};
c.MeshDepthMaterial=function(a){c.Material.call(this);this.type="MeshDepthMaterial";this.wireframe=this.morphTargets=!1;this.wireframeLinewidth=1;this.setValues(a)};c.MeshDepthMaterial.prototype=Object.create(c.Material.prototype);c.MeshDepthMaterial.prototype.constructor=c.MeshDepthMaterial;c.MeshDepthMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};c.MeshNormalMaterial=function(a){c.Material.call(this,
a);this.type="MeshNormalMaterial";this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};c.MeshNormalMaterial.prototype=Object.create(c.Material.prototype);c.MeshNormalMaterial.prototype.constructor=c.MeshNormalMaterial;c.MeshNormalMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};c.SpriteMaterial=function(a){c.Material.call(this);this.type="SpriteMaterial";this.color=
new c.Color(16777215);this.map=null;this.rotation=0;this.fog=!1;this.setValues(a)};c.SpriteMaterial.prototype=Object.create(c.Material.prototype);c.SpriteMaterial.prototype.constructor=c.SpriteMaterial;c.SpriteMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.rotation=a.rotation;this.fog=a.fog;return this};c.Texture=function(a,b,d,e,f,g,h,p,q){Object.defineProperty(this,"id",{value:c.TextureIdCount++});this.uuid=c.Math.generateUUID();
this.sourceFile=this.name="";this.image=void 0!==a?a:c.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:c.Texture.DEFAULT_MAPPING;this.wrapS=void 0!==d?d:c.ClampToEdgeWrapping;this.wrapT=void 0!==e?e:c.ClampToEdgeWrapping;this.magFilter=void 0!==f?f:c.LinearFilter;this.minFilter=void 0!==g?g:c.LinearMipMapLinearFilter;this.anisotropy=void 0!==q?q:1;this.format=void 0!==h?h:c.RGBAFormat;this.type=void 0!==p?p:c.UnsignedByteType;this.offset=new c.Vector2(0,0);this.repeat=new c.Vector2(1,
1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.version=0;this.onUpdate=null};c.Texture.DEFAULT_IMAGE=void 0;c.Texture.DEFAULT_MAPPING=c.UVMapping;c.Texture.prototype={constructor:c.Texture,set needsUpdate(a){!0===a&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.image=a.image;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=
a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;return this},toJSON:function(a){if(void 0!==a.textures[this.uuid])return a.textures[this.uuid];var b={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,
this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var d=this.image;void 0===d.uuid&&(d.uuid=c.Math.generateUUID());if(void 0===a.images[d.uuid]){var e=a.images,f=d.uuid,g=d.uuid,h;void 0!==d.toDataURL?h=d:(h=document.createElement("canvas"),h.width=d.width,h.height=d.height,h.getContext("2d").drawImage(d,0,0,d.width,d.height));h=2048<h.width||2048<h.height?h.toDataURL("image/jpeg",
.6):h.toDataURL("image/png");e[f]={uuid:g,url:h}}b.image=d.uuid}return a.textures[this.uuid]=b},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(this.mapping===c.UVMapping){a.multiply(this.repeat);a.add(this.offset);if(0>a.x||1<a.x)switch(this.wrapS){case c.RepeatWrapping:a.x-=Math.floor(a.x);break;case c.ClampToEdgeWrapping:a.x=0>a.x?0:1;break;case c.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x-=Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case c.RepeatWrapping:a.y-=
Math.floor(a.y);break;case c.ClampToEdgeWrapping:a.y=0>a.y?0:1;break;case c.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y-=Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}}};c.EventDispatcher.prototype.apply(c.Texture.prototype);c.TextureIdCount=0;c.CompressedTexture=function(a,b,d,e,f,g,h,p,q,n,s){c.Texture.call(this,null,g,h,p,q,n,e,f,s);this.image={width:b,height:d};this.mipmaps=a;this.generateMipmaps=this.flipY=!1};c.CompressedTexture.prototype=Object.create(c.Texture.prototype);
c.CompressedTexture.prototype.constructor=c.CompressedTexture;c.DataTexture=function(a,b,d,e,f,g,h,p,q,n,s){c.Texture.call(this,null,g,h,p,q,n,e,f,s);this.image={data:a,width:b,height:d};this.magFilter=void 0!==q?q:c.NearestFilter;this.minFilter=void 0!==n?n:c.NearestFilter;this.generateMipmaps=this.flipY=!1};c.DataTexture.prototype=Object.create(c.Texture.prototype);c.DataTexture.prototype.constructor=c.DataTexture;c.Line=function(a,b,d){if(1===d)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),
new c.LineSegments(a,b);c.Object3D.call(this);this.type="Line";this.geometry=void 0!==a?a:new c.Geometry;this.material=void 0!==b?b:new c.LineBasicMaterial({color:16777215*Math.random()})};c.Line.prototype=Object.create(c.Object3D.prototype);c.Line.prototype.constructor=c.Line;c.Line.prototype.raycast=function(){var a=new c.Matrix4,b=new c.Ray,d=new c.Sphere;return function(e,f){var g=e.linePrecision,g=g*g,h=this.geometry;null===h.boundingSphere&&h.computeBoundingSphere();d.copy(h.boundingSphere);
d.applyMatrix4(this.matrixWorld);if(!1!==e.ray.isIntersectionSphere(d)){a.getInverse(this.matrixWorld);b.copy(e.ray).applyMatrix4(a);var p=new c.Vector3,q=new c.Vector3,n=new c.Vector3,s=new c.Vector3,v=this instanceof c.LineSegments?2:1;if(h instanceof c.BufferGeometry){var l=h.index,u=h.attributes;if(null!==l)for(var h=l.array,u=u.position.array,l=0,t=h.length-1;l<t;l+=v){var r=h[l+1];p.fromArray(u,3*h[l]);q.fromArray(u,3*r);r=b.distanceSqToSegment(p,q,s,n);r>g||(s.applyMatrix4(this.matrixWorld),
r=e.ray.origin.distanceTo(s),r<e.near||r>e.far||f.push({distance:r,point:n.clone().applyMatrix4(this.matrixWorld),index:l,face:null,faceIndex:null,object:this}))}else for(u=u.position.array,l=0,t=u.length/3-1;l<t;l+=v)p.fromArray(u,3*l),q.fromArray(u,3*l+3),r=b.distanceSqToSegment(p,q,s,n),r>g||(s.applyMatrix4(this.matrixWorld),r=e.ray.origin.distanceTo(s),r<e.near||r>e.far||f.push({distance:r,point:n.clone().applyMatrix4(this.matrixWorld),index:l,face:null,faceIndex:null,object:this}))}else if(h instanceof
c.Geometry)for(p=h.vertices,q=p.length,l=0;l<q-1;l+=v)r=b.distanceSqToSegment(p[l],p[l+1],s,n),r>g||(s.applyMatrix4(this.matrixWorld),r=e.ray.origin.distanceTo(s),r<e.near||r>e.far||f.push({distance:r,point:n.clone().applyMatrix4(this.matrixWorld),index:l,face:null,faceIndex:null,object:this}))}}}();c.Line.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};c.Line.prototype.toJSON=function(a){var b=c.Object3D.prototype.toJSON.call(this,a);void 0===a.geometries[this.geometry.uuid]&&
(a.geometries[this.geometry.uuid]=this.geometry.toJSON());void 0===a.materials[this.material.uuid]&&(a.materials[this.material.uuid]=this.material.toJSON());b.object.geometry=this.geometry.uuid;b.object.material=this.material.uuid;return b};c.LineStrip=0;c.LinePieces=1;c.LineSegments=function(a,b){c.Line.call(this,a,b);this.type="LineSegments"};c.LineSegments.prototype=Object.create(c.Line.prototype);c.LineSegments.prototype.constructor=c.LineSegments;c.Mesh=function(a,b){c.Object3D.call(this);this.type=
"Mesh";this.geometry=void 0!==a?a:new c.Geometry;this.material=void 0!==b?b:new c.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};c.Mesh.prototype=Object.create(c.Object3D.prototype);c.Mesh.prototype.constructor=c.Mesh;c.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<
b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};c.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};c.Mesh.prototype.raycast=function(){function a(a,b,d,e,f,g,h){c.Triangle.barycoordFromPoint(a,b,d,e,u);f.multiplyScalar(u.x);g.multiplyScalar(u.y);
h.multiplyScalar(u.z);f.add(g).add(h);return f.clone()}var b=new c.Matrix4,d=new c.Ray,e=new c.Sphere,f=new c.Vector3,g=new c.Vector3,h=new c.Vector3,p=new c.Vector3,q=new c.Vector3,n=new c.Vector3,s=new c.Vector2,v=new c.Vector2,l=new c.Vector2,u=new c.Vector3,t=new c.Vector3,r=new c.Vector3;return function(u,z){var w=this.geometry,I=this.material;if(void 0!==I&&(null===w.boundingSphere&&w.computeBoundingSphere(),e.copy(w.boundingSphere),e.applyMatrix4(this.matrixWorld),!1!==u.ray.isIntersectionSphere(e)&&
(b.getInverse(this.matrixWorld),d.copy(u.ray).applyMatrix4(b),null===w.boundingBox||!1!==d.isIntersectionBox(w.boundingBox)))){var B,E,K;if(w instanceof c.BufferGeometry)if(B=w.index,w=w.attributes,null!==B)for(var H=B.array,F=w.position.array,D=0,V=H.length;D<V;D+=3){B=H[D];E=H[D+1];K=H[D+2];f.fromArray(F,3*B);g.fromArray(F,3*E);h.fromArray(F,3*K);if(I.side===c.BackSide){if(null===d.intersectTriangle(h,g,f,!0,t))continue}else if(null===d.intersectTriangle(f,g,h,I.side!==c.DoubleSide,t))continue;
r.copy(t);r.applyMatrix4(this.matrixWorld);var L=u.ray.origin.distanceTo(r);if(!(L<u.near||L>u.far)){var P;void 0!==w.uv&&(P=w.uv.array,s.fromArray(P,2*B),v.fromArray(P,2*E),l.fromArray(P,2*K),P=a(t,f,g,h,s,v,l));z.push({distance:L,point:r.clone(),uv:P,face:new c.Face3(B,E,K,c.Triangle.normal(f,g,h)),faceIndex:Math.floor(D/3),object:this})}}else for(F=w.position.array,D=0,V=F.length;D<V;D+=9){f.fromArray(F,D);g.fromArray(F,D+3);h.fromArray(F,D+6);if(I.side===c.BackSide){if(null===d.intersectTriangle(h,
g,f,!0,t))continue}else if(null===d.intersectTriangle(f,g,h,I.side!==c.DoubleSide,t))continue;r.copy(t);r.applyMatrix4(this.matrixWorld);L=u.ray.origin.distanceTo(r);L<u.near||L>u.far||(void 0!==w.uv&&(P=w.uv.array,s.fromArray(P,D),v.fromArray(P,D+2),l.fromArray(P,D+4),P=a(t,f,g,h,s,v,l)),B=D/3,E=B+1,K=B+2,z.push({distance:L,point:r.clone(),uv:P,face:new c.Face3(B,E,K,c.Triangle.normal(f,g,h)),index:B,object:this}))}else if(w instanceof c.Geometry)for(var H=I instanceof c.MeshFaceMaterial,F=!0===
H?I.materials:null,D=w.vertices,V=w.faces,G=0,C=V.length;G<C;G++){var J=V[G],L=!0===H?F[J.materialIndex]:I;if(void 0!==L){B=D[J.a];E=D[J.b];K=D[J.c];if(!0===L.morphTargets){var M=w.morphTargets,U=this.morphTargetInfluences;f.set(0,0,0);g.set(0,0,0);h.set(0,0,0);for(var X=0,Z=M.length;X<Z;X++){var O=U[X];if(0!==O){var Q=M[X].vertices;f.addScaledVector(p.subVectors(Q[J.a],B),O);g.addScaledVector(q.subVectors(Q[J.b],E),O);h.addScaledVector(n.subVectors(Q[J.c],K),O)}}f.add(B);g.add(E);h.add(K);B=f;E=
g;K=h}if(L.side===c.BackSide){if(null===d.intersectTriangle(K,E,B,!0,t))continue}else if(null===d.intersectTriangle(B,E,K,L.side!==c.DoubleSide,t))continue;r.copy(t);r.applyMatrix4(this.matrixWorld);L=u.ray.origin.distanceTo(r);L<u.near||L>u.far||(0<w.faceVertexUvs[0].length&&(P=w.faceVertexUvs[0][G],s.copy(P[0]),v.copy(P[1]),l.copy(P[2]),P=a(t,B,E,K,s,v,l)),z.push({distance:L,point:r.clone(),uv:P,face:J,faceIndex:G,object:this}))}}}}}();c.Mesh.prototype.clone=function(){return(new this.constructor(this.geometry,
this.material)).copy(this)};c.Mesh.prototype.toJSON=function(a){var b=c.Object3D.prototype.toJSON.call(this,a);void 0===a.geometries[this.geometry.uuid]&&(a.geometries[this.geometry.uuid]=this.geometry.toJSON(a));void 0===a.materials[this.material.uuid]&&(a.materials[this.material.uuid]=this.material.toJSON(a));b.object.geometry=this.geometry.uuid;b.object.material=this.material.uuid;return b};c.Sprite=function(){var a=new Uint16Array([0,1,2,0,2,3]),b=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,
-.5,.5,0]),d=new Float32Array([0,0,1,0,1,1,0,1]),e=new c.BufferGeometry;e.setIndex(new c.BufferAttribute(a,1));e.addAttribute("position",new c.BufferAttribute(b,3));e.addAttribute("uv",new c.BufferAttribute(d,2));return function(a){c.Object3D.call(this);this.type="Sprite";this.geometry=e;this.material=void 0!==a?a:new c.SpriteMaterial}}();c.Sprite.prototype=Object.create(c.Object3D.prototype);c.Sprite.prototype.constructor=c.Sprite;c.Sprite.prototype.raycast=function(){var a=new c.Vector3;return function(b,
c){a.setFromMatrixPosition(this.matrixWorld);var e=b.ray.distanceSqToPoint(a);e>this.scale.x*this.scale.y||c.push({distance:Math.sqrt(e),point:this.position,face:null,object:this})}}();c.Sprite.prototype.clone=function(){return(new this.constructor(this.material)).copy(this)};c.Sprite.prototype.toJSON=function(a){var b=c.Object3D.prototype.toJSON.call(this,a);void 0===a.materials[this.material.uuid]&&(a.materials[this.material.uuid]=this.material.toJSON());b.object.material=this.material.uuid;return b};
c.Particle=c.Sprite;c.Scene=function(){c.Object3D.call(this);this.type="Scene";this.overrideMaterial=this.fog=null;this.autoUpdate=!0};c.Scene.prototype=Object.create(c.Object3D.prototype);c.Scene.prototype.constructor=c.Scene;c.Scene.prototype.copy=function(a){c.Object3D.prototype.copy.call(this,a);null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this};
c.RenderableObject=function(){this.id=0;this.object=null;this.renderOrder=this.z=0};c.RenderableFace=function(){this.id=0;this.v1=new c.RenderableVertex;this.v2=new c.RenderableVertex;this.v3=new c.RenderableVertex;this.normalModel=new c.Vector3;this.vertexNormalsModel=[new c.Vector3,new c.Vector3,new c.Vector3];this.vertexNormalsLength=0;this.color=new c.Color;this.material=null;this.uvs=[new c.Vector2,new c.Vector2,new c.Vector2];this.renderOrder=this.z=0};c.RenderableVertex=function(){this.position=
new c.Vector3;this.positionWorld=new c.Vector3;this.positionScreen=new c.Vector4;this.visible=!0};c.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};c.RenderableLine=function(){this.id=0;this.v1=new c.RenderableVertex;this.v2=new c.RenderableVertex;this.vertexColors=[new c.Color,new c.Color];this.material=null;this.renderOrder=this.z=0};c.RenderableSprite=function(){this.id=0;this.object=null;this.rotation=this.z=this.y=
this.x=0;this.scale=new c.Vector2;this.material=null;this.renderOrder=0};c.Projector=function(){function a(){if(v===u){var a=new c.RenderableVertex;l.push(a);u++;v++;return a}return l[v++]}function b(){if(r===z){var a=new c.RenderableFace;y.push(a);z++;r++;return a}return y[r++]}function d(){if(I===E){var a=new c.RenderableLine;B.push(a);E++;I++;return a}return B[I++]}function e(){if(H===D){var a=new c.RenderableSprite;F.push(a);D++;H++;return a}return F[H++]}function f(a,b){return a.renderOrder!==
b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function g(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,h=-a.z+a.w,k=-b.z+b.w;if(0<=e&&0<=f&&0<=h&&0<=k)return!0;if(0>e&&0>f||0>h&&0>k)return!1;0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f)));0>h?c=Math.max(c,h/(h-k)):0>k&&(d=Math.min(d,h/(h-k)));if(d<c)return!1;a.lerp(b,c);b.lerp(a,1-d);return!0}var h,p,q=[],n=0,s,v,l=[],u=0,t,r,y=[],z=0,w,I,B=[],E=0,K,H,F=[],D=0,V={objects:[],lights:[],elements:[]},L=new c.Vector3,
P=new c.Vector4,G=new c.Box3(new c.Vector3(-1,-1,-1),new c.Vector3(1,1,1)),C=new c.Box3,J=Array(3),M=new c.Matrix4,U=new c.Matrix4,X,Z=new c.Matrix4,O=new c.Matrix3,Q=new c.Frustum,R=new c.Vector4,ja=new c.Vector4;this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};
var ca=new function(){var e=[],f=[],g=null,h=null,k=new c.Matrix3,m=function(a){var b=a.positionWorld,c=a.positionScreen;b.copy(a.position).applyMatrix4(X);c.copy(b).applyMatrix4(U);b=1/c.w;c.x*=b;c.y*=b;c.z*=b;a.visible=-1<=c.x&&1>=c.x&&-1<=c.y&&1>=c.y&&-1<=c.z&&1>=c.z},n=function(a,b,c){if(!0===a.visible||!0===b.visible||!0===c.visible)return!0;J[0]=a.positionScreen;J[1]=b.positionScreen;J[2]=c.positionScreen;return G.isIntersectionBox(C.setFromPoints(J))},p=function(a,b,c){return 0>(c.positionScreen.x-
a.positionScreen.x)*(b.positionScreen.y-a.positionScreen.y)-(c.positionScreen.y-a.positionScreen.y)*(b.positionScreen.x-a.positionScreen.x)};return{setObject:function(a){g=a;h=g.material;k.getNormalMatrix(g.matrixWorld);e.length=0;f.length=0},projectVertex:m,checkTriangleVisibility:n,checkBackfaceCulling:p,pushVertex:function(b,c,d){s=a();s.position.set(b,c,d);m(s)},pushNormal:function(a,b,c){e.push(a,b,c)},pushUv:function(a,b){f.push(a,b)},pushLine:function(a,b){var c=l[a],e=l[b];w=d();w.id=g.id;
w.v1.copy(c);w.v2.copy(e);w.z=(c.positionScreen.z+e.positionScreen.z)/2;w.renderOrder=g.renderOrder;w.material=g.material;V.elements.push(w)},pushTriangle:function(a,d,m){var q=l[a],r=l[d],s=l[m];if(!1!==n(q,r,s)&&(h.side===c.DoubleSide||!0===p(q,r,s))){t=b();t.id=g.id;t.v1.copy(q);t.v2.copy(r);t.v3.copy(s);t.z=(q.positionScreen.z+r.positionScreen.z+s.positionScreen.z)/3;t.renderOrder=g.renderOrder;t.normalModel.fromArray(e,3*a);t.normalModel.applyMatrix3(k).normalize();for(q=0;3>q;q++)r=t.vertexNormalsModel[q],
r.fromArray(e,3*arguments[q]),r.applyMatrix3(k).normalize(),t.uvs[q].fromArray(f,2*arguments[q]);t.vertexNormalsLength=3;t.material=g.material;V.elements.push(t)}}}};this.projectScene=function(s,u,y,B){H=I=r=0;V.elements.length=0;!0===s.autoUpdate&&s.updateMatrixWorld();null===u.parent&&u.updateMatrixWorld();M.copy(u.matrixWorldInverse.getInverse(u.matrixWorld));U.multiplyMatrices(u.projectionMatrix,M);Q.setFromMatrix(U);p=0;V.objects.length=0;V.lights.length=0;s.traverseVisible(function(a){if(a instanceof
c.Light)V.lights.push(a);else if((a instanceof c.Mesh||a instanceof c.Line||a instanceof c.Sprite)&&!1!==a.material.visible&&(!1===a.frustumCulled||!0===Q.intersectsObject(a))){if(p===n){var b=new c.RenderableObject;q.push(b);n++;p++;h=b}else h=q[p++];h.id=a.id;h.object=a;L.setFromMatrixPosition(a.matrixWorld);L.applyProjection(U);h.z=L.z;h.renderOrder=a.renderOrder;V.objects.push(h)}});!0===y&&V.objects.sort(f);s=0;for(y=V.objects.length;s<y;s++){var z=V.objects[s].object,C=z.geometry;ca.setObject(z);
X=z.matrixWorld;v=0;if(z instanceof c.Mesh)if(C instanceof c.BufferGeometry){var E=C.attributes,z=C.groups;if(void 0!==E.position){for(var D=E.position.array,N=0,F=D.length;N<F;N+=3)ca.pushVertex(D[N],D[N+1],D[N+2]);if(void 0!==E.normal)for(var G=E.normal.array,N=0,F=G.length;N<F;N+=3)ca.pushNormal(G[N],G[N+1],G[N+2]);if(void 0!==E.uv)for(E=E.uv.array,N=0,F=E.length;N<F;N+=2)ca.pushUv(E[N],E[N+1]);if(null!==C.index)if(D=C.index.array,0<z.length)for(s=0;s<z.length;s++)for(F=z[s],N=F.start,F=F.start+
F.count;N<F;N+=3)ca.pushTriangle(D[N],D[N+1],D[N+2]);else for(N=0,F=D.length;N<F;N+=3)ca.pushTriangle(D[N],D[N+1],D[N+2]);else for(N=0,F=D.length/3;N<F;N+=3)ca.pushTriangle(N,N+1,N+2)}}else{if(C instanceof c.Geometry){var J=C.vertices,N=C.faces,F=C.faceVertexUvs[0];O.getNormalMatrix(X);for(var D=z.material,E=D instanceof c.MeshFaceMaterial,G=!0===E?z.material:null,ia=0,S=J.length;ia<S;ia++){var ea=J[ia];L.copy(ea);if(!0===D.morphTargets)for(var ka=C.morphTargets,W=z.morphTargetInfluences,Y=0,Aa=ka.length;Y<
Aa;Y++){var qa=W[Y];if(0!==qa){var da=ka[Y].vertices[ia];L.x+=(da.x-ea.x)*qa;L.y+=(da.y-ea.y)*qa;L.z+=(da.z-ea.z)*qa}}ca.pushVertex(L.x,L.y,L.z)}J=0;for(ia=N.length;J<ia;J++)if(S=N[J],D=!0===E?G.materials[S.materialIndex]:z.material,void 0!==D&&(W=D.side,C=l[S.a],ea=l[S.b],ka=l[S.c],!1!==ca.checkTriangleVisibility(C,ea,ka))){Y=ca.checkBackfaceCulling(C,ea,ka);if(W!==c.DoubleSide){if(W===c.FrontSide&&!1===Y)continue;if(W===c.BackSide&&!0===Y)continue}t=b();t.id=z.id;t.v1.copy(C);t.v2.copy(ea);t.v3.copy(ka);
t.normalModel.copy(S.normal);!1!==Y||W!==c.BackSide&&W!==c.DoubleSide||t.normalModel.negate();t.normalModel.applyMatrix3(O).normalize();Aa=S.vertexNormals;qa=0;for(da=Math.min(Aa.length,3);qa<da;qa++){var aa=t.vertexNormalsModel[qa];aa.copy(Aa[qa]);!1!==Y||W!==c.BackSide&&W!==c.DoubleSide||aa.negate();aa.applyMatrix3(O).normalize()}t.vertexNormalsLength=Aa.length;W=F[J];if(void 0!==W)for(Y=0;3>Y;Y++)t.uvs[Y].copy(W[Y]);t.color=S.color;t.material=D;t.z=(C.positionScreen.z+ea.positionScreen.z+ka.positionScreen.z)/
3;t.renderOrder=z.renderOrder;V.elements.push(t)}}}else if(z instanceof c.Line)if(C instanceof c.BufferGeometry){if(E=C.attributes,void 0!==E.position){D=E.position.array;N=0;for(F=D.length;N<F;N+=3)ca.pushVertex(D[N],D[N+1],D[N+2]);if(null!==C.index)for(D=C.index.array,N=0,F=D.length;N<F;N+=2)ca.pushLine(D[N],D[N+1]);else for(E=z instanceof c.LineSegments?2:1,N=0,F=D.length/3-1;N<F;N+=E)ca.pushLine(N,N+1)}}else{if(C instanceof c.Geometry&&(Z.multiplyMatrices(U,X),J=z.geometry.vertices,0!==J.length))for(C=
a(),C.positionScreen.copy(J[0]).applyMatrix4(Z),E=z instanceof c.LineSegments?2:1,ia=1,S=J.length;ia<S;ia++)C=a(),C.positionScreen.copy(J[ia]).applyMatrix4(Z),0<(ia+1)%E||(ea=l[v-2],R.copy(C.positionScreen),ja.copy(ea.positionScreen),!0===g(R,ja)&&(R.multiplyScalar(1/R.w),ja.multiplyScalar(1/ja.w),w=d(),w.id=z.id,w.v1.positionScreen.copy(R),w.v2.positionScreen.copy(ja),w.z=Math.max(R.z,ja.z),w.renderOrder=z.renderOrder,w.material=z.material,z.material.vertexColors===c.VertexColors&&(w.vertexColors[0].copy(z.geometry.colors[ia]),
w.vertexColors[1].copy(z.geometry.colors[ia-1])),V.elements.push(w)))}else z instanceof c.Sprite&&(P.set(X.elements[12],X.elements[13],X.elements[14],1),P.applyMatrix4(U),N=1/P.w,P.z*=N,-1<=P.z&&1>=P.z&&(K=e(),K.id=z.id,K.x=P.x*N,K.y=P.y*N,K.z=P.z,K.renderOrder=z.renderOrder,K.object=z,K.rotation=z.rotation,K.scale.x=z.scale.x*Math.abs(K.x-(P.x+u.projectionMatrix.elements[0])/(P.w+u.projectionMatrix.elements[12])),K.scale.y=z.scale.y*Math.abs(K.y-(P.y+u.projectionMatrix.elements[5])/(P.w+u.projectionMatrix.elements[13])),
K.material=z.material,V.elements.push(K)))}!0===B&&V.elements.sort(f);return V}};c.SpriteCanvasMaterial=function(a){c.Material.call(this);this.type="SpriteCanvasMaterial";this.color=new c.Color(16777215);this.program=function(a,c){};this.setValues(a)};c.SpriteCanvasMaterial.prototype=Object.create(c.Material.prototype);c.SpriteCanvasMaterial.prototype.constructor=c.SpriteCanvasMaterial;c.SpriteCanvasMaterial.prototype.clone=function(){var a=new c.SpriteCanvasMaterial;a.copy(this);a.color.copy(this.color);
a.program=this.program;return a};c.CanvasRenderer=function(a){function b(a,b,c,d){q(b);n(c);s(d);v(a.getStyle());C.stroke();oa.expandByScalar(2*b)}function d(a){l(a.getStyle());C.fill()}function e(a){if(0===a.version||a instanceof c.CompressedTexture||a instanceof c.DataTexture)return{canvas:void 0,version:a.version};var b=a.image,d=document.createElement("canvas");d.width=b.width;d.height=b.height;var e=d.getContext("2d");e.setTransform(1,0,0,-1,0,b.height);e.drawImage(b,0,0);var b=a.wrapS===c.RepeatWrapping,
e=a.wrapT===c.RepeatWrapping,f="no-repeat";!0===b&&!0===e?f="repeat":!0===b?f="repeat-x":!0===e&&(f="repeat-y");return{canvas:C.createPattern(d,f),version:a.version}}function f(a,b,c,d,f,g,h,k,m,n,p,q,r){var s=ea[r.id];if(void 0===s||s.version!==r.version)s=e(r),ea[r.id]=s;if(void 0!==s.canvas){l(s.canvas);var s=r.offset.x/r.repeat.x,t=r.offset.y/r.repeat.y,x=r.image.width*r.repeat.x;r=r.image.height*r.repeat.y;h=(h+s)*x;k=(k+t)*r;c-=a;d-=b;f-=a;g-=b;m=(m+s)*x-h;n=(n+t)*r-k;p=(p+s)*x-h;q=(q+t)*r-
k;r=m*q-p*n;0!==r&&(s=1/r,r=(q*c-n*f)*s,n=(q*d-n*g)*s,c=(m*f-p*c)*s,d=(m*g-p*d)*s,a=a-r*h-c*k,b=b-n*h-d*k,C.save(),C.transform(r,n,c,d,a,b),C.fill(),C.restore())}else l("rgba( 0, 0, 0, 1)"),C.fill()}function g(a,b,c){var d=b.x-a.x,e=b.y-a.y,f=d*d+e*e;0!==f&&(c/=Math.sqrt(f),d*=c,e*=c,b.x+=d,b.y+=e,a.x-=d,a.y-=e)}function h(a){U!==a&&(U=C.globalAlpha=a)}function p(a){X!==a&&(a===c.NormalBlending?C.globalCompositeOperation="source-over":a===c.AdditiveBlending?C.globalCompositeOperation="lighter":a===
c.SubtractiveBlending&&(C.globalCompositeOperation="darker"),X=a)}function q(a){R!==a&&(R=C.lineWidth=a)}function n(a){sa!==a&&(sa=C.lineCap=a)}function s(a){ja!==a&&(ja=C.lineJoin=a)}function v(a){O!==a&&(O=C.strokeStyle=a)}function l(a){Q!==a&&(Q=C.fillStyle=a)}function u(a){ca.length!==a.length&&(C.setLineDash(a),ca=a)}console.log("THREE.CanvasRenderer",c.REVISION);var t=c.Math.smoothstep;a=a||{};var r=this,y,z,w,I=new c.Projector,B=void 0!==a.canvas?a.canvas:document.createElement("canvas"),E=
B.width,K=B.height,H=Math.floor(E/2),F=Math.floor(K/2),D=0,V=0,L=E,P=K,G=1,C=B.getContext("2d",{alpha:!0===a.alpha}),J=new c.Color(0),M=!0===a.alpha?0:1,U=1,X=0,O=null,Q=null,R=null,sa=null,ja=null,ca=[],Ia,ba,fa,ma;new c.RenderableVertex;new c.RenderableVertex;var va,na,Ca,ya,N,Da,ga=new c.Color;new c.Color;new c.Color;new c.Color;new c.Color;var za=new c.Color,ia=new c.Color,S=new c.Color,ea={},ka,W,Y,Aa,qa,da,aa,pa=new c.Box2,$=new c.Box2,oa=new c.Box2,Ba=new c.Color,Na=new c.Color,Ea=new c.Color,
Oa=new c.Vector3,Pa=new c.Vector3,la=new c.Vector3,Fa=new c.Matrix3;void 0===C.setLineDash&&(C.setLineDash=function(){});this.domElement=B;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.getContext=function(){return C};this.getContextAttributes=function(){return C.getContextAttributes()};this.getPixelRatio=function(){return G};this.setPixelRatio=function(a){void 0!==a&&(G=a)};
this.setSize=function(a,b,c){E=a*G;K=b*G;B.width=E;B.height=K;H=Math.floor(E/2);F=Math.floor(K/2);!1!==c&&(B.style.width=a+"px",B.style.height=b+"px");pa.min.set(-H,-F);pa.max.set(H,F);$.min.set(-H,-F);$.max.set(H,F);U=1;X=0;ja=sa=R=Q=O=null;this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){D=a*G;V=b*G;L=c*G;P=d*G};this.setScissor=function(){};this.enableScissorTest=function(){};this.setClearColor=function(a,b){J.set(a);M=void 0!==b?b:1;$.min.set(-H,-F);$.max.set(H,F)};this.setClearColorHex=
function(a,b){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getClearColor=function(){return J};this.getClearAlpha=function(){return M};this.getMaxAnisotropy=function(){return 0};this.clear=function(){!1===$.empty()&&($.intersect(pa),$.expandByScalar(2),$.min.x+=H,$.min.y=-$.min.y+F,$.max.x+=H,$.max.y=-$.max.y+F,1>M&&C.clearRect($.min.x|0,$.max.y|0,$.max.x-$.min.x|0,$.min.y-$.max.y|0),0<M&&(p(c.NormalBlending),
h(1),l("rgba("+Math.floor(255*J.r)+","+Math.floor(255*J.g)+","+Math.floor(255*J.b)+","+M+")"),C.fillRect($.min.x|0,$.max.y|0,$.max.x-$.min.x|0,$.min.y-$.max.y|0)),$.makeEmpty())};this.clearColor=function(){};this.clearDepth=function(){};this.clearStencil=function(){};this.render=function(a,U){if(!1===U instanceof c.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear();r.info.render.vertices=0;r.info.render.faces=0;C.setTransform(L/
E,0,0,-P/K,D,K-V);C.translate(H,F);y=I.projectScene(a,U,this.sortObjects,this.sortElements);z=y.elements;w=y.lights;Ia=U;Fa.getNormalMatrix(U.matrixWorldInverse);Ba.setRGB(0,0,0);Na.setRGB(0,0,0);Ea.setRGB(0,0,0);for(var B=0,X=w.length;B<X;B++){var T=w[B],J=T.color;T instanceof c.AmbientLight?Ba.add(J):T instanceof c.DirectionalLight?Na.add(J):T instanceof c.PointLight&&Ea.add(J)}B=0;for(X=z.length;B<X;B++){var G=z[B],O=G.material;if(void 0!==O&&0!==O.opacity){oa.makeEmpty();if(G instanceof c.RenderableSprite){ba=
G;ba.x*=H;ba.y*=F;var T=ba,M=G,J=O;h(J.opacity);p(J.blending);var Q=M.scale.x*H,M=M.scale.y*F,G=.5*Math.sqrt(Q*Q+M*M);oa.min.set(T.x-G,T.y-G);oa.max.set(T.x+G,T.y+G);if(J instanceof c.SpriteMaterial){var R=J.map;if(null!==R){G=ea[R.id];if(void 0===G||G.version!==R.version)G=e(R),ea[R.id]=G;if(void 0!==G.canvas){l(G.canvas);var Z=R.image,G=Z.width*R.offset.x,O=Z.height*R.offset.y,ha=Z.width*R.repeat.x,R=Z.height*R.repeat.y,Z=Q/ha,ja=M/R;C.save();C.translate(T.x,T.y);0!==J.rotation&&C.rotate(J.rotation);
C.translate(-Q/2,-M/2);C.scale(Z,ja);C.translate(-G,-O);C.fillRect(G,O,ha,R);C.restore()}}else l(J.color.getStyle()),C.save(),C.translate(T.x,T.y),0!==J.rotation&&C.rotate(J.rotation),C.scale(Q,-M),C.fillRect(-.5,-.5,1,1),C.restore()}else J instanceof c.SpriteCanvasMaterial&&(v(J.color.getStyle()),l(J.color.getStyle()),C.save(),C.translate(T.x,T.y),0!==J.rotation&&C.rotate(J.rotation),C.scale(Q,M),J.program(C),C.restore())}else if(G instanceof c.RenderableLine){if(ba=G.v1,fa=G.v2,ba.positionScreen.x*=
H,ba.positionScreen.y*=F,fa.positionScreen.x*=H,fa.positionScreen.y*=F,oa.setFromPoints([ba.positionScreen,fa.positionScreen]),!0===pa.isIntersectionBox(oa))if(T=ba,J=fa,Q=G,M=O,h(M.opacity),p(M.blending),C.beginPath(),C.moveTo(T.positionScreen.x,T.positionScreen.y),C.lineTo(J.positionScreen.x,J.positionScreen.y),M instanceof c.LineBasicMaterial){q(M.linewidth);n(M.linecap);s(M.linejoin);if(M.vertexColors!==c.VertexColors)v(M.color.getStyle());else if(G=Q.vertexColors[0].getStyle(),Q=Q.vertexColors[1].getStyle(),
G===Q)v(G);else{try{var ca=C.createLinearGradient(T.positionScreen.x,T.positionScreen.y,J.positionScreen.x,J.positionScreen.y);ca.addColorStop(0,G);ca.addColorStop(1,Q)}catch(ua){ca=G}v(ca)}C.stroke();oa.expandByScalar(2*M.linewidth)}else M instanceof c.LineDashedMaterial&&(q(M.linewidth),n(M.linecap),s(M.linejoin),v(M.color.getStyle()),u([M.dashSize,M.gapSize]),C.stroke(),oa.expandByScalar(2*M.linewidth),u([]))}else if(G instanceof c.RenderableFace){ba=G.v1;fa=G.v2;ma=G.v3;if(-1>ba.positionScreen.z||
1<ba.positionScreen.z)continue;if(-1>fa.positionScreen.z||1<fa.positionScreen.z)continue;if(-1>ma.positionScreen.z||1<ma.positionScreen.z)continue;ba.positionScreen.x*=H;ba.positionScreen.y*=F;fa.positionScreen.x*=H;fa.positionScreen.y*=F;ma.positionScreen.x*=H;ma.positionScreen.y*=F;0<O.overdraw&&(g(ba.positionScreen,fa.positionScreen,O.overdraw),g(fa.positionScreen,ma.positionScreen,O.overdraw),g(ma.positionScreen,ba.positionScreen,O.overdraw));oa.setFromPoints([ba.positionScreen,fa.positionScreen,
ma.positionScreen]);if(!0===pa.isIntersectionBox(oa)){J=ba;Q=fa;M=ma;T=O;r.info.render.vertices+=3;r.info.render.faces++;h(T.opacity);p(T.blending);va=J.positionScreen.x;na=J.positionScreen.y;Ca=Q.positionScreen.x;ya=Q.positionScreen.y;N=M.positionScreen.x;Da=M.positionScreen.y;var O=va,ha=na,R=Ca,Z=ya,ja=N,sa=Da;C.beginPath();C.moveTo(O,ha);C.lineTo(R,Z);C.lineTo(ja,sa);C.closePath();if((T instanceof c.MeshLambertMaterial||T instanceof c.MeshPhongMaterial)&&null===T.map){za.copy(T.color);ia.copy(T.emissive);
T.vertexColors===c.FaceColors&&za.multiply(G.color);ga.copy(Ba);Pa.copy(J.positionWorld).add(Q.positionWorld).add(M.positionWorld).divideScalar(3);J=Pa;Q=G.normalModel;M=ga;G=0;for(O=w.length;G<O;G++)ha=w[G],S.copy(ha.color),ha instanceof c.DirectionalLight?(R=Oa.setFromMatrixPosition(ha.matrixWorld).normalize(),Z=Q.dot(R),0>=Z||(Z*=ha.intensity,M.add(S.multiplyScalar(Z)))):ha instanceof c.PointLight&&(R=Oa.setFromMatrixPosition(ha.matrixWorld),Z=Q.dot(Oa.subVectors(R,J).normalize()),0>=Z||(Z*=0==
ha.distance?1:1-Math.min(J.distanceTo(R)/ha.distance,1),0!=Z&&(Z*=ha.intensity,M.add(S.multiplyScalar(Z)))));ga.multiply(za).add(ia);!0===T.wireframe?b(ga,T.wireframeLinewidth,T.wireframeLinecap,T.wireframeLinejoin):d(ga)}else T instanceof c.MeshBasicMaterial||T instanceof c.MeshLambertMaterial||T instanceof c.MeshPhongMaterial?null!==T.map?T.map.mapping===c.UVMapping&&(ka=G.uvs,f(va,na,Ca,ya,N,Da,ka[0].x,ka[0].y,ka[1].x,ka[1].y,ka[2].x,ka[2].y,T.map)):null!==T.envMap?T.envMap.mapping===c.SphericalReflectionMapping&&
(la.copy(G.vertexNormalsModel[0]).applyMatrix3(Fa),W=.5*la.x+.5,Y=.5*la.y+.5,la.copy(G.vertexNormalsModel[1]).applyMatrix3(Fa),Aa=.5*la.x+.5,qa=.5*la.y+.5,la.copy(G.vertexNormalsModel[2]).applyMatrix3(Fa),da=.5*la.x+.5,aa=.5*la.y+.5,f(va,na,Ca,ya,N,Da,W,Y,Aa,qa,da,aa,T.envMap)):(ga.copy(T.color),T.vertexColors===c.FaceColors&&ga.multiply(G.color),!0===T.wireframe?b(ga,T.wireframeLinewidth,T.wireframeLinecap,T.wireframeLinejoin):d(ga)):(T instanceof c.MeshDepthMaterial?ga.r=ga.g=ga.b=1-t(J.positionScreen.z*
J.positionScreen.w,Ia.near,Ia.far):T instanceof c.MeshNormalMaterial?(la.copy(G.normalModel).applyMatrix3(Fa),ga.setRGB(la.x,la.y,la.z).multiplyScalar(.5).addScalar(.5)):ga.setRGB(1,1,1),!0===T.wireframe?b(ga,T.wireframeLinewidth,T.wireframeLinecap,T.wireframeLinejoin):d(ga))}}$.union(oa)}}C.setTransform(1,0,0,1,0,0)}}};c.TrackballControls=function(a,b){function d(a){!1!==l.enabled&&(window.removeEventListener("keydown",d),y=r,r===u.NONE)&&(a.keyCode!==l.keys[u.ROTATE]||l.noRotate?a.keyCode!==l.keys[u.ZOOM]||
l.noZoom?a.keyCode!==l.keys[u.PAN]||l.noPan||(r=u.PAN):r=u.ZOOM:r=u.ROTATE)}function e(a){!1!==l.enabled&&(r=y,window.addEventListener("keydown",d,!1))}function f(a){!1!==l.enabled&&(a.preventDefault(),a.stopPropagation(),r===u.NONE&&(r=a.button),r!==u.ROTATE||l.noRotate?r!==u.ZOOM||l.noZoom?r!==u.PAN||l.noPan||(O.copy(J(a.pageX,a.pageY)),L.copy(O)):(K.copy(J(a.pageX,a.pageY)),H.copy(K)):(I.copy(M(a.pageX,a.pageY)),w.copy(I)),document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",
h,!1),l.dispatchEvent(G))}function g(a){!1!==l.enabled&&(a.preventDefault(),a.stopPropagation(),r!==u.ROTATE||l.noRotate?r!==u.ZOOM||l.noZoom?r!==u.PAN||l.noPan||L.copy(J(a.pageX,a.pageY)):H.copy(J(a.pageX,a.pageY)):(w.copy(I),I.copy(M(a.pageX,a.pageY))))}function h(a){!1!==l.enabled&&(a.preventDefault(),a.stopPropagation(),r=u.NONE,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",h),l.dispatchEvent(C))}function p(a){if(!1!==l.enabled){a.preventDefault();a.stopPropagation();
var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail/3);K.y+=.01*b;l.dispatchEvent(G);l.dispatchEvent(C)}}function q(a){if(!1!==l.enabled){switch(a.touches.length){case 1:r=u.TOUCH_ROTATE;I.copy(M(a.touches[0].pageX,a.touches[0].pageY));w.copy(I);break;case 2:r=u.TOUCH_ZOOM_PAN;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;D=F=Math.sqrt(b*b+c*c);O.copy(J((a.touches[0].pageX+a.touches[1].pageX)/2,(a.touches[0].pageY+a.touches[1].pageY)/2));L.copy(O);break;
default:r=u.NONE}l.dispatchEvent(G)}}function n(a){if(!1!==l.enabled)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:w.copy(I);I.copy(M(a.touches[0].pageX,a.touches[0].pageY));break;case 2:var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;D=Math.sqrt(b*b+c*c);L.copy(J((a.touches[0].pageX+a.touches[1].pageX)/2,(a.touches[0].pageY+a.touches[1].pageY)/2));break;default:r=u.NONE}}function s(a){if(!1!==l.enabled){switch(a.touches.length){case 1:w.copy(I);
I.copy(M(a.touches[0].pageX,a.touches[0].pageY));break;case 2:F=D=0,L.copy(J((a.touches[0].pageX+a.touches[1].pageX)/2,(a.touches[0].pageY+a.touches[1].pageY)/2)),O.copy(L)}r=u.NONE;l.dispatchEvent(C)}}function v(a){a.preventDefault()}var l=this,u={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=a;this.domElement=void 0!==b?b:document;this.enabled=!0;this.screen={left:0,top:0,width:0,height:0};this.rotateSpeed=1;this.zoomSpeed=1.2;this.panSpeed=.3;this.staticMoving=this.noPan=
this.noZoom=this.noRotate=!1;this.dynamicDampingFactor=.2;this.minDistance=0;this.maxDistance=Infinity;this.keys=[65,83,68];this.target=new c.Vector3;var t=new c.Vector3,r=u.NONE,y=u.NONE,z=new c.Vector3,w=new c.Vector2,I=new c.Vector2,B=new c.Vector3,E=0,K=new c.Vector2,H=new c.Vector2,F=0,D=0,O=new c.Vector2,L=new c.Vector2;this.target0=this.target.clone();this.position0=this.object.position.clone();this.up0=this.object.up.clone();var P={type:"change"},G={type:"start"},C={type:"end"};this.handleResize=
function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var a=this.domElement.getBoundingClientRect(),b=this.domElement.ownerDocument.documentElement;this.screen.left=a.left+window.pageXOffset-b.clientLeft;this.screen.top=a.top+window.pageYOffset-b.clientTop;this.screen.width=a.width;this.screen.height=a.height}};this.handleEvent=function(a){if("function"==typeof this[a.type])this[a.type](a)};var J=
function(){var a=new c.Vector2;return function(b,c){a.set((b-l.screen.left)/l.screen.width,(c-l.screen.top)/l.screen.height);return a}}(),M=function(){var a=new c.Vector2;return function(b,c){a.set((b-.5*l.screen.width-l.screen.left)/(.5*l.screen.width),(l.screen.height+2*(l.screen.top-c))/l.screen.width);return a}}();this.rotateCamera=function(){var a=new c.Vector3,b=new c.Quaternion,d=new c.Vector3,e=new c.Vector3,f=new c.Vector3,g=new c.Vector3,h;return function(){g.set(I.x-w.x,I.y-w.y,0);(h=g.length())?
(z.copy(l.object.position).sub(l.target),d.copy(z).normalize(),e.copy(l.object.up).normalize(),f.crossVectors(e,d).normalize(),e.setLength(I.y-w.y),f.setLength(I.x-w.x),g.copy(e.add(f)),a.crossVectors(g,z).normalize(),h*=l.rotateSpeed,b.setFromAxisAngle(a,h),z.applyQuaternion(b),l.object.up.applyQuaternion(b),B.copy(a),E=h):!l.staticMoving&&E&&(E*=Math.sqrt(1-l.dynamicDampingFactor),z.copy(l.object.position).sub(l.target),b.setFromAxisAngle(B,E),z.applyQuaternion(b),l.object.up.applyQuaternion(b));
w.copy(I)}}();this.zoomCamera=function(){var a;r===u.TOUCH_ZOOM_PAN?(a=F/D,F=D,z.multiplyScalar(a)):(a=1+(H.y-K.y)*l.zoomSpeed,1!==a&&0<a&&(z.multiplyScalar(a),l.staticMoving?K.copy(H):K.y+=(H.y-K.y)*this.dynamicDampingFactor))};this.panCamera=function(){var a=new c.Vector2,b=new c.Vector3,d=new c.Vector3;return function(){a.copy(L).sub(O);a.lengthSq()&&(a.multiplyScalar(z.length()*l.panSpeed),d.copy(z).cross(l.object.up).setLength(a.x),d.add(b.copy(l.object.up).setLength(a.y)),l.object.position.add(d),
l.target.add(d),l.staticMoving?O.copy(L):O.add(a.subVectors(L,O).multiplyScalar(l.dynamicDampingFactor)))}}();this.checkDistances=function(){l.noZoom&&l.noPan||(z.lengthSq()>l.maxDistance*l.maxDistance&&(l.object.position.addVectors(l.target,z.setLength(l.maxDistance)),K.copy(H)),z.lengthSq()<l.minDistance*l.minDistance&&(l.object.position.addVectors(l.target,z.setLength(l.minDistance)),K.copy(H)))};this.update=function(){z.subVectors(l.object.position,l.target);l.noRotate||l.rotateCamera();l.noZoom||
l.zoomCamera();l.noPan||l.panCamera();l.object.position.addVectors(l.target,z);l.checkDistances();l.object.lookAt(l.target);1E-6<t.distanceToSquared(l.object.position)&&(l.dispatchEvent(P),t.copy(l.object.position))};this.reset=function(){y=r=u.NONE;l.target.copy(l.target0);l.object.position.copy(l.position0);l.object.up.copy(l.up0);z.subVectors(l.object.position,l.target);l.object.lookAt(l.target);l.dispatchEvent(P);t.copy(l.object.position)};this.dispose=function(){this.domElement.removeEventListener("contextmenu",
v,!1);this.domElement.removeEventListener("mousedown",f,!1);this.domElement.removeEventListener("mousewheel",p,!1);this.domElement.removeEventListener("DOMMouseScroll",p,!1);this.domElement.removeEventListener("touchstart",q,!1);this.domElement.removeEventListener("touchend",s,!1);this.domElement.removeEventListener("touchmove",n,!1);document.removeEventListener("mousemove",g,!1);document.removeEventListener("mouseup",h,!1);window.removeEventListener("keydown",d,!1);window.removeEventListener("keyup",
e,!1)};this.domElement.addEventListener("contextmenu",v,!1);this.domElement.addEventListener("mousedown",f,!1);this.domElement.addEventListener("mousewheel",p,!1);this.domElement.addEventListener("DOMMouseScroll",p,!1);this.domElement.addEventListener("touchstart",q,!1);this.domElement.addEventListener("touchend",s,!1);this.domElement.addEventListener("touchmove",n,!1);window.addEventListener("keydown",d,!1);window.addEventListener("keyup",e,!1);this.handleResize();this.update()};c.TrackballControls.prototype=
Object.create(c.EventDispatcher.prototype);c.TrackballControls.prototype.constructor=c.TrackballControls;c.SphereGeometry=function(a,b,d,e,f,g,h){c.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:d,phiStart:e,phiLength:f,thetaStart:g,thetaLength:h};this.fromBufferGeometry(new c.SphereBufferGeometry(a,b,d,e,f,g,h))};c.SphereGeometry.prototype=Object.create(c.Geometry.prototype);c.SphereGeometry.prototype.constructor=c.SphereGeometry;c.SphereGeometry.prototype.clone=
function(){return new c.SphereGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength)};c.SphereBufferGeometry=function(a,b,d,e,f,g,h){c.BufferGeometry.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:d,phiStart:e,phiLength:f,thetaStart:g,thetaLength:h};a=a||50;b=Math.max(3,Math.floor(b)||8);d=Math.max(2,
Math.floor(d)||6);e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;g=void 0!==g?g:0;h=void 0!==h?h:Math.PI;for(var p=g+h,q=(b+1)*(d+1),n=new c.BufferAttribute(new Float32Array(3*q),3),s=new c.BufferAttribute(new Float32Array(3*q),3),q=new c.BufferAttribute(new Float32Array(2*q),2),v=0,l=[],u=new c.Vector3,t=0;t<=d;t++){for(var r=[],y=t/d,z=0;z<=b;z++){var w=z/b,I=-a*Math.cos(e+w*f)*Math.sin(g+y*h),B=a*Math.cos(g+y*h),E=a*Math.sin(e+w*f)*Math.sin(g+y*h);u.set(I,B,E).normalize();n.setXYZ(v,I,B,E);s.setXYZ(v,
u.x,u.y,u.z);q.setXY(v,w,1-y);r.push(v);v++}l.push(r)}e=[];for(t=0;t<d;t++)for(z=0;z<b;z++)f=l[t][z+1],h=l[t][z],v=l[t+1][z],u=l[t+1][z+1],(0!==t||0<g)&&e.push(f,h,u),(t!==d-1||p<Math.PI)&&e.push(h,v,u);this.setIndex(new c.BufferAttribute(new Uint16Array(e),1));this.addAttribute("position",n);this.addAttribute("normal",s);this.addAttribute("uv",q);this.boundingSphere=new c.Sphere(new c.Vector3,a)};c.SphereBufferGeometry.prototype=Object.create(c.BufferGeometry.prototype);c.SphereBufferGeometry.prototype.constructor=
c.SphereBufferGeometry;c.SphereBufferGeometry.prototype.clone=function(){var a=new c.SphereBufferGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);a.copy(this);return a};c.CylinderGeometry=function(a,b,d,e,f,g,h,p){c.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:d,radialSegments:e,heightSegments:f,
openEnded:g,thetaStart:h,thetaLength:p};a=void 0!==a?a:20;b=void 0!==b?b:20;d=void 0!==d?d:100;e=e||8;f=f||1;g=void 0!==g?g:!1;h=void 0!==h?h:0;p=void 0!==p?p:2*Math.PI;var q=d/2,n,s,v=[],l=[];for(s=0;s<=f;s++){var u=[],t=[],r=s/f,y=r*(b-a)+a;for(n=0;n<=e;n++){var z=n/e,w=new c.Vector3;w.x=y*Math.sin(z*p+h);w.y=-r*d+q;w.z=y*Math.cos(z*p+h);this.vertices.push(w);u.push(this.vertices.length-1);t.push(new c.Vector2(z,1-r))}v.push(u);l.push(t)}d=(b-a)/d;for(n=0;n<e;n++)for(0!==a?(h=this.vertices[v[0][n]].clone(),
p=this.vertices[v[0][n+1]].clone()):(h=this.vertices[v[1][n]].clone(),p=this.vertices[v[1][n+1]].clone()),h.setY(Math.sqrt(h.x*h.x+h.z*h.z)*d).normalize(),p.setY(Math.sqrt(p.x*p.x+p.z*p.z)*d).normalize(),s=0;s<f;s++){var u=v[s][n],t=v[s+1][n],r=v[s+1][n+1],y=v[s][n+1],z=h.clone(),w=h.clone(),I=p.clone(),B=p.clone(),E=l[s][n].clone(),K=l[s+1][n].clone(),H=l[s+1][n+1].clone(),F=l[s][n+1].clone();this.faces.push(new c.Face3(u,t,y,[z,w,B]));this.faceVertexUvs[0].push([E,K,F]);this.faces.push(new c.Face3(t,
r,y,[w.clone(),I,B.clone()]));this.faceVertexUvs[0].push([K.clone(),H,F.clone()])}if(!1===g&&0<a)for(this.vertices.push(new c.Vector3(0,q,0)),n=0;n<e;n++)u=v[0][n],t=v[0][n+1],r=this.vertices.length-1,z=new c.Vector3(0,1,0),w=new c.Vector3(0,1,0),I=new c.Vector3(0,1,0),E=l[0][n].clone(),K=l[0][n+1].clone(),H=new c.Vector2(K.x,0),this.faces.push(new c.Face3(u,t,r,[z,w,I],void 0,1)),this.faceVertexUvs[0].push([E,K,H]);if(!1===g&&0<b)for(this.vertices.push(new c.Vector3(0,-q,0)),n=0;n<e;n++)u=v[f][n+
1],t=v[f][n],r=this.vertices.length-1,z=new c.Vector3(0,-1,0),w=new c.Vector3(0,-1,0),I=new c.Vector3(0,-1,0),E=l[f][n+1].clone(),K=l[f][n].clone(),H=new c.Vector2(K.x,1),this.faces.push(new c.Face3(u,t,r,[z,w,I],void 0,2)),this.faceVertexUvs[0].push([E,K,H]);this.computeFaceNormals()};c.CylinderGeometry.prototype=Object.create(c.Geometry.prototype);c.CylinderGeometry.prototype.constructor=c.CylinderGeometry;c.CylinderGeometry.prototype.clone=function(){return new c.CylinderGeometry(this.parameters.radiusTop,
this.parameters.radiusBottom,this.parameters.height,this.parameters.radialSegments,this.parameters.heightSegments,this.parameters.openEnded,this.parameters.thetaStart,this.parameters.thetaLength)};c.ArrowHelper=function(){var a=new c.Geometry;a.vertices.push(new c.Vector3(0,0,0),new c.Vector3(0,1,0));var b=new c.CylinderGeometry(0,.5,1,5,1);b.translate(0,-.5,0);return function(d,e,f,g,h,p){c.Object3D.call(this);void 0===g&&(g=16776960);void 0===f&&(f=1);void 0===h&&(h=.2*f);void 0===p&&(p=.2*h);this.position.copy(e);
h<f&&(this.line=new c.Line(a,new c.LineBasicMaterial({color:g})),this.line.matrixAutoUpdate=!1,this.add(this.line));this.cone=new c.Mesh(b,new c.MeshBasicMaterial({color:g}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(d);this.setLength(f,h,p)}}();c.ArrowHelper.prototype=Object.create(c.Object3D.prototype);c.ArrowHelper.prototype.constructor=c.ArrowHelper;c.ArrowHelper.prototype.setDirection=function(){var a=new c.Vector3,b;return function(c){.99999<c.y?this.quaternion.set(0,
0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();c.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);b<a&&(this.line.scale.set(1,a-b,1),this.line.updateMatrix());this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};c.ArrowHelper.prototype.setColor=function(a){void 0!==this.line&&this.line.material.color.set(a);this.cone.material.color.set(a)};h.THREE=
c})}]);
</script>
</body>
</html>
